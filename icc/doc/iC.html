<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>Programming Language iC</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.0 Beta (Win32)">
	<META NAME="AUTHOR" CONTENT="John E. Wulff">
	<META NAME="CREATED" CONTENT="20020512;14243400">
	<META NAME="CHANGED" CONTENT="20080906;2502900">
	<META NAME="DESCRIPTION" CONTENT="first 3 chapters">
	<META NAME="Info 0" CONTENT="">
	<META NAME="Info 1" CONTENT="">
	<META NAME="Info 2" CONTENT="">
	<META NAME="Info 3" CONTENT="">
	<META NAME="Info 4" CONTENT="">
	<STYLE TYPE="text/css">
	<!--
		P { margin-bottom: 0.2cm; line-height: 0.4cm; text-align: justify; widows: 2; orphans: 2 }
		P.western { font-family: "Sanserif PS"; font-size: 10pt; so-language: en-GB }
		H1 { margin-left: 1.2cm; text-indent: -1.2cm; margin-top: 1.27cm; margin-bottom: 0.4cm; background: transparent; border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding-top: 0.12cm; padding-bottom: 0cm; padding-left: 0cm; padding-right: 0cm; line-height: 100%; text-align: justify; widows: 2; orphans: 2; page-break-before: auto }
		H1.western { font-family: "Sanserif PS"; font-size: 14pt; so-language: en-GB }
		H1.cjk { font-family: "Bitstream Vera Sans"; font-size: 13pt }
		H1.ctl { font-family: "Lucidasans"; font-size: 13pt }
		H2 { margin-left: 1.2cm; text-indent: -1.2cm; margin-top: 0.1cm; margin-bottom: 0.2cm; line-height: 100%; text-align: justify; widows: 2; orphans: 2; page-break-before: auto }
		H2.western { font-family: "Sanserif PS"; font-size: 14pt; so-language: en-GB; font-style: italic }
		H2.cjk { font-family: "Bitstream Vera Sans"; font-size: 14pt; font-style: italic }
		H2.ctl { font-family: "Lucidasans"; font-size: 14pt; font-style: italic }
		H3 { margin-left: 0.62cm; margin-top: 0cm; margin-bottom: 0.2cm; line-height: 100%; text-align: justify; widows: 2; orphans: 2; page-break-after: auto }
		H3.western { font-family: "Sanserif PS"; so-language: en-GB }
		H3.cjk { font-family: "Bitstream Vera Sans" }
		H3.ctl { font-family: "Lucidasans" }
		P.sdfootnote-western { font-family: "Sanserif PS"; font-size: 10pt; so-language: en-GB }
		A:visited { so-language: en-GB }
		A.sdfootnoteanc { font-size: 57% }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-GB" DIR="LTR">
<P CLASS="western" STYLE="line-height: 100%"><BR><BR>
</P>
<P CLASS="western" STYLE="line-height: 100%"><BR><BR>
</P>
<P CLASS="western" STYLE="line-height: 100%"><BR><BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="line-height: 100%"><FONT SIZE=4 STYLE="font-size: 16pt"><FONT FACE="Sanserif 2.5cpi"><B>The
Programming Language &quot;</B></FONT><FONT FACE="Sanserif 2.5cpi"><I><B>immediate
C</B></I></FONT><FONT FACE="Sanserif 2.5cpi"><B>&quot;</B></FONT></FONT></P>
<P CLASS="western" ALIGN=CENTER STYLE="line-height: 100%"><BR><BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="line-height: 100%"><FONT SIZE=3>John
E. Wulff, B.E., M. Eng. Sc.</FONT></P>
<P CLASS="western" ALIGN=CENTER STYLE="line-height: 100%"><BR><BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="line-height: 100%"><BR><BR>
</P>
<H1 CLASS="western" ALIGN=JUSTIFY STYLE="text-indent: 0cm"><A NAME="0.Abstract|outline"></A>
<FONT SIZE=4>Abstract</FONT></H1>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><I>immediate
C</I> - <I>iC</I> for short - is an extension of the language C. It
utilizes the syntax of C to give meaning to statements that have no
semantic support in C. In addition to standard variables, which are
modified by the flow of instructions, <I>iC</I> provides so called
<I>'immediate'</I> variables, whose values are updated, whenever a
change of input calls for an immediate change in output. An efficient
Data Flow technique implements this strategy.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><I>iC</I>
provides programmers with built in operators, whose function is
closely modelled on integrated circuits. The name <I>iC</I> is a
reminder of this fact. Logical <I>AND</I>, <I>OR</I>, <I>EXCLUSIVE-OR
</I>and <I>NOT</I> as well as D flip-flops, SR flip-flops and many
others are implemented in such a way, that their use follows the same
design rules, which apply to their hardware counterparts. These rules
have led to a well-developed hardware technology, whose effectiveness
is demonstrated by the success of today's complex computer hardware.
Particularly the concept of clocked functions plays an important role
in the language <I>iC</I>. It gives the same protection against
timing races in <I>iC</I> programs, as it provides for hardware IC
designs.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">Writing
programs in the language <I>iC</I> has the added quality, that many
simple ideas and relationships, which should result in direct
actions, can be written down <I>immediately</I> in one line. The
coding of call back routines and other overhead is not required. It
was this thought, which also prompted the name &quot;<I>immediate C</I>&quot;.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><B>Copyright
(C) 1985-2008  John E. Wulff</B></P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
You may copy and distribute this document under the terms of either
the 
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
GNU General Public License or the Artistic License, as specified in
the README file.</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
<BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
For more information about this program, or for information on how 
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
to contact the author, see <A HREF="#10.Appendix A    README|outline">Appendix
A    README</A> or visit 
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
<A HREF="http://je-wulff.de/">http://je-wulff.de</A> or contact
<A HREF="mailto:ic@je-wulff.de?subject=Enquiry%20from%20iC%20Handbook%201.120">ic@je-wulff.de</A></P>
<H1 LANG="de-DE" CLASS="western" ALIGN=JUSTIFY STYLE="text-indent: 0cm; page-break-before: always"><A NAME="0.Zusammenfassung|outline"></A>
<FONT SIZE=4>Zusammenfassung</FONT></H1>
<P LANG="de-DE" CLASS="western" STYLE="line-height: 0.4cm"><I>immediate
C</I> - kurz <I>iC</I> - ist eine Erweiterung der Sprache C. Sie
basiert auf der Syntax von C und gibt vielen Befehlen Bedeutung, die
keine semantische Unterst&uuml;tzung in C haben. Zu den einfachen
Variablen, die im normalen Programmfluss ver&auml;ndert werden,
kommen in <I>iC</I> so genannte <I>'immediate'</I> oder <I>'sofort'</I>
Variablen, dessen Wert sofort ver&auml;ndert wird, wenn eine
Eingangs&auml;nderung, die sofortige &Auml;nderung eines Ausgangs zur
Folge hat. Um dies zu erreichen, wird eine effiziente
Datenfluss-Technik eingesetzt.</P>
<P LANG="de-DE" CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">
<I>iC</I> stellt Programmierern eingebaute Operatoren zur Verf&uuml;gung,
deren Arbeitsweise die Funktionen von IC-Bausteinen modelliert. Der
Name <I>iC</I> soll an diese Tatsache erinnern. Logisches <I>UND</I>,
<I>ODER, EXCLUSIV-ODER</I> und <I>NICHT</I> sowie D flip-flops, SR
flip-flops und viele mehr sind so implementiert, dass deren Anwendung
den gleichen Entwurfsregeln entspricht, wie die der entsprechenden
IC-Bausteine. Diese Regeln haben zu einer ausgereiften Technik
gef&uuml;hrt, deren Wirksamkeit durch unsere heutige komplexe
Computertechnik belegt ist. Besonders das Konzept von getakteten
(clocked) Funktionen spielt in der Sprache <I><SPAN STYLE="font-weight: normal">iC</SPAN></I>
eine wichtige Rolle. Damit wird derselbe Schutz gegen
Laufzeitprobleme in <I>iC</I>-Programmen erreicht, der damit in
IC-Schaltkreisen bewirkt wird.</P>
<P LANG="de-DE" CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">
Programme die in <I>iC</I> geschrieben werden, haben das zus&auml;tzliche
Merkmal, dass viele einfache Ideen und Zusammenh&auml;nge, die zu
direkten Aktionen f&uuml;hren sollen, sofort in einer Zeile
niedergeschrieben werden k&ouml;nnen. Callback-Routinen sind nicht
notwendig. Auch dieser Gedanke ist im Namen  &quot;<I>immediate C</I>&quot;
enthalten.</P>
<P LANG="de-DE" CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm; page-break-before: always">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><BR><BR>
</P>
<DIV ID="Table of Contents1" DIR="LTR">
	<DIV ID="Table of Contents1_Head" DIR="LTR">
		<P STYLE="margin-top: 0.4cm; line-height: 100%; page-break-after: avoid">
		<FONT FACE="helvetica, sans-serif"><FONT SIZE=4 STYLE="font-size: 16pt"><B>Table
		of Contents</B></FONT></FONT></P>
	</DIV>
	<P><A HREF="#0.Abstract|outline">Abstract</A>	1</P>
	<P><A HREF="#0.Zusammenfassung|outline">Zusammenfassung</A>	2</P>
	<P>1<A HREF="#1.    Introduction|outline">    Introduction</A>	6</P>
	<P STYLE="margin-left: 0.5cm">1.1<A HREF="#1.1.  Relationship to Object Orientation|outline">
	 Relationship to Object Orientation</A>	6</P>
	<P STYLE="margin-left: 0.5cm">1.2<A HREF="#1.2.  Relationship to Instruction Flow Languages|outline">
	 Relationship to Instruction Flow Languages</A>	6</P>
	<P STYLE="margin-left: 0.5cm">1.3<A HREF="#1.3.  Programmable Logic Controllers|outline">
	 Programmable Logic Controllers</A>	6</P>
	<P STYLE="margin-left: 0.5cm">1.4<A HREF="#1.4.  Relationship to Integrated Circuits|outline">
	 Relationship to Integrated Circuits</A>	7</P>
	<P STYLE="margin-left: 0.5cm">1.5<A HREF="#1.5.  Summary|outline"> 
	Summary</A>	7</P>
	<P>2<A HREF="#2.    Language description|outline">    Language
	description</A>	8</P>
	<P STYLE="margin-left: 0.5cm">2.1<A HREF="#2.1.  Immediate Variables |outline">
	 Immediate Variables </A>	8</P>
	<P STYLE="margin-left: 0.5cm">2.2<A HREF="#2.2.  Immediate Types|outline">
	 Immediate Types</A>	8</P>
	<P STYLE="margin-left: 1cm">2.2.1<A HREF="#2.2.1.  Immediate declarations|outline">
	 Immediate declarations</A>	8</P>
	<P STYLE="margin-left: 1cm">2.2.2<A HREF="#2.2.2.  extern immediate declarations|outline">
	 extern immediate declarations</A>	8</P>
	<P STYLE="margin-left: 0.5cm">2.3<A HREF="#2.3.  Immediate Expressions |outline">
	 Immediate Expressions </A>	8</P>
	<P STYLE="margin-left: 0.5cm">2.4<A HREF="#2.4.  Operators in immediate expressions|outline">
	 Operators in immediate expressions</A>	8</P>
	<P STYLE="margin-left: 1cm">2.4.1<A HREF="#2.4.1.  Arithmetic and Relational Operators|outline">
	 Arithmetic and Relational Operators</A>	9</P>
	<P STYLE="margin-left: 1cm">2.4.2<A HREF="#2.4.2.  Bitwise and Bit Operators|outline">
	 Bitwise and Bit Operators</A>	9</P>
	<P STYLE="margin-left: 1cm">2.4.3<A HREF="#2.4.3.  Logical Operators|outline">
	 Logical Operators</A>	9</P>
	<P STYLE="margin-left: 1cm">2.4.4<A HREF="#2.4.4.  Conditional Operators|outline">
	 Conditional Operators</A>	9</P>
	<P STYLE="margin-left: 0.5cm">2.5<A HREF="#2.5.  Function and macro calls|outline">
	 Function and macro calls</A>	10</P>
	<P STYLE="margin-left: 0.5cm">2.6<A HREF="#2.6.  Parentheses |outline">
	 Parentheses </A>	10</P>
	<P STYLE="margin-left: 0.5cm">2.7<A HREF="#2.7.  Immediate statements|outline">
	 Immediate statements</A>	11</P>
	<P STYLE="margin-left: 1cm">2.7.1<A HREF="#2.7.1.  Immediate Assignments |outline">
	 Immediate Assignments </A>	11</P>
	<P STYLE="margin-left: 1cm">2.7.2<A HREF="#2.7.2.  Aliases |outline">
	 Aliases </A>	11</P>
	<P STYLE="margin-left: 1cm">2.7.3<A HREF="#2.7.3.  The single assignment rule |outline">
	 The single assignment rule </A>	11</P>
	<P STYLE="margin-left: 0.5cm">2.8<A HREF="#2.8.  Immediate control statements|outline">
	 Immediate control statements</A>	11</P>
	<P STYLE="margin-left: 1cm">2.8.1<A HREF="#2.8.1.  Immediate conditional statement|outline">
	 Immediate conditional statement</A>	12</P>
	<P STYLE="margin-left: 1cm">2.8.2<A HREF="#2.8.2.  Immediate switch statement|outline">
	 Immediate switch statement</A>	12</P>
	<P STYLE="margin-left: 0.5cm">2.9<A HREF="#2.9.  Literal blocks|outline">
	 Literal blocks</A>	12</P>
	<P STYLE="margin-left: 0.5cm">2.10<A HREF="#2.10.  Comments|outline">
	 Comments</A>	13</P>
	<P STYLE="margin-left: 0.5cm">2.11<A HREF="#2.11.  Scope of immediate statements|outline">
	 Scope of immediate statements</A>	13</P>
	<P STYLE="margin-left: 0.5cm">2.12<A HREF="#2.12.  Intrinsic limitations of immediate statements |outline">
	 Intrinsic limitations of immediate statements </A>	14</P>
	<P STYLE="margin-left: 0.5cm">2.13<A HREF="#2.13.  Pragmas|outline">
	 Pragmas</A>	14</P>
	<P>3<A HREF="#3.    Arrays|outline">    Arrays</A>	16</P>
	<P STYLE="margin-left: 0.5cm">3.1<A HREF="#3.1.  Immediate Arrays |outline">
	 Immediate Arrays </A>	16</P>
	<P STYLE="margin-left: 0.5cm">3.2<A HREF="#3.2.  Use of immediate Arrays|outline">
	 Use of immediate Arrays</A>	16</P>
	<P STYLE="margin-left: 0.5cm">3.3<A HREF="#3.3.  Implementation of immediate Arrays|outline">
	 Implementation of immediate Arrays</A>	16</P>
	<P STYLE="margin-left: 1cm">3.3.1<A HREF="#3.3.1.  FOR loops|outline">
	 FOR loops</A>	18</P>
	<P STYLE="margin-left: 1cm">3.3.2<A HREF="#3.3.2.  Index expressions|outline">
	 Index expressions</A>	19</P>
	<P STYLE="margin-left: 1cm">3.3.3<A HREF="#3.3.3.  immediate Array syntax|outline">
	 immediate Array syntax</A>	20</P>
	<P STYLE="margin-left: 0.5cm">3.4<A HREF="#3.4.  immac Macro facility|outline">
	 immac Macro facility</A>	21</P>
	<P>4<A HREF="#4.    Built-in Functions|outline">    Built-in
	Functions</A>	22</P>
	<P STYLE="margin-left: 0.5cm">4.1<A HREF="#4.1.  Unclocked flip-flop or LATCH|outline">
	 Unclocked flip-flop or LATCH</A>	22</P>
	<P STYLE="margin-left: 0.5cm">4.2<A HREF="#4.2.  FORCE function|outline">
	 FORCE function</A>	22</P>
	<P STYLE="margin-left: 0.5cm">4.3<A HREF="#4.3.  Clocked D flip-flop|outline">
	 Clocked D flip-flop</A>	23</P>
	<P STYLE="margin-left: 0.5cm">4.4<A HREF="#4.4.  Clocked SR flip-flop|outline">
	 Clocked SR flip-flop</A>	23</P>
	<P STYLE="margin-left: 0.5cm">4.5<A HREF="#4.5.  Clocked SRX flip-flop|outline">
	 Clocked SRX flip-flop</A>	24</P>
	<P STYLE="margin-left: 0.5cm">4.6<A HREF="#4.6.  Clocked JK flip-flop|outline">
	 Clocked JK flip-flop</A>	24</P>
	<P STYLE="margin-left: 0.5cm">4.7<A HREF="#4.7.  D flip-flop with Set and Reset|outline">
	 D flip-flop with Set and Reset</A>	24</P>
	<P STYLE="margin-left: 0.5cm">4.8<A HREF="#4.8.  Mono-Flop with optional Reset|outline">
	 Mono-Flop with optional Reset</A>	25</P>
	<P STYLE="margin-left: 0.5cm">4.9<A HREF="#4.9.  Sample and Hold|outline">
	 Sample and Hold</A>	25</P>
	<P STYLE="margin-left: 0.5cm">4.10<A HREF="#4.10.  Sample and Hold with Set and Reset|outline">
	 Sample and Hold with Set and Reset</A>	25</P>
	<P STYLE="margin-left: 0.5cm">4.11<A HREF="#4.11.  Edge detectors|outline">
	 Edge detectors</A>	25</P>
	<P>5<A HREF="#5.  Clock Signals|outline">  Clock Signals</A>	26</P>
	<P STYLE="margin-left: 0.5cm">5.1<A HREF="#5.1.  Built-in immediate clock|outline">
	 Built-in immediate clock</A>	26</P>
	<P STYLE="margin-left: 0.5cm">5.2<A HREF="#5.2.  CLOCK function|outline">
	 CLOCK function</A>	27</P>
	<P STYLE="margin-left: 0.5cm">5.3<A HREF="#5.3.TIMER function|outline">TIMER
	function</A>	27</P>
	<P STYLE="margin-left: 0.5cm">5.4<A HREF="#5.4.  TIMER1 function|outline">
	 TIMER1 function</A>	28</P>
	<P>6<A HREF="#6.  Inputs and Outputs|outline">  Inputs and
	Outputs</A>	29</P>
	<P STYLE="margin-left: 0.5cm">6.1<A HREF="#6.1.  Built-in Inputs|outline">
	 Built-in Inputs</A>	29</P>
	<P STYLE="margin-left: 1cm">6.1.1<A HREF="#6.1.1.  iClock|outline"> 
	iClock</A>	29</P>
	<P STYLE="margin-left: 1cm">6.1.2<A HREF="#6.1.2.  End of Initialization|outline">
	 End of Initialization</A>	29</P>
	<P STYLE="margin-left: 1cm">6.1.3<A HREF="#6.1.3.  Timing inputs|outline">
	 Timing inputs</A>	29</P>
	<P STYLE="margin-left: 0.5cm">6.2<A HREF="#6.2.  External Inputs and Outputs|outline">
	 External Inputs and Outputs</A>	29</P>
	<P STYLE="margin-left: 1cm">6.2.1<A HREF="#6.2.1.  Digital inputs|outline">
	 Digital inputs</A>	30</P>
	<P STYLE="margin-left: 1cm">6.2.2<A HREF="#6.2.2.  Digital outputs|outline">
	 Digital outputs</A>	30</P>
	<P STYLE="margin-left: 1cm">6.2.3<A HREF="#6.2.3.  Analog inputs|outline">
	 Analog inputs</A>	30</P>
	<P STYLE="margin-left: 1cm">6.2.4<A HREF="#6.2.4.  Analog outputs|outline">
	 Analog outputs</A>	31</P>
	<P>7<A HREF="#7.    User defined immediate Function Blocks|outline">
	   User defined immediate Function Blocks</A>	32</P>
	<P STYLE="margin-left: 0.5cm">7.1<A HREF="#7.1.  immediate Function Block Definition|outline">
	 immediate Function Block Definition</A>	32</P>
	<P STYLE="margin-left: 0.5cm">7.2<A HREF="#7.2.  immediate Function Block Call|outline">
	 immediate Function Block Call</A>	34</P>
	<P>8<A HREF="#8.  The iC run-time model|outline">  The iC run-time
	model</A>	39</P>
	<P STYLE="margin-left: 0.5cm">8.1<A HREF="#8.1.  Combinatorial actions|outline">
	 Combinatorial actions</A>	41</P>
	<P STYLE="margin-left: 0.5cm">8.2<A HREF="#8.2.  Clocked actions|outline">
	 Clocked actions</A>	42</P>
	<P STYLE="margin-left: 0.5cm">8.3<A HREF="#8.3.  Output actions|outline">
	 Output actions</A>	43</P>
	<P STYLE="margin-left: 0.5cm">8.4<A HREF="#8.4.  Input actions|outline">
	 Input actions</A>	43</P>
	<P STYLE="margin-left: 0.5cm">8.5<A HREF="#8.5.  Input/Output network|outline">
	 Input/Output network</A>	44</P>
	<P>9<A HREF="#9.    Compiler and Run-time system|outline">   
	Compiler and Run-time system</A>	45</P>
	<P STYLE="margin-left: 0.5cm">9.1<A HREF="#9.1.  Compiler |outline">
	 Compiler </A>	45</P>
	<P STYLE="margin-left: 0.5cm">9.2<A HREF="#9.2.  Run-time libraries |outline">
	 Run-time libraries </A>	45</P>
	<P STYLE="margin-left: 0.5cm">9.3<A HREF="#9.3.  Run-time environment and system|outline">
	 Run-time environment and system</A>	45</P>
	<P>10<A HREF="#10.    Bibliography|outline">    Bibliography</A>	48</P>
	<P>11<A HREF="#11.    The Author|outline">    The Author</A>	49</P>
	<P><A HREF="#11.Appendix A    README|outline">Appendix A   
	README</A>	50</P>
	<P><A HREF="#11.Appendix B    Type Definition Table|outline">Appendix
	B    Type Definition Table</A>	54</P>
</DIV>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="1.    Introduction|outline"></A>
1    Introduction</H1>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><I>immediate
C</I> - <I>iC</I> for short - is an extension of the language C. It
utilizes the syntax of C to give meaning to statements that have no
semantic support in C. In addition to standard variables, which are
modified by the flow of instructions, <I>iC</I> provides so called
<I>'immediate'</I> variables, whose values are updated, whenever a
change of input calls for an immediate change in output. An efficient
Data Flow technique implements this strategy.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="1.1.  Relationship to Object Orientation|outline"></A>
1.1  <FONT FACE="Sanserif PS">Relationship to Object Orientation</FONT></H2>
<P CLASS="western" STYLE="line-height: 0.4cm"><I>immediate C </I>uses
the OO-paradigm in its concept. Each <I>immediate </I>variable is an
independent object, which acts on other <I>immediate</I> variables by
a number of methods. These methods are expressed in a number of
functions and overloaded on to the logical and arithmetic operators.
In conventional OO languages like Smalltalk or C++, a method is an
action which acts on the object owning the method. Conceptually
descriptions of Object Orientation talk of methods being actions or
messages sent from one object to another. It is in this sense that <I>iC
immediate</I> variable objects interact with each other by the use of
Data Flow techniques.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="1.2.  Relationship to Instruction Flow Languages|outline"></A>
1.2  <FONT FACE="Sanserif PS">Relationship to Instruction Flow
Languages</FONT></H2>
<P CLASS="western" STYLE="line-height: 0.4cm">Traditional High Level
Languages such as FORTRAN, Pascal or C are called Instruction Flow
Languages, because they express instruction sequences for abstract
machines, which are closely modelled on the underlying, instruction
driven machine. By being independent of the actual machine, these
languages have helped to hide unessential details of the hardware, to
make programs portable and to focus the programmer's attention on the
problem to be solved. The overwhelming usefulness of these
instruction flow languages to express precise algorithms is
recognized in <I>iC</I>, by including the whole of C or C++ as a
subset, for dealing with algorithmic problems in established ways.
Learning of the language <I>iC</I> should therefore be very easy for
C and C++ programmers. 
</P>
<P CLASS="western" STYLE="line-height: 0.4cm">Many of the undesirable
characteristics of the underlying hardware are reflected in today's
High Level Languages. These characteristics make it difficult to
express a large number of everyday problems briefly and clearly.
Particularly the manipulation of events is not easy to integrate into
programs written in traditional High Level Languages. Yet events play
an increasing role in today's interactive, mouse driven programs.
Many different functions must be ready to execute as a result of
external or user generated events, which occur at unpredictable
times. The instruction driven computer only executes a particular
instruction, <I>when the flow of instructions in a program gets
around to executing that instruction</I>. This statement may sound
pedantic, but much of the complexity of modern programs is a direct
result of this fundamental truism. How does one organize a program,
so that it can respond quickly to many and varied external events? <I>iC</I>
provides answers to this question. 
</P>
<P CLASS="western" STYLE="line-height: 0.4cm">The interrupt
mechanism, designed to tackle such problems at a system level, is
intractable for the average programmer and is not supported in a
general way by most High Level Languages. <I>iC</I> harnesses
interrupts and hides their complexity. 
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="1.3.  Programmable Logic Controllers|outline"></A>
1.3  <FONT FACE="Sanserif PS">Programmable Logic Controllers</FONT></H2>
<P CLASS="western" STYLE="line-height: 0.4cm">The situation is even
more critical in systems that deal with a large number of external
inputs. In the early 1980's a completely new class of computer was
developed to deal with such problems in the environment of factories
and machine control. These are the &quot;Programmable Logic
Controllers&quot; or &quot;PLC&quot; for short. (SPS or
Speicher-Programmierbare Steuerung in German) Conventional PLC's have
a standard instruction driven architecture. They differ from
conventional computers in two main areas: 
</P>
<UL>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">They provide fast
	bit instructions and data access to individual bits on top of the
	more conventional instructions to manipulate data words. 
	</P>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">They have a built
	in operating system, which runs the stored program over and over.
	Inputs are automatically polled at reasonably short intervals and
	Boolean and arithmetic expressions making up the stored program are
	re-evaluated continuously. This is necessary, because outputs and
	intermediate values in a PLC are assumed to reflect an immediate
	transformation of the inputs, as carried out by the expressions of
	the stored program. 
	</P>
</UL>
<P CLASS="western" STYLE="line-height: 0.4cm">This organization of
PLC's has two very serious drawbacks, which are direct consequences
of the differences mentioned: 
</P>
<UL>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">Conventional PLC's
	require a special CPU, which can never be as cheap as a mass
	produced microprocessor chip, or they emulate the PLC instruction
	set, in which case they are slow. 
	</P>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">The cyclic
	execution of the stored program sets very real limits to the length
	of possible programs. The longer the program, the longer the cycle
	time, which is the time interval at which inputs are polled. If this
	time gets too long, the response of the PLC is no longer acceptable
	for many applications. 
	</P>
</UL>
<P CLASS="western" STYLE="line-height: 0.4cm">PLC's are facing a
crisis on two fronts:</P>
<UL>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">Traditionally PLC
	program memories were measured in kilobytes. Today megabytes of
	memory are available at low cost. This 1000 fold increase in
	potential program size cannot be utilized with the cyclic execution
	strategy of conventional PLC's. Even with a 10 fold increase in
	speed, these machines would be too slow. 
	</P>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">The second crisis
	is the lack of a High Level Language for PLC's. Most PLC programs
	are developed with antiquated tools that support semi graphical
	languages for Boolean logic and assembly programming for numerical
	subsystems. The international standard IEC-1131 is attempting to
	fill this vacuum by specifying such a language. Unfortunately this
	standard simply freezes current programming practice, by
	incorporating five different languages, four of which are the semi
	graphical and assembly languages in common use today. For
	algorithmic programming it introduces a completely new High Level
	Language called 'Structured Text', which will require a large
	learning effort by programmers and whose utility in the limited area
	of PLC's seems doubtful. IEC-1131 makes no attempt to confront the
	fundamental speed problems facing PLC users. 
	</P>
</UL>
<P CLASS="western" STYLE="line-height: 0.4cm">Because PLC's are
completely compute bound, the type of program organization they use
is unacceptable for standard computers. Nevertheless many programmers
designing event controlled applications on standard computers resort
to polling schemes, despite the drawbacks involved. The High Level
Languages they use do not give them any simple alternatives. 
</P>
<P CLASS="western" STYLE="line-height: 0.4cm">The language <I>iC</I>
can be used to program standard computer systems and PLC's in a
uniform way. <I>iC</I> is fast, because it responds immediately to
any changes in input, and does not waste time evaluating expressions,
whose input operands have not changed. The extensions which <I>iC</I>
offers over the algorithmic language C, can also be coded
graphically, using current CAD packages for IC design. For factory
staff, who require very simple programming methods, the use of <I>Ladder
Diagram (LD)</I> or <I>Function Block Diagram (FBD)</I> in conformity
with IEC-1131, using suitable front ends is possible. 
</P>
<H2 CLASS="western"><A NAME="1.4.  Relationship to Integrated Circuits|outline"></A>
1.4  Relationship to Integrated Circuits</H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><I>iC</I>
provides programmers with built in operators, whose function is
closely modelled on integrated circuits. The name <I>iC</I> is a
reminder of this fact. Logical <I>AND</I>, <I>OR</I>, <I>EXCLUSIVE-OR
</I>and <I>NOT</I> are the basic functions implemented using a very
fast data-flow algorithm. The full range of arithmetic operators is
also available. These are not normally considered as hardware
components, although once they formed the basis of the very important
&ldquo;Analog Computer&rdquo;. They can be used for implementing
control algorithms, fuzzy logic &ndash; the possibilities are
endless. Also implemented as efficient built in functions are the D
flip-flop, SR flip-flop, JK flip-flop, shift register and many other
popular integrated circuit types, which are implemented in such a
way, that their use in <I>iC</I> programs follows the same design
rules, which apply to their hardware counterparts. These rules have
led to a well-developed hardware technology, whose effectiveness is
demonstrated by the success of today's complex computer hardware.
Particularly the concept of clocked functions plays an important role
in the language <I>iC</I>. It gives the same protection against
timing races in <I>iC</I> programs, as it provides for hardware IC
designs. 
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">Another
idea taken from integrated circuits is Large-Scale-Integration. User
defined Function Blocks emulate LSI circuits and produce complex
sub-units with a known functionality and a well defined external
interface, which can be re-used without regard to the internals. IC
hardware design may not be part of the average programmers
repertoire, but there is much literature on the subject. The run-time
code is not meant to be just a simulation of IC hardware &ndash; the
generated code is extremely fast, because of the data-flow techniques
used and can provide useful control programs. 
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="1.5.  Summary|outline"></A>
1.5  <FONT FACE="Sanserif PS">Summary</FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">Writing
programs in the language <I>iC</I> has the added quality, that many
simple ideas and relationships, which should result in direct
actions, can be written down <I>immediately</I> in one line. 
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; font-style: normal"><FONT FACE="Courier, monospace"><B>if
(IX0.0) { printf(&rdquo;Hello! world\n&rdquo;); }</B></FONT></P>
<P CLASS="western">This is a complete runnable <I>iC</I> program.
<FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">IX0.0
</SPAN></FONT>is an external <I>immediate</I> bit input in IEC-1131
notation, which generates an event when it changes state. The coding
of call back routines and other overhead is not required. It was this
thought, which also prompted the name &quot;<I>immediate C</I>&quot;.
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="2.    Language description|outline"></A>
<FONT SIZE=4>2    Language description</FONT></H1>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.1.  Immediate Variables |outline"></A>
2.1<I>  </I><FONT FACE="Sanserif PS"><I>Immediate</I></FONT><FONT FACE="Sanserif PS">
Variables </FONT>
</H2>
<P CLASS="western">An <I>immediate</I> variable is a data object that
has a value, but which also has the ability to transmit any change in
its value as an event. This event triggers the re-calculation of all 
expressions that contain the <I>immediate</I> variable. The
fundamental assumption is, that <B>the value of an expression only
changes, if one of the variables making up the expression changes</B>.
Thus it is only necessary to re-calculate an expression, if one of
the variables making up the expression changes. Conversely, if an
expression is re-calculated whenever one of its variables changes,
and all unnecessary recalculations of expressions are left out, the
value of all expressions will be up to date within a very short time.
<I>Immediate</I> variables provide the mechanism to make this
strategy possible.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.2.  Immediate Types|outline"></A>
2.2  <FONT FACE="Sanserif PS">Immediate Types</FONT></H2>
<P CLASS="western"><I>iC</I> introduces the type modifier <FONT FACE="courier, monospace"><B>imm</B></FONT>
to declare <I>immediate</I> variables of the basic data types <FONT FACE="courier, monospace"><B>int</B></FONT>
in C and the basic data type <FONT FACE="courier, monospace"><B>bit</B></FONT>,
which is a new data type in <I>iC</I>. Type <FONT FACE="courier, monospace"><B>bit</B></FONT>
declares variables capable of holding the values <FONT FACE="courier, monospace"><FONT SIZE=2><B>0
</B></FONT></FONT>and <FONT FACE="courier, monospace"><FONT SIZE=2><B>1</B></FONT></FONT>.
Unless the C or C++ compiler, used to translate the generated code,
itself supports bit as a basic data type, the use of type bit is
restricted to <FONT FACE="courier, monospace"><B>imm bit</B></FONT>.
The word 'boolean' was avoided deliberately, because it has a
different semantic bias in languages where it is used. (Truth of a
test rather than single bit objects). Both  <FONT FACE="courier, monospace"><B>imm
int</B></FONT> and <FONT FACE="courier, monospace"><B>imm bit </B></FONT><SPAN STYLE="font-style: normal">are
value types.</SPAN></P>
<P CLASS="western"><I>iC</I> also has clocking types <FONT FACE="courier, monospace"><B>imm
clock</B></FONT> and <FONT FACE="courier, monospace"><B>imm timer</B></FONT>,
which can only be used as function parameters. These will be
discussed later.</P>
<H3 CLASS="western"><A NAME="2.2.1.  Immediate declarations|outline"></A>
2.2.1<I> </I><SPAN STYLE="font-style: normal"> </SPAN><I>Immediate</I><SPAN STYLE="font-style: normal">
declarations</SPAN></H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
An <I>immediate</I> declaration declares an <I>immediate</I> variable
to be either of type <FONT FACE="courier, monospace"><B>imm int</B></FONT>,
<FONT FACE="courier, monospace"><B>imm bit</B></FONT>, <FONT FACE="courier, monospace"><B>imm
clock</B></FONT> or <FONT FACE="courier, monospace"><B>imm timer</B></FONT>,
using syntax similar to declarations in C. Any value type variable
not declared before it is used is assumed to be of type <FONT FACE="courier, monospace"><B>imm
bit</B></FONT>. Undeclared clocking type variables inherit the type
from the assigning function. Calling the <I>immcc</I> compiler with
the strict option -S makes declarations mandatory for all <FONT FACE="courier, monospace"><B>imm
</B></FONT>variables &ndash; this is highly recommended. All
variables in a declaration may be assigned directly.</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; font-style: normal">
<FONT FACE="Courier, monospace"><B>imm int</B></FONT><FONT FACE="Courier, monospace">
fader, colour;				// declaration only<BR></FONT><FONT FACE="Courier, monospace"><B>imm
int</B></FONT><FONT FACE="Courier, monospace"> brightness = fader *
colour;	// decl and assignment</FONT></P>
<H3 CLASS="western"><A NAME="2.2.2.  extern immediate declarations|outline"></A>
2.2.2<I>  </I><SPAN STYLE="font-style: normal">extern </SPAN><I>immediate</I><SPAN STYLE="font-style: normal">
declarations</SPAN></H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Just like in C, several <I>iC</I> sources may be compiled separately
and linked into a single application. When immediate variables
declared and assigned in one source are referenced in another source,
they must be declared with an <FONT FACE="Courier, monospace"><B>extern</B></FONT>
declaration, before they can be used in an expression. 
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; font-style: normal"><FONT FACE="Courier, monospace"><B>extern
imm int</B></FONT><FONT FACE="Courier, monospace"> fader,
colour;	<BR></FONT><FONT FACE="Courier, monospace"><B>extern imm int</B></FONT><FONT FACE="Courier, monospace">
brightness;</FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.3.  Immediate Expressions |outline"></A>
<FONT FACE="Sanserif PS">2.3<I>  Immediate</I> Expressions </FONT>
</H2>
<P CLASS="western"><I>Immediate</I> expressions are arithmetic or bit
expressions external to all functions, which contain at least one
<I>immediate</I> value variable. <I>Immediate</I> arithmetic
expressions may also contain constant expressions. An <I>immediate</I>
expression is re-calculated whenever the value of one of the
<I>immediate</I> variables it contains has changed. If an expression
consists only of constants and no <I>immediate</I> variables it is a
constant expression evaluated once during initialisation.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.4.  Operators in immediate expressions|outline"></A>
<FONT FACE="Sanserif PS">2.4  Operators in <I>immediate</I>
expressions</FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Most operators available in C may be used with <I>immediate</I>
variables. The precedence of the operators is the same as in C. Some
C operators are not valid for <I>immediate</I> expressions, because
the semantics are different. These are the increment and decrement
operators <FONT FACE="Courier, monospace"><B>++</B></FONT> and <FONT FACE="Courier, monospace"><B>--</B></FONT>,
as well as structure and pointer operators <FONT FACE="Courier, monospace"><B>-&gt;
.</B></FONT>(dot) <FONT FACE="Courier, monospace"><B>&amp;</B></FONT>(address
of) and <FONT FACE="Courier, monospace"><B>*</B></FONT>(pointer
dereference). Assignment expressions <FONT FACE="Courier, monospace"><B>+=
</B></FONT>etc. are also not allowed. These restrictions do not apply
to embedded C code in literal blocks and <I>immediate</I> <I><SPAN STYLE="font-weight: normal">if
else</SPAN></I><B> </B>or <I><SPAN STYLE="font-weight: normal">switch</SPAN></I>
statements, which will be introduced later.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Array variables and index expressions using <B>[ ]</B> are available
with the Array extension of the language using the pre-compiler <B>immac</B>
(called automatically). See section <A HREF="#3.    Arrays|outline">section
3.</A></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<BR><BR>
</P>
<H3 CLASS="western"><A NAME="2.4.1.  Arithmetic and Relational Operators|outline"></A>
2.4.1  Arithmetic and Relational Operators</H3>
<P CLASS="western">The binary arithmetic operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>+
- * /</B></FONT></FONT>, the modulo operator <FONT FACE="courier, monospace"><FONT SIZE=2><B>%</B></FONT></FONT>,
as well as unary <FONT FACE="courier, monospace"><FONT SIZE=2><B>-</B></FONT></FONT>
and <FONT FACE="courier, monospace"><FONT SIZE=2><B>+ </B></FONT></FONT>operate
on numeric values and yield<FONT FACE="Sanserif PS"><FONT SIZE=2><B>
</B></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">numeric
</SPAN></FONT></FONT>results of type <FONT FACE="courier, monospace"><B>imm
int</B></FONT>. The same applies to the shift operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&lt;&lt;
</B></FONT></FONT>and <FONT FACE="courier, monospace"><FONT SIZE=2><B>&gt;&gt;</B></FONT></FONT>.
If an operand of the wrong type is used with one of these operators,
automatic type conversion takes place. Values of type <FONT FACE="courier, monospace"><B>imm
bit</B></FONT> are converted to the <FONT FACE="courier, monospace"><B>int</B></FONT>
value<SPAN STYLE="font-weight: normal">s 0 or 1 corresponding to the
values of the</SPAN><B> </B><FONT FACE="courier, monospace"><B>bit</B></FONT>.
The relational and equality operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&lt;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>&lt;=</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>&gt;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>&gt;=</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>==</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>!=</B></FONT></FONT>
also have numeric operands, but these operators yield <FONT FACE="courier, monospace"><B>imm
bit</B></FONT> results by default. 
</P>
<H3 CLASS="western"><A NAME="2.4.2.  Bitwise and Bit Operators|outline"></A>
2.4.2  Bitwise and Bit Operators</H3>
<P CLASS="western">If both operands of the binary operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>|</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>^ </B></FONT></FONT>or
the single operand of operator <FONT FACE="courier, monospace"><FONT SIZE=2><B>~</B></FONT></FONT>
are of type <FONT FACE="courier, monospace"><B>imm int</B></FONT>,
these operators carry out bitwise manipulation on their integer
operands &ndash; just like in C. The result is an <FONT FACE="courier, monospace"><B>imm
int</B></FONT>. <I>Immediate</I> arithmetic, relational and bitwise
logical expressions with numeric operands may contain constants, as
well as <I>immediate</I> operands. 
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
If one of the operands of the binary operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>|</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>^ </B></FONT></FONT>or
the single operand of operator <FONT FACE="courier, monospace"><FONT SIZE=2><B>~</B></FONT></FONT>
are of type <FONT FACE="courier, monospace"><B>imm bit</B></FONT>,
these operators carry out the bit manipulation operations <I><B>and</B></I>,
<I><B>or</B></I>, <I><B>exclusive-or </B></I>and <I><B>not</B></I> on
<FONT FACE="courier, monospace"><B>imm bit</B></FONT> objects. The
result is an <FONT FACE="courier, monospace"><B>imm bit</B></FONT>.
Any operands of type <FONT FACE="courier, monospace"><B>imm int</B></FONT>
are converted to <FONT FACE="courier, monospace"><B>imm bit</B></FONT>.
The numeric value <FONT FACE="courier, monospace"><FONT SIZE=2><B>0
</B></FONT></FONT>converts to <FONT FACE="courier, monospace"><FONT SIZE=2><B>0
</B></FONT></FONT>(<FONT FACE="courier, monospace"><FONT SIZE=2><B>false</B></FONT></FONT>),
any other arithmetic value converts to <FONT FACE="courier, monospace"><FONT SIZE=2><B>1
</B></FONT></FONT>(<FONT FACE="courier, monospace"><FONT SIZE=2><B>true</B></FONT></FONT>).
The bit operators are used frequently in <I>immediate C</I>, since
bit manipulation is very common in event driven systems &ndash; more
so than in algorithmic programs written in conventional languages
like C, which does not even provide a type <I>bit</I>. Such logical
bit expressions in <I>immediate C</I> may not contain any constants
or <I>non-immediate</I> values. Constants in <I>immediate</I> bit
expressions do not make much sense. They either do not change a
variable (<FONT FACE="courier, monospace"><FONT SIZE=2><B>a &amp; 1</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>b | 0</B></FONT></FONT>)
or they produce another constant (<FONT FACE="courier, monospace"><FONT SIZE=2><B>c
&amp; 0</B></FONT></FONT>, <FONT FACE="courier, monospace"><FONT SIZE=2><B>d
| 1</B></FONT></FONT>, <FONT FACE="courier, monospace"><FONT SIZE=2><B>~1</B></FONT></FONT>).
</P>
<H3 CLASS="western"><A NAME="2.4.3.  Logical Operators|outline"></A>2.4.3
 Logical Operators</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The logical connectives <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;&amp;
</B></FONT></FONT>and <FONT FACE="courier, monospace"><FONT SIZE=2><B>||
</B></FONT></FONT>are executed as arithmetic expressions, when one of
the operands is of type <FONT FACE="courier, monospace"><B>imm int</B></FONT>.
Evaluation is from left to right, and evaluation stops when the truth
or falsehood of the result is known &ndash; just like in C. The
result is of type <FONT FACE="courier, monospace"><B>imm bit</B></FONT>
by default. The unary complement operator <FONT FACE="courier, monospace"><FONT SIZE=2><B>!</B></FONT></FONT>,
operating on an <FONT FACE="courier, monospace"><B>imm int</B></FONT>
produces an <FONT FACE="courier, monospace"><B>imm bit</B></FONT>
result. 
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;&amp;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>|| </B></FONT></FONT>and
<FONT FACE="courier, monospace"><FONT SIZE=2><B>! </B></FONT></FONT>with
only <FONT FACE="courier, monospace"><B>imm bit</B></FONT> operands
are interpreted by the compiler exactly like the logical operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>| </B></FONT></FONT>and
<FONT FACE="courier, monospace"><FONT SIZE=2><B>~</B></FONT></FONT>.
There is little sense converting such bit operands to integers,
evaluating the arithmetic expression and then converting back to a
bit. Since evaluation of <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;&amp;
</B></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">and
</SPAN></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><B>||
</B></FONT></FONT>in bit expressions is not from left to right as
expected, but depends on which operands in the expression change,
their use and the use of <FONT FACE="courier, monospace"><FONT SIZE=2><B>!</B></FONT></FONT>
in expressions where all operands are  <FONT FACE="courier, monospace"><B>imm
bit</B></FONT> is deprecated and causes a warning.</P>
<H3 CLASS="western"><A NAME="2.4.4.  Conditional Operators|outline"></A>
2.4.4  Conditional Operators</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>? :
</B></FONT></FONT>implement conditional expressions, which are
evaluated as a whole in an arithmetic context. The conditional
expression 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">expression_1
<B>?</B> expression_2 <B>:</B> expression_3 </FONT>
</P>
<P CLASS="western">is a valid <I>immediate</I> arithmetic expression,
which is triggered by a change in any <I>immediate</I> variable in
any of the three sub-expressions.  An alternate form of conditional
expression, which leaves out the middle expression is allowed by
modern C compilers, particularly by <SPAN STYLE="font-style: normal"><B>gcc</B></SPAN>
and is allowed in <I>iC</I><SPAN STYLE="font-style: normal"> (if the
C compiler used supports the construct)</SPAN></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">expression_1
<B>? :</B> expression_3 </FONT>
</P>
<P CLASS="western"><FONT FACE="Sanserif PS"><FONT SIZE=2>The
following excerpt from 'info <SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">gcc</SPAN></SPAN>'
explains the advantages and use of the construct:</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
<FONT FACE="Sanserif PS"><FONT SIZE=1 STYLE="font-size: 8pt">5.8
Conditionals with Omitted Operands</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
<FONT FACE="Sanserif PS"><FONT SIZE=1 STYLE="font-size: 8pt">The
middle operand in a conditional expression may be omitted.  Then if
the first operand is non-zero, its value is the value of the
conditional expression.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
   <FONT FACE="Sanserif PS"><FONT SIZE=1 STYLE="font-size: 8pt">Therefore,
the expression</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; margin-bottom: 0.16cm; line-height: 0.32cm; page-break-inside: avoid; widows: 2; orphans: 2">
     <FONT FACE="Courier 10cpi"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT FACE="Courier, monospace"><B>x
? : y</B></FONT></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
<FONT FACE="Sanserif PS"><FONT SIZE=1 STYLE="font-size: 8pt">has the
value of `<FONT FACE="Courier, monospace"><B>x</B></FONT>' if that is
non-zero; otherwise, the value of `<FONT FACE="Courier, monospace"><B>y</B></FONT>'.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
   <FONT FACE="Sanserif PS"><FONT SIZE=1 STYLE="font-size: 8pt">This
example is perfectly equivalent to</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; margin-bottom: 0.16cm; line-height: 0.32cm; page-break-inside: avoid; widows: 2; orphans: 2">
     <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><B>x
? x : y</B></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
<FONT SIZE=1 STYLE="font-size: 8pt">In this simple case, the ability
to omit the middle operand is not especially useful.  When it becomes
useful is when the first operand does, or may (if it is a macro
argument), contain a side effect.  Then repeating the operand in the
middle would perform the side effect twice.  Omitting the middle
operand uses the value already computed <FONT FACE="Sanserif PS"><SPAN STYLE="font-weight: normal">without
the undesirable effects of recomputing it.</SPAN></FONT></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.5.  Function and macro calls|outline"></A>
<FONT FACE="Sanserif PS">2.5  Function and macro calls</FONT></H2>
<P CLASS="western"><I>Immediate</I> expressions may contain function
calls for several types of functions and macros. All of these look
very similar to C function calls. The differences will be discussed
in later chapters. These can be:</P>
<OL>
	<LI><P CLASS="western">Built in <I>iC</I> function calls. The
	parameter ramps and return values are pre-defined.</P>
	<LI><P CLASS="western">User defined <I>iC</I> function block calls.
	These must be defined by the user before they are called.</P>
	<LI><P CLASS="western">C function calls. 
	</P>
	<LI><P CLASS="western">C pre-processor macro calls.</P>
</OL>
<P CLASS="western">C function and macros called in immediate
expressions may only have <FONT FACE="Courier, monospace"><B>int</B></FONT>
parameters (if any) and an <FONT FACE="Courier, monospace"><B>int</B></FONT>
return value. They should be declared as follows to evoke an error
message if the function name is mistyped or the parameter ramp or
return value is wrong:</P>
<P CLASS="western" ALIGN=LEFT><FONT FACE="Courier, monospace">	<B>extern
int</B> rand();		// C function with no parameters<BR>	<B>extern int</B>
rand(<B>void</B>);		// alternative syntax<BR>	<B>extern int</B>
abs(<B>int);</B>		// C function with 1 parameter<BR>	<B>extern int</B>
min(<B>int</B>, <B>int</B>);	// macro with 2 parameters</FONT></P>
<P CLASS="western">When 'strict' is active, any C functions or
macros, which are called in <I>immediate</I> expressions must be
declared in the <I>iC</I> code.  If 'strict' is not active, mistyped
function names with any type of parameter ramp look like C function
calls and will be compiled as such without error. This error is not
discovered until link time. With an <FONT FACE="Courier, monospace"><B>extern</B></FONT>
declaration, a clean error message is produced and the extra effort
is not great. When a pre-declared C function or macro is called in an
immediate expression, a check is made, that the number of parameters
is correct. Otherwise an error message is issued. 
</P>
<P CLASS="western">If declared a second time, the following will
evoke a warning if 'strict'</P>
<P CLASS="western" ALIGN=LEFT><FONT FACE="Courier, monospace">	<B>extern
bit</B> rand();		// wrong return type &ndash; converted to int</FONT></P>
<P CLASS="western">If declared a second time, the following will
evoke an error if 'strict'</P>
<P CLASS="western" ALIGN=LEFT><FONT FACE="Courier, monospace">	<B>extern
int</B> rand;			// not used as a function<BR>	<B>extern clock</B>
rand();		// absolutely wrong return type<BR>	<B>extern timer</B>
rand();		// absolutely wrong return type</FONT></P>
<P CLASS="western">No check is made for C function calls in C
fragments controlled by <FONT FACE="Courier, monospace"><B>if else</B></FONT>
or <FONT FACE="Courier, monospace"><B>switch</B></FONT> statements or
other literal C code, since the compilation is handled by the follow
up C compiler. Note: built in <I>iC</I> functions and <I>iC</I>
function blocks can not be called in such C fragments under any
circumstances.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="DDE_LINK211"></A><A NAME="2.6.  Parentheses |outline"></A>
<FONT FACE="Sanserif PS">2.6  Parentheses </FONT>
</H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
In <I>immediate C</I> it is possible to write mixed arithmetic and
bit expressions, nested to any depth using the usual precedence rules
and parentheses.</P>
<P CLASS="western"><I>Immediate</I> arithmetic expressions are
evaluated as a whole C expression, every time one of their component
<I>immediate</I> variables changes &ndash; but only then. To improve
execution speed, it is sometimes more efficient to break up very long
<I>immediate</I> arithmetic expressions with many operands into
several sub-expressions &ndash; particularly if each sub-expression
is triggered by different operands. In this case not all the
sub-expressions are executed. On the other hand there is a certain
amount of overhead for triggering each new node and execution of a
compiled C expression is fast, even if it has many operands.</P>
<P CLASS="western"><I>Immediate</I> bit expressions are compiled into
a network of forward looking nodes, one for each different bit
operand and execute even more efficiently. There is no need to break
up a complex immediate bit expression into sub-expressions &ndash;
the compiler does this already. <I>Immediate</I> bit expressions
embedded in an arithmetic expression are compiled into separate
sub-expressions and only the type converted arithmetic result is used
in the arithmetic expression.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.7.  Immediate statements|outline"></A>
<FONT FACE="Sanserif PS">2.7<I>  Immediate</I> statements</FONT></H2>
<P CLASS="western">Most <I>immediate</I> statements are <I>immediate</I>
declarations or <I>immediate</I> assignments terminated by a
semicolon. <I>Immediate</I><I> </I><SPAN STYLE="font-style: normal">declarations</SPAN>
and assignments may be combined.</P>
<H3 CLASS="western"><A NAME="2.7.1.  Immediate Assignments |outline"></A>
2.7.1<I>  Immediate</I> Assignments 
</H3>
<P CLASS="western"><I>Immediate</I> assignments are assignments of
<I>immediate</I> expressions to <I>immediate</I> variables external
to all functions. Value changes to an <I>immediate</I> variable are
detected in the assignment and this event triggers the re-calculation
of follow on expressions.  Like in C, an <I>immediate</I> assignment
is also an <I>immediate</I> expression, which means that assignments
embedded in expressions are allowed. As noted earlier, <I>immediate</I>
assignments can be combined with the declarations of <I>immediate</I>
variables. 
</P>
<H3 CLASS="western"><A NAME="DDE_LINK21"></A><A NAME="2.7.2.  Aliases |outline"></A>
2.7.2  Aliases 
</H3>
<P CLASS="western"><I>Immediate</I> arithmetic and bit assignments,
in which the right hand expression consists of only a single
<I>immediate</I> variable are accepted by the <I>iC</I> compiler, but
produce no code. This type of statement is called an alias. The alias
name on the left hand side is simply an alternative name for the
<I>immediate</I> variable on the right hand side. Any reference to
the alias will be substituted by the right hand side variable, whose
value is always the correct <I>immediate</I> value of the intended
assignment. Bit aliases may be either <I>normal</I> or <I>inverting</I>.
The bit <I>not</I> operator <FONT FACE="Courier, monospace"><B>~</B></FONT>
does not produce any code when used on an <FONT FACE="Courier, monospace"><B>imm
bit </B></FONT>operand. All <FONT FACE="Courier, monospace"><B>~x
</B></FONT>sub-expressions are implemented as inverting aliases of <FONT FACE="Courier, monospace"><B>x</B></FONT>.
Thus the direct assignment of <FONT FACE="Courier, monospace"><B>~x
</B></FONT>to another <FONT FACE="Courier, monospace"><B>imm bit
</B></FONT>variable is also an (inverting) alias.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><A NAME="DDE_LINK3"></A>
<FONT FACE="Courier, monospace"><B>imm bit</B> a, b;	b = a;	// b is
an alias for a   (normal)<BR><B>imm bit</B> x, nx;	nx = ~x;	// nx is
an alias for ~x (inverting)<BR><B>imm int</B> j, k;	k = j;	// k is an
alias for j<BR><B>imm int</B> two;	two = 2;	// two is an alias for 2</FONT></P>
<H3 CLASS="western"><A NAME="2.7.3.  The single assignment rule |outline"></A>
2.7.3  The single assignment rule 
</H3>
<P CLASS="western"><I>Immediate</I> assignments must obey the single
assignment rule, a rule which applies generally for data flow
systems<A CLASS="sdfootnoteanc" NAME="sdfootnote1anc" HREF="#sdfootnote1sym"><SUP>1</SUP></A>.
Any <I>immediate</I> variable may only be assigned in <B>one</B>
<I>immediate</I> assignment. The value of an <I>immediate</I>
variable is the value of the expression, from which it is assigned,
at all times. A second assignment to the same <I>immediate</I>
variable would force different values on that variable, causing a
conflict. The <I>immediate</I> variable being assigned cannot hold
different values simultaneously. The single assignment rule is
monitored by the <I>iC</I> compiler. An error message is generated if
it is broken. 
</P>
<P CLASS="western">Expressions that occur in C code triggered by
<I>immediate</I> conditional <I>if else</I> or <I>switch</I>
statements or in C functions in literal blocks may contain <I>immediate</I>
variables. These expressions are not <I>immediate</I> expressions and
are not triggered by those variables. When such an expression is
executed in the C code, the current value of any <I>immediate</I>
variable is used. 
</P>
<P CLASS="western"><I>Immediate</I> variables may even be assigned in
C code embedded in <I>immediate</I> conditional <I>if else</I> or
<I>switch</I> statements and in literal blocks. Such an assignment is
<B>not</B> an <I>immediate</I> assignment &ndash; the value is
changed when the C statement is executed. Nevertheless any change in
the <I>immediate</I> variable assigned in the C code will trigger
<I>immediate</I> expressions that contain that variable. Several such
assignments to the same <I>immediate</I> variable may be made inside
different sections of C code. Every new assignment changes the
variable in accordance with the intended algorithm. <I>Immediate</I> 
variables used in C code must be declared as <FONT FACE="courier, sans-serif"><B>immC
bit</B></FONT> or <FONT FACE="courier, sans-serif"><B>immC int</B></FONT>
in an  <I>iC</I> code section. An <I>immediate</I> variable that is
assigned in C code may not also be assigned in an <I>immediate</I>
assignment. 
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.8.  Immediate control statements|outline"></A>
<FONT FACE="Sanserif PS">2.8  I<I>mmediate control statements</I></FONT></H2>
<P CLASS="western">An <I>immediate</I> conditional <I>if else</I>
statement and an <I>immediate</I> <I>switch</I> statement are the
only control  constructs available in <I>iC</I>. The syntax of both
statement types is similar to their C counterpart, except that braces
around the C statements are mandatory. In particular an <I><SPAN STYLE="font-weight: normal">else
if</SPAN></I> is not allowed, since the <I><SPAN STYLE="font-weight: normal">if</SPAN></I>
after the <I><SPAN STYLE="font-weight: normal">else</SPAN></I> would
have been part of the C statement controlled by the <I><SPAN STYLE="font-weight: normal">else</SPAN></I>
part of the whole <I>immediate</I> <I><SPAN STYLE="font-weight: normal">if</SPAN></I>
statement, which would be very confusing. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>if</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>(</B></FONT><FONT FACE="Courier, monospace">imm_bit_expression</FONT><FONT FACE="Courier, monospace"><B>)</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>{</B></FONT><FONT FACE="Courier, monospace">
C_statement_1 </FONT><FONT FACE="Courier, monospace"><B>}</B></FONT><FONT FACE="Courier, monospace"><I><BR></I></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>if</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>(</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">imm_bit_expression</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>)</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>{</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
C_statement_1 </SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>}</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>else</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>{</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
C_statement_2 </SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>}</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><BR></SPAN></FONT><FONT FACE="Courier, monospace"><B>switch</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>(</B></FONT><FONT FACE="Courier, monospace">imm_int_expression</FONT><FONT FACE="Courier, monospace"><B>)</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>{</B></FONT><FONT FACE="Courier, monospace">
C_statement </FONT><FONT FACE="Courier, monospace"><B>}</B></FONT><FONT FACE="Courier, monospace">
</FONT></FONT>
</P>
<P CLASS="western">These are valid <I>immediate</I> statements when
they occur external to any function and when the controlling
expression is an <I>immediate</I> expression. The controlling
expressions in <I>immediate</I> conditional <I>if else</I> or <I>switch</I>
statements are synchronized by a clock. The default clock is <FONT FACE="Courier, monospace"><B>iClock</B></FONT>.
Other clocks or timers may be specified as explained in <A HREF="#4.  Clock Signals|outline">section
5</A>. In all cases any change in the controlling <I>immediate</I>
expression, synchronized by the controlling clock, triggers execution
of the C statements.</P>
<H3 CLASS="western"><A NAME="2.8.1.  Immediate conditional statement|outline"></A>
2.8.1<I>  Immediate </I><SPAN STYLE="font-style: normal">conditional
statement</SPAN></H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<I>immediate</I> conditional statements use the keyword <I><B>if</B></I>
and optionally<I><B> else</B></I>. The controlling expression for an
<I>immediate</I> conditional statement is an <I>immediate</I> bit
expression. If not, it is converted from <FONT FACE="Courier, monospace"><B>int</B></FONT><SPAN STYLE="font-weight: normal">
</SPAN>to<FONT FACE="Courier, monospace"><FONT SIZE=2><B> bit
</B></FONT></FONT>automatically. A <FONT FACE="Courier, monospace"><FONT SIZE=2><B>0</B></FONT></FONT>
to <FONT FACE="Courier, monospace"><FONT SIZE=2><B>1 </B></FONT></FONT>transition
or rising edge causes <FONT FACE="Courier, monospace">C_statement_1
</FONT>to be executed. A <FONT FACE="Courier, monospace"><FONT SIZE=2><B>1
</B></FONT></FONT>to <FONT FACE="Courier, monospace"><FONT SIZE=2><B>0
</B></FONT></FONT>transition or falling edge causes <FONT FACE="Courier, monospace">C_statement_2
</FONT>to be executed (if an <I>else</I> is coded). The <FONT FACE="Courier, monospace"><FONT SIZE=2>C_statements</FONT></FONT>
are embedded C compound statements, <B>not</B> <I>immediate</I>
statements.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>%{<BR>int
</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">a,
b, c;			/* C declarations in a literal block */</SPAN></FONT><FONT FACE="Courier, monospace"><B><BR>void
</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">reset</SPAN></FONT><FONT FACE="Courier, monospace"><B>(void);</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">		/*
C function declaration */</SPAN></FONT><FONT FACE="Courier, monospace"><B><BR>%}<BR><BR>imm
bit</B></FONT><FONT FACE="Courier, monospace"> sw1, sw2, sw3;	//
immediate declarations<BR><BR></FONT><FONT FACE="Courier, monospace"><B>if</B></FONT><FONT FACE="Courier, monospace">
(sw1 &amp; sw2 | sw3) </FONT><FONT FACE="Courier, monospace"><B>{</B></FONT><FONT FACE="Courier, monospace">	/*
imm controlling expression */<BR>	a = 1; b = 12; c = -2;	/* C code
executed on rising edge */<BR></FONT><FONT FACE="Courier, monospace"><B>}</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>else {</B></FONT><FONT FACE="Courier, monospace"><BR></FONT><FONT FACE="Courier, monospace"><B>	</B></FONT><FONT FACE="Courier, monospace">reset();			/*
C code executed on falling edge */<BR></FONT><FONT FACE="Courier, monospace"><B>}</B></FONT></FONT></P>
<H3 CLASS="western"><A NAME="2.8.2.  Immediate switch statement|outline"></A>
2.8.2  <I>Immediate switch</I><SPAN STYLE="font-style: normal">
statement</SPAN></H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
For the <I>immediate</I> <I>switch</I> statement, the controlling
expression is an <I>immediate</I> int expression. The <FONT FACE="Courier, monospace"><FONT SIZE=2>C_statement</FONT></FONT>
is an embedded compound statement, which has the usual form of a C
switch statement with case labels. Any change in the controlling
expression triggers the switch statement. The value of that
expression after the change is applied to the switch and the selected
case is executed. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>%{
enum </B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">Fuzzy</SPAN></FONT><FONT FACE="Courier, monospace"><B>
{ </B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">OFF,
DIM, MEDIUM, BRIGHT</SPAN></FONT><FONT FACE="Courier, monospace"><B>
}</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">;
</SPAN></FONT><FONT FACE="Courier, monospace"><B>%}</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">	//
literal block</SPAN></FONT><FONT FACE="Courier, monospace"><B><BR>switch</B></FONT><FONT FACE="Courier, monospace">
(brightness) </FONT><FONT FACE="Courier, monospace"><B>{</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">	//
declared and assigned above</SPAN></FONT><FONT FACE="Courier, monospace"><BR></FONT><FONT FACE="Courier, monospace"><B>	case</B></FONT><FONT FACE="Courier, monospace">
OFF:	lightVoltage(0);	</FONT><FONT FACE="Courier, monospace"><B>break</B></FONT><FONT FACE="Courier, monospace">;<BR></FONT><FONT FACE="Courier, monospace"><B>	case</B></FONT><FONT FACE="Courier, monospace">
DIM:	lightVoltage(10);	</FONT><FONT FACE="Courier, monospace"><B>break</B></FONT><FONT FACE="Courier, monospace">;<BR>	</FONT><FONT FACE="Courier, monospace"><B>case</B></FONT><FONT FACE="Courier, monospace">
MEDIUM:	lightVoltage(18);	</FONT><FONT FACE="Courier, monospace"><B>break</B></FONT><FONT FACE="Courier, monospace">;<BR>	</FONT><FONT FACE="Courier, monospace"><B>case</B></FONT><FONT FACE="Courier, monospace">
BRIGHT:	lightVoltage(24);	</FONT><FONT FACE="Courier, monospace"><B>break</B></FONT><FONT FACE="Courier, monospace">;<BR>	</FONT><FONT FACE="Courier, monospace"><B>default</B></FONT><FONT FACE="Courier, monospace">:	lightVoltage(24);	</FONT><FONT FACE="Courier, monospace"><B>break</B></FONT><FONT FACE="Courier, monospace">;<BR></FONT><FONT FACE="Courier, monospace"><B>}</B></FONT><FONT FACE="Courier, monospace">			//
end of immediate switch statement </FONT></FONT>
</P>
<P CLASS="western">The <I>immediate</I> conditional <I>if else</I>
and <I>switch</I> statements open the way to trigger the execution of
short C fragments on particular events. These events are either
rising or falling edges of bit values or changing arithmetic values.
If more than a fragment of C code is involved, it is good practice to
code this in a C function, and to call that function in the <I>immediate</I>
statement. Very long <I>immediate</I> statements would make the
purpose of those statements unclear. Depending on the time critical
nature of the application, C code should not take too long to
execute, because during the execution of such C-fragments the
processing of other immediate events is held up.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.9.  Literal blocks|outline"></A>
<FONT FACE="Sanserif PS">2.9  Literal blocks</FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Literal blocks are sections of C code enclosed in special braces <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%{
</B></FONT></FONT>and <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%}</B></FONT></FONT>.
They may occur before, between and after any <I>immediate</I>
statements. Literal blocks are copied verbatim to the front of the
generated C output code (without the special braces). Literal blocks
are useful to declare any C variables, define macros and to declare
and define auxiliary C functions to support the application. Any
C-pre-processor statements such as <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>#include
</B></FONT></FONT>or <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>#ifdef
</B></FONT></FONT>must be written as <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%#include
</B></FONT></FONT>or <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%#ifdef
</B></FONT></FONT>in the literal block. The <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%#</B></FONT></FONT>
must be written without intervening spaces. The <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%</B></FONT></FONT>
is dropped by the <I>iC</I> compiler in copying the literal block to
the generated C code. This allows C-pre-processor statements for the
<I>iC</I> sections of code which are resolved before the <I>iC</I>
compilation.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>%{</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal"><BR>%#include
&lt;math.h&gt;		/* special iC-pre-processor syntax */<BR>int x, y,
z;			/* declarations in a literal block */<BR>int abs(int);			/* C
function declaration */<BR></SPAN></FONT><FONT FACE="Courier, monospace"><B>%}</B></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The run-time system will call the function <FONT FACE="Courier, monospace"><B>iCbegin()</B></FONT>
when an <I>iC</I> application is started before any <I>immediate</I>
processing. This function can be provided by the user in a literal
block. If it is not provided, an empty function <FONT FACE="Courier, monospace"><B>iCbegin()</B></FONT>
returning 0 is provided by the system. User implementations should
return 1. One use of <FONT FACE="Courier, monospace"><B>iCbegin()</B></FONT>
is to initialise <FONT FACE="Courier, monospace"><B>immC</B></FONT>
variables. It may even contain a fork() call to spawn a child
process, which will run in parallel with normal immediate processing.
This opens up the way to build mixed applications using conventional
multi-process or multi-threaded control strategies in parallel with
<I>immediate</I> C code, which leaves a lot of CPU time to do other
things.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The complementary function <FONT FACE="Courier, monospace"><FONT SIZE=2><B>iCend()</B></FONT></FONT>
is called by the run-time system when an <I>iC</I> application is
terminated externally (<I>iC</I> applications never terminate by
themselves). <FONT FACE="Courier, monospace"><FONT SIZE=2><B>iCend()</B></FONT></FONT>
could be used to free memory allocated with <I>malloc</I> or <I>new</I>.
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; margin-bottom: 0.21cm; font-weight: normal; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>%{</B> <BR>int
iCbegin()	{ ...; return 1; } /* optional C initialisation */<BR>int
iCend()	{ ...; return 1; } /* optional C termination */<BR><B>%}</B></FONT></FONT></P>
<P CLASS="western">If the code in literal blocks, or code in C blocks
controlled by an <I>immediate</I> <I><SPAN STYLE="font-weight: normal">if
else</SPAN></I> or <I><SPAN STYLE="font-weight: normal">switch</SPAN></I>,
is specifically C++ code, then the generated code must be compiled by
a C++ compiler. The Code generated from the <I>iC</I> statements is
pure C code.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.10.  Comments|outline"></A>
<FONT FACE="Sanserif PS">2.10  Comments</FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
C style comments <FONT FACE="Courier, monospace"><B>/* ... */</B></FONT>
can be used anywhere between tokens of <I>iC</I> programs.<BR>C++
style comments<FONT FACE="Courier, monospace"><B> </B></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">may
be used at the end of </SPAN></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">iC</SPAN></I></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
lines.</SPAN></FONT></FONT>	<FONT FACE="Courier, monospace"><B>// ...</B></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Some older C compilers do not support C++ comments, so their use in
literal blocks and C statement blocks controlled by <FONT FACE="Sanserif PS"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">if
else</SPAN></I></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
or </SPAN></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">switch</SPAN></I></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><I><B>
</B></I></FONT></FONT>may lead to portability problems.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.11.  Scope of immediate statements|outline"></A>
<FONT FACE="Sanserif PS">2.11  Scope of <I>immediate</I> statements</FONT></H2>
<P CLASS="western"><I>Immediate</I> variables are global or static
and must be declared external to all functions like other global
variables in C. Moreover all <I>immediate</I> statements must also be
placed external to functions. A statement in a function is only
executed (made active) during the execution of that function.
<I>Immediate</I> statements are active at all times. 
</P>
<P CLASS="western">Consecutive <I>immediate</I> statements are <B>not</B>
executed in sequence. Each <I>immediate</I> statement is independent
of all other <I>immediate</I> statements. They can be placed in any
order, without influencing the behaviour of the program. This is
analogous to the placement of global variables and functions in C. 
</P>
<P CLASS="western"><I>Immediate</I> assignments are often combined
with their declarations and look like the initialization expressions
of ordinary global C variables. In C, this initialization takes place
before the function <I><SPAN STYLE="font-weight: normal">main()</SPAN></I>
is started. In <I>iC</I>, <I>immediate</I> statements simply stay
active until the program is stopped. For most of the time the process
running the <I>iC</I> program waits in a select() call, which wakes
up whenever an external input or internal timer changes. Because the
processing required to react to such an input is in the order of
microseconds, this strategy ensures that the CPU loading of an <I>iC</I>
process is minimal. This can be observed easily with tools like
<I>xosview</I> under Linux. Times measured with a modern 1.8 GHz
processor were &gt; 100 us, which is mostly overhead to get the input
process scheduled. The time to even execute a chain of 10 consecutive
events is of the order of 10 us. This corresponds to a 0.1% loading
for a process including a 100 ms timer, of which 0.01% is actually
used by the <I>immediate</I> statements.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi">/*
VERY SIMPLE WASHING MACHINE PROGRAM */	<BR><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> on;		// switch to turn
system on/off<BR></FONT><FONT FACE="Courier, monospace"><B>imm bit</B></FONT><FONT FACE="Courier, monospace">
waterLo;		// water level switch<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> tempLo;		//
thermostat, turns off when hot<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> fill = on &amp;
waterLo;	// fill with water until filled<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> heat = on &amp;
</FONT><FONT FACE="Courier, monospace"><B>~</B></FONT><FONT FACE="Courier, monospace">waterLo
&amp; tempLo;	// heat water when filled</FONT></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="2.12.  Intrinsic limitations of immediate statements |outline"></A>
<FONT FACE="Sanserif PS">2.12<I>  </I>Intrinsic limitations of
<I>immediate</I> statements </FONT>
</H2>
<P CLASS="western">Arrays of <I>immediate</I> variables have been
realized and will be covered in the next chapter. Structures
containing <I>immediate</I> variables have not been realized in the
current release, although they are possible and may be implemented in
a future release. Pointers to <I>immediate</I> variables in <I>immediate</I>
expressions are semantically indeterminate. They are therefore not
implemented. This is also pointed out in one of the recommendations
in the IEC-1131 standard, which justifies the language 'Structured
Text' instead of C on the grounds, that a pointer in a machine
control program has no meaning and could cause disaster. The same
limitation has been recognized in the language Java, which only
recognizes references as constant pointers.</P>
<P CLASS="western"><A NAME="DDE_LINK1"></A><I>Immediate</I>
assignments, in which the left hand side variable appears in the
right hand side expression are of very doubtful utility. Such a
statement expresses a very tight feedback loop, which will either
lock up, or generate a high speed oscillator. For this reason a
warning message is generated by the <I>iC</I> compiler. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> a, b;<BR>a = a &amp;
b;		// a locks up when b becomes 0<BR>b = </FONT><FONT FACE="Courier, monospace"><B>~</B></FONT><FONT FACE="Courier, monospace">b
| a;		// b oscillates when a is 0<BR></FONT><FONT FACE="Courier, monospace"><B>imm
int</B></FONT><FONT FACE="Courier, monospace"> j;<BR>j = j + 1;		// j
never catches up with itself </FONT></FONT>
</P>
<P CLASS="western">For the above reason the C assignment operators
<FONT FACE="Courier, monospace"><B>+=</B></FONT>, <FONT FACE="Courier, monospace"><B>-=</B></FONT>
etc. as well as <FONT FACE="Courier, monospace"><B>++</B></FONT> and
<FONT FACE="Courier, monospace"><B>--</B></FONT> cannot be used in
<I>immediate</I> statements. Feedback over several statements is
allowed, but oscillations are controlled so that the system does not
become compute bound. If  oscillations do occur, a runtime warning is
produced since they are probably not intended.</P>
<P CLASS="western">Like in any programming language, it is possible
to write incorrect <I>iC </I>programs. It is the job of the
programmer, to understand the model on which the execution of the <I>iC</I>
language constructs is based, and to create programs that use these
constructs correctly. <I>iC</I> is modelled on hardware building
blocks, which provides an easy starting point. 
</P>
<P CLASS="western">The following was probably intended by the last
statement above: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> gate, p;<BR></FONT><FONT FACE="Courier, monospace"><B>imm
int</B></FONT><FONT FACE="Courier, monospace"> j;		// j counts every
rising edge<BR></FONT><FONT FACE="Courier, monospace"><B>if</B></FONT><FONT FACE="Courier, monospace">
(gate &amp; p) </FONT><FONT FACE="Courier, monospace"><B>{</B></FONT><FONT FACE="Courier, monospace">
j++; </FONT><FONT FACE="Courier, monospace"><B>}</B></FONT><FONT FACE="Courier, monospace">		//
of p, while gate is hi </FONT></FONT>
</P>
<P CLASS="western">In this example, <FONT FACE="Courier, monospace">gate
&amp; p</FONT> is an <I>immediate</I> expression that triggers
execution of the <I>non-</I><I>immediate C</I> statement <FONT FACE="Courier, monospace">j++;</FONT>
Assignment operators <FONT FACE="Courier, monospace"><B>+=</B></FONT>,
<FONT FACE="Courier, monospace"><B>-= </B></FONT>etc. as well as <FONT FACE="Courier, monospace"><B>++</B></FONT>
and <FONT FACE="Courier, monospace"><B>--</B></FONT> with <I>immediate</I>
 variables are allowed in embedded C statements. The above construct
is one way to implement a counters in <I>iC</I>. A better way is
shown in <A HREF="#3.9.  Sample and Hold|outline">section 4.9</A>. 
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="DDE_LINK2"></A><A NAME="2.13.  Pragmas|outline"></A>
<FONT FACE="Sanserif PS">2.13  Pragmas</FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Pragmas affect the compilation phase of an <I>iC</I> program. Pragmas
are introduced by the keywords <FONT FACE="Courier, monospace"><FONT SIZE=2><B>use
</B></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">and
</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><B>no</B></FONT>.
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><B>use	</B></FONT>turns a pragma
option on	<BR><FONT FACE="Courier, monospace"><B>no	</B></FONT>turns
it off</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Currently two pragmas are implemented in <I>immediate</I> C: <FONT FACE="Courier, monospace"><B>alias</B></FONT>
and <FONT FACE="Courier, monospace"><B>strict</B></FONT>.</P>
<P ALIGN=LEFT STYLE="margin-left: 1.25cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>use
alias</B>;	// equivalent to -A command line option<BR><FONT FACE="Courier, monospace"><B>no
alias</B></FONT><FONT FACE="Courier, monospace">;		// turn alias
option off</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 1.25cm; page-break-inside: avoid"><A NAME="DDE_LINK4"></A><A NAME="DDE_LINK6"></A>
<FONT FACE="Courier, monospace"><B>use strict</B>;	// equivalent to
-S command line option<BR><FONT FACE="Courier, monospace"><B>no
strict</B></FONT><FONT FACE="Courier, monospace">;	// turn strict
option off</FONT></FONT></P>
<OL>
	<LI><P CLASS="western">The <FONT FACE="Courier, monospace"><B>alias</B></FONT>
	pragma or -A command line option forces the compiler to generate a
	node for each alias  in the generated C-code (default is to generate
	no node). This is needed in two circumstances:</P>
</OL>
<UL>
	<LI><P CLASS="western">It is required, if an <I>iC</I> source refers
	to an alias in another <I>iC</I> source by an <FONT FACE="Courier, monospace"><B>extern</B></FONT>
	reference. Since all references to aliases are normally removed from
	the compiled code, the C-object modules, which are generated from
	such code could not be linked. With the <FONT FACE="Courier, monospace"><B>use
	alias</B></FONT> option, the code can be linked and the remaining
	aliases are resolved at start up.</P>
	<LI><P CLASS="western"><A NAME="DDE_LINK5"></A>The <FONT FACE="Courier, monospace"><B>use
	alias</B></FONT> option is also useful for debugging. Only when it
	is set, are alias names displayed as active words by <B>iClive</B>. 
	</P>
</UL>
<OL START=2>
	<LI><P CLASS="western"><A NAME="DDE_LINK8"></A><A NAME="DDE_LINK9"></A>
	The <FONT FACE="Courier, monospace"><B>strict</B></FONT> pragma or
	-S command line option<SPAN STYLE="font-weight: normal"> forces the
	compiler to expect a declaration of all </SPAN><I><SPAN STYLE="font-weight: normal">immediate</SPAN></I><SPAN STYLE="font-weight: normal">
	variables, before assignment. The default with </SPAN><FONT FACE="Courier, monospace"><B>no
	strict</B></FONT><SPAN STYLE="font-weight: normal">, is to generate
	an </SPAN><FONT FACE="Courier, monospace"><B>imm bit</B></FONT><SPAN STYLE="font-weight: normal">
	node for an assignment to an undeclared name.</SPAN> Similarly an
	assignment to an undeclared name from a CLOCK() or TIMER() function
	call results in a default <FONT FACE="Courier, monospace"><B>imm
	clock</B></FONT> or <FONT FACE="Courier, monospace"><B>imm timer</B></FONT>
	variable. Such laxness is OK for small single source projects, but
	can lead to problems with larger projects. I had a case in a large
	project, where I had declared a number of <FONT FACE="Courier, monospace"><B>imm
	int</B></FONT> variables and mistyped one of them, so the correct
	name was not declared. This name was then assigned - but converted
	to <FONT FACE="Courier, monospace"><B>imm bit</B></FONT> and then
	back to <FONT FACE="Courier, monospace"><B>imm int</B></FONT> when
	used, leading to incorrect arithmetic.</P>
</OL>
<P CLASS="western" STYLE="margin-left: 1.25cm">As noted earlier, C
functions and macros should be declared extern with their correct
parameter ramp and return value. When &ldquo;strict&rdquo; is active,
error messages are output if an undeclared C function or macro is
called in an <I>immediate C</I> expression.</P>
<P CLASS="western">Several options (currently only two) may be set or
reset together in one pragma call:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><A NAME="DDE_LINK7"></A>
<FONT FACE="Courier, monospace"><B>use alias strict</B>;	//
equivalent to -AS command line option<BR><B>no strict alias</B>;	//
turn both options off</FONT></P>
<P CLASS="western">It is recommended to write 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><A NAME="DDE_LINK71"></A>
<FONT FACE="Courier, monospace"><B>use alias strict</B>;</FONT></P>
<P CLASS="western">as the first line of all production <I>iC</I>
programs - the space overhead for extra alias nodes is insignificant
and debugging becomes much easier. Particularly the <FONT FACE="Courier, monospace"><B>strict</B></FONT>
option is highly recommended anyway and results in no binary
overhead. (Grateful acknowledgements to the designers of PERL).</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The scope of these pragmas is a file. If a pragma is enabled in one
file it carries over to an included <I>iC</I> header file. If on the
other hand a pragma is changed in a header file, it reverts to its
previous value in the <I>iC</I> file after the #include statement,
which includes the header file. This makes sure that sloppy <I>iC</I>
programs, which include a header file, which uses &ldquo;<FONT FACE="Courier, monospace"><B>strict</B></FONT>&rdquo;
syntax, will not report errors, because they do not follow the
&ldquo;<FONT FACE="Courier, monospace"><B>strict</B></FONT>&rdquo;
syntax. This scope feature can only be used successfully with the <FONT FACE="Courier, monospace"><B>use
 strict</B></FONT> pragma, since <FONT FACE="Courier, monospace"><B>use
alias</B></FONT> only comes into effect during C code generation &ndash;
at this point the complete source has been parsed. This means <FONT FACE="Courier, monospace"><B>use
alias</B></FONT> should definitely be used once in <I>iC</I>
programs, which consists of several parts with extern references
between them. Other single source <I>iC</I> programs can <FONT FACE="Courier, monospace"><B>use
alias</B></FONT> , which produces slightly larger code, but which can
be debugged without recompiling with the -A flag. 
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="3.    Arrays|outline"></A><A NAME="3.    Arrays|outline"></A>
<FONT SIZE=4>3    Arrays</FONT></H1>
<P CLASS="western">Arrays in conventional instruction flow languages
are a named collection (often of fixed length) of similar variables,
which are accessed by an index expression, eg a[5]. Each such entity
is an individual object, but in instruction flow languages the index
is often a variable, which is manipulated in a loop and references to
the individual indexed entities occur sequentially, as in the
following C example:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>for
(</B>n = 0; n &lt; 4; n++<B>) {</B><BR>	a[n] = b[n] * c[n];<BR><B>}</B></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="3.1.  Immediate Arrays |outline"></A>
<FONT FACE="Sanserif PS">3.1<I>  Immediate</I> Arrays </FONT>
</H2>
<P CLASS="western">In data flow languages like <I>immediate C</I>
loops at run-time are meaningless. Each <I>immediate</I> variable is
an entity, which is controlled by one assignment statement. The
variable changes, when a variable in the expression of the
controlling statement changes and not when some loop runs. It is well
to remember, that <I>immediate</I> variables and their controlling
expressions are more like IC building blocks connected in a static
network. In that sense <I>immediate</I> Arrays are like hardware
registers.</P>
<P CLASS="western">Arrays may be defined in <I>immediate C</I>, but
each entity acts individually at run-time, which means that an
individual <I>immediate</I> object must be generated for each
<I>immediate</I> array member.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="3.2.  Use of immediate Arrays|outline"></A>
<FONT FACE="Sanserif PS">3.2  Use of immediate Arrays</FONT></H2>
<P CLASS="western">Arrays in conventional languages as well as in
<I>immediate C</I> give programmers extra capabilities to express
themselves. These fall into two distinct categories:</P>
<OL>
	<LI><P CLASS="western">Arrays allow the writing of repeated similar
	statements as one statement &ndash; this saves a lot of writing, but
	could also be done without arrays.</P>
	<LI><P CLASS="western">Additionally arrays allow the parametrisation
	of the array length, both within the program and in the command line
	of the program, which is probably more important. For <I>immediate
	C</I>, this makes possible the writing of control programs in which
	the number of control elements or groups is variable and the actual
	number is not bound until compile time. This would not be possible
	without arrays in the language. 
	</P>
	<P CLASS="western">NOTE: the definition of dynamic arrays, whose
	sizes change at run-time is meaningless and not possible in
	<I>immediate C</I>.</P>
</OL>
<P CLASS="western">An example of the usefulness of arrays in the
language would be an <I>iC</I> program controlling lifts in a
building. The number of floors varies from building to building &ndash;
so do the number of parallel lifts, which may be required. With
arrays, a single <I>iC</I> program can be written, which can be
compiled for a different number of floors and a different number of
parallel lifts as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>immac
-P FLOORS=12 -P LIFTS=2 liftControl.ica</B></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="3.3.  Implementation of immediate Arrays|outline"></A>
<FONT FACE="Sanserif PS">3.3  Implementation of immediate Arrays</FONT></H2>
<P CLASS="western">Since each immediate array member is an individual
immediate object at run time, it is important for debugging with
<B>iClive</B> to be able to have a listing showing each individual
array member &ndash; not just its collective form, eg a[n]. To
achieve this, an <I>iC</I> program containing arrays is translated by
the pre-processor <B>immac</B> to <I>iC</I> code without arrays. This
is a simple text operation in which macros are expanded, loops are
unrolled and index expressions are evaluated.</P>
<P CLASS="western">The <I>iC</I> language with arrays has three
additional language extensions:</P>
<OL>
	<LI><P CLASS="western">C-style 'FOR loops', which define a loop
	variable and a range.</P>
	<LI><P CLASS="western">Index expressions in square brackets, which
	allow the definition of array variables &ndash; usually in a loop.</P>
	<LI><P CLASS="western">Macro definitions, which are processed
	directly by <B>immac</B> - can be defined in two ways:</P>
</OL>
<UL>
	<LI><P CLASS="western">in C-pre-processor style with <FONT FACE="Courier, monospace"><B>%define</B></FONT>
	instead of <FONT FACE="Courier, monospace"><B>#define</B></FONT>,
	eg	<BR><FONT FACE="Courier, monospace"><B>%define FLOORS 12</B></FONT></P>
	<LI><P CLASS="western">in the command line, just like for a C
	compiler, eg	<BR><FONT FACE="Courier, monospace"><B>-P FLOORS=12</B></FONT></P>
	<P CLASS="western">Macros will mostly be used inside the square
	brackets of an array variable or in the control line of a FOR loop,
	but they can be used anywhere in the <I>iC</I> code or in the
	definition of another <FONT FACE="Courier, monospace"><B>%define</B></FONT>
	macro &ndash; macros may be nested. The above implies, that the
	<B>immac</B> pre-compiler could be used as a macro pre-processor for
	<I>iC</I> programs without any arrays at all.</P>
</UL>
<P CLASS="western"><I>iC</I> programs containing the above three
extensions are called <I>iCa</I> programs and should be written in a
file with the extension .ica &ndash; the <B>immac</B> pre-compiler
translates an <I>iCa</I> program to an <I>iC</I> program with the
extension .ic in which macros and 'FOR loops' are expanded and
<I>immediate</I> array instances are converted to simple <I>immediate</I>
variables. The following <I>iCa</I> snippet in file lift.ica</P>
<P ALIGN=LEFT STYLE="margin-left: 0.97cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>%define</B>
FLOORS 4</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.97cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>FOR
</B>(n = 0; n &lt; FLOORS; n++) <B>{</B><BR>	imm bit a[n] = b[n] &amp;
c[n];<BR><B>}</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">expands to the
following <I>iC</I> file lift.ic when compiled by <B>immac</B>:</P>
<P ALIGN=LEFT STYLE="margin-left: 1.01cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace">	imm bit a0 = b0 &amp; c0;<BR>	imm
bit a1 = b1 &amp; c1;<BR>	imm bit a2 = b2 &amp; c2;<BR>	imm bit a3 =
b3 &amp; c3;</FONT></P>
<P CLASS="western" STYLE="font-style: normal">The 'FOR loop' is
executed at compile time and generates repeated copies of the
statement(s) in the compound statement controlled by the loop. This
only makes sense, if there are elements in the loop statement(s),
which are modified by index operations using the control variable of
the 'FOR statement' &ndash; in the above example that is the variable
<FONT FACE="Courier, monospace"><B>n</B></FONT>. 
</P>
<P CLASS="western" STYLE="font-style: normal">The translation of
indices in square brackets is carried out in two steps:</P>
<OL>
	<LI><P CLASS="western" STYLE="font-style: normal">The expression in
	square brackets is evaluated as an integer expression.</P>
	<LI><P CLASS="western" STYLE="font-style: normal">The numerical
	value produced replaces the square brackets and the expression it
	contains.</P>
</OL>
<P CLASS="western" STYLE="font-style: normal">In the above example
the index expressions are simply the variable <FONT FACE="Courier, monospace"><B>n</B></FONT>.
But the index expressions can be more complex. A feature of <I>iCa</I>
indexing may seem strange at first, but it turns out to be very
useful; the square bracketed index expression may be placed anywhere
in a word, not only at the end of a word. It may even be placed on
its own &ndash; in that case the expression is evaluated and becomes
a suitably modified integer constant in an <I>iC</I> statement. The
following example shows both:</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>FOR</B>
(n = 0; n &lt; 10; n++) <B>{</B><BR>	QB[n] = IB[n+1] *
[n+2];<BR>	QX[n/8].[n%8] = IX[n/8].[n%8] &amp; <SPAN STYLE="font-style: normal">IX[10+(n/8)]</SPAN>.[n%8];	//
out: [n]<BR><B>}</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">expands to :</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace">	QB0 = IB1 * 2;<BR>	QX0.0 = IX0.0 &amp;
IX10.0;	// out: 0<BR>	QB1 = IB2 * 3;<BR>	QX0.1 = IX0.1 &amp;
IX10.1;	// out: 1<BR>	QB2 = IB3 * 4;<BR>	QX0.2 = IX0.2 &amp;
IX10.2;	// out: 2<BR>	QB3 = IB4 * 5;<BR>	QX0.3 = IX0.3 &amp;
IX10.3;	// out: 3<BR>	QB4 = IB5 * 6;<BR>	QX0.4 = IX0.4 &amp;
IX10.4;	// out: 4<BR>	QB5 = IB6 * 7;<BR>	QX0.5 = IX0.5 &amp;
IX10.5;	// out: 5<BR>	QB6 = IB7 * 8;<BR>	QX0.6 = IX0.6 &amp;
IX10.6;	// out: 6<BR>	QB7 = IB8 * 9;<BR>	QX0.7 = IX0.7 &amp;
IX10.7;	// out: 7<BR>	QB8 = IB9 * 10;<BR>	QX1.0 = IX1.0 &amp;
IX11.0;	// out: 8<BR>	QB9 = IB10 * 11;<BR>	QX1.1 = IX1.1 &amp;
IX11.1;	// out: 9</FONT></P>
<P CLASS="western">As shown above, index expressions may even be used
in comments. This can be useful, because the expanded <I>iC</I> text
must later be used for debugging with iClive &ndash; the original
text with 'FOR loops' and index expressions is not meaningful for
following the values of actual nodes at run-time. The above example
already gives a hint of how much writing can be saved. The way I/O
bit variables following the IEC-1131 standard are expanded is
particularly useful.</P>
<P CLASS="western"><A NAME="arrays"></A>The <I>iCa</I> extensions to
the <I>iC</I> language can be embedded as additional lines in regular
<I>iC</I> code. A FOR statement and a %define macro definition may
<B>not</B> be embedded in the middle of a line of <I>iC</I> code &ndash;
not even between <I>iC</I> statements, which have been written in one
line. This limitation is similar to the limitations imposed by the C
pre-processor <B>cpp</B> on the C language.</P>
<H3 CLASS="western"><A NAME="3.3.1.  FOR loops|outline"></A>3.3.1 
FOR loops</H3>
<P CLASS="western" STYLE="font-style: normal">'FOR loops' follow the
syntax of C 'for statements' with the difference, that the controlled
<I>iC</I> statements <B>must</B> be enclosed in braces (which is also
required for <I>immediate</I> <B>switch</B> and <B>if else</B>
statements):</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>FOR
(</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">expr1;
expr2; expr3</SPAN></FONT><FONT FACE="Courier, monospace"><B>) {<BR>	</B></FONT><FONT FACE="Courier, monospace"><I><B>iC
statement(s), which are repeated under control of the loop<BR>	or
nested 'FOR loops'</B></I></FONT><FONT FACE="Courier, monospace"><B><BR>}</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">Other restrictions are:</P>
<OL>
	<LI><P CLASS="western" STYLE="font-style: normal">The controlling
	FOR (;;) must be written in a single line. 
	</P>
	<LI><P CLASS="western" STYLE="font-style: normal">The opening brace
	may follow the FOR (;;) on that line or must be written by itself on
	the next line.</P>
	<LI><P CLASS="western" STYLE="font-style: normal">The closing brace
	must follow any <I>iC</I> statement(s) on a line by itself.</P>
	<LI><P CLASS="western" STYLE="font-style: normal">The 'FOR
	statement' line and the lines containing braces controlled by the
	'FOR statement' may finish with a C or C++ comment (a C comment must
	finish on that line). There may be no leading or embedded
	comment(s). 
	</P>
	<LI><P CLASS="western" STYLE="font-style: normal">A 'FOR statement'
	may only use one control variable, which is an <FONT FACE="Courier, monospace"><B>int</B></FONT>
	by default:</P>
	<OL>
		<P ALIGN=LEFT STYLE="font-style: normal; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>FOR
		(</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">n
		= 0; n &lt; 10; n++</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
		or FOR (int </B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">n
		= 0; n &lt; 10; n++</SPAN></FONT><FONT FACE="Courier, monospace"><B>)</B></FONT></FONT></P>
	</OL>
	<P CLASS="western" STYLE="font-style: normal">The control variable
	is the first 'word' of expr1, which is not '<FONT FACE="Courier, monospace"><B>int</B></FONT>'
	followed by '='. The word '<FONT FACE="Courier, monospace"><B>int</B></FONT>'
	in the second form is optional and can be written to remind
	programmers, that the control variable is an integer. The control
	variable may not be declared anywhere else.</P>
	<LI><P CLASS="western" STYLE="font-style: normal">Other atoms in the
	three expressions must be either constant expressions or expressions
	which contain control variables of the current and of outer 'FOR
	loops'. All expressions may contain macros, which must expand to
	integer constants or expressions containing valid loop control
	variables. Under no circumstances may <I>immediate</I> variables be
	used in these expressions.</P>
	<LI><P CLASS="western" STYLE="font-style: normal">The names of
	control variables must be different from any <I>immediate</I>
	variable.</P>
	<LI><P CLASS="western" STYLE="font-style: normal">The scope of the
	control variable of a 'FOR loop' begins when the control variable is
	initialised in the 'FOR statement' and ends with the final matching
	brace. The control variable is not valid outside of this scope.</P>
</OL>
<P CLASS="western" STYLE="font-style: normal">Since <B>immac</B> is
implemented as a Perl script, an alternate Perl type of 'FOR loop'
may be used, although its use is deprecated. For completeness it is
described here.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>FOR </B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">n
</SPAN></FONT><FONT FACE="Courier, monospace"><B>(</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">&lt;Perl
type list&gt;</SPAN></FONT><FONT FACE="Courier, monospace"><B>) {<BR>	</B></FONT><FONT FACE="Courier, monospace"><I><B>iC
statement(s), which are repeated under control of the loop<BR>	or
nested 'FOR loops'</B></I></FONT><FONT FACE="Courier, monospace"><B><BR>}</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">Similar restrictions to
those above apply. The variable after the 'FOR' is the loop control
variable. It may optionally be preceded by the word 'int'. The
control variable is given each value of the 'Perl list' for each
iteration of the loop. Some powerful manipulations are possible with
this form.</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>FOR
int </B>n <B>(</B>0 .. 3<B>)</B> <B>{</B><BR>	a[n],<B>\</B><BR><B>}</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">produces 
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><FONT FACE="Courier, monospace">	</FONT>a0,
a1, a2, a3,<FONT FACE="Courier, monospace"><BR></FONT></FONT><BR><BR>
</P>
<P CLASS="western" STYLE="font-style: normal">whereas the following
loop</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">call(</SPAN><B>\<BR>FOR
</B>n <B>(</B><SPAN STYLE="font-weight: normal">&quot;abc&quot;,
&quot;def&quot;, &quot;ghi&quot;, &quot;jkl&quot;</SPAN><B>)</B> <B>{
</B><SPAN STYLE="font-weight: normal">// list of strings</SPAN><BR>	[n],<B>\</B><BR><B>}\<BR>
</B><SPAN STYLE="font-weight: normal">);</SPAN></FONT></P>
<P CLASS="western" STYLE="font-style: normal">produces 
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-weight: normal">call(
abc</SPAN>, <SPAN STYLE="font-weight: normal">def</SPAN>, <SPAN STYLE="font-weight: normal">ghi</SPAN>,
<SPAN STYLE="font-weight: normal">jkl</SPAN>, );</FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">As shown in the two
examples above, lines terminated by a back-slash (\) are output
without starting a new line &ndash; this make it possible to generate
lists in a single line. This applies both outside and inside 'FOR
loops'. The end of the 'FOR loop' will terminate such a generated
list, unless the final brace of the 'FOR loop' is also followed by a
back-slash (\) as shown in the generated function block call
statement in the last example above. The last parameter in that
generated call statement is followed by a comma, which is allowed in
<I>iC</I> for parameter lists. 
</P>
<P CLASS="western" STYLE="font-style: normal">Comma separated lists
in normal and extern declarations must be terminated by a semi colon.
They may not have a comma followed by a semi colon '<B>,</B><FONT FACE="Courier, monospace"><FONT SIZE=2><B>;</B></FONT></FONT>'
at the end. To achieve this, a special characteristic of <I>iCa</I>
index expressions is used (see next paragraph). The value in square
brackets may be strings as well as numbers, since they are actually
generated by Perl code. To generate a variable length  &ndash; single
line &ndash; declaration, use the following:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>%define </B><SPAN STYLE="font-weight: normal">MAX	
5	// iCa macro explained in </SPAN><A HREF="#3.4.  immac Macro facility|outline"><SPAN STYLE="font-weight: normal">section
3.4</SPAN></A></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>imm
bit\<BR>FOR (</B><SPAN STYLE="font-weight: normal">n = 0; n &lt;=
MAX; n++</SPAN><B>)</B> <B>{</B><BR>	a[n] [n &lt; MAX ? <SPAN STYLE="font-weight: normal">&quot;,&quot;
: &quot;;&quot;</SPAN>]<B>\</B><BR><B>}</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">produces 
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm bit </B><SPAN STYLE="font-weight: normal">a0,
a1, a2, a3, a4, a5</SPAN>;</FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">Each execution of the
second conditional index expression <FONT FACE="Courier, monospace">[n
&lt; MAX ? &quot;,&quot; : &quot;;&quot;]</FONT> in the loop for <FONT FACE="Courier, monospace">n
&lt; 5 </FONT>produces a single comma, which is appended &ndash; the
last execution of the index expression produces a semi colon. For
this to work, the first string must contain a comma &ndash; the
second string can be any value &ndash; even the empty string <FONT FACE="Courier, monospace">&quot;&quot;</FONT>.</P>
<P CLASS="western" STYLE="font-style: normal">The 'FOR statement'
line of both types of 'FOR loop' and the lines containing the
associated braces are not copied to the target except as comment
lines, if the <B>-a</B> option is active for the <B>immac</B>
compiler.</P>
<H3 CLASS="western"><A NAME="3.3.2.  Index expressions|outline"></A>3.3.2
 Index expressions</H3>
<P CLASS="western">Index expressions are expressions in square
brackets usually involving integer constants and loop control
variables. Unlike in other languages these 'index' expressions can be
placed anywhere in the <I>iC</I> code &ndash; not just as an index of
an array variable. <I>immediate</I> array variables cannot even be
declared directly &ndash; they come into existence as simple
immediate variables by evaluating the index expression and replacing
the square brackets by the numeric or string result of that
evaluation. The underlying simple <I>immediate</I> variables must of
course be declared (unless <FONT FACE="Courier, monospace">not
strict</FONT>) &ndash; this is best done as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>FOR (</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">n
= 0; n &lt; 10; n++</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
{<BR>	imm bit </B></FONT><FONT FACE="Courier, monospace">a[n]</FONT><FONT FACE="Courier, monospace"><B>;<BR>}</B></FONT></FONT></P>
<P CLASS="western">Normally the square brackets are placed after a
name, which then makes the array variables look like those in C. But
there are special cases where the square bracketed index expression
is placed somewhere else, as we saw in the earlier examples
(computing IEC-1131 I/O variable names).</P>
<P CLASS="western">The semantics of index expressions is, that the
expression in square brackets is evaluated during compilation and the
numerical or string result replaces the square brackets and the
expression they enclose. When the index expression is a simple array
reference, this produces a name followed by a number.</P>
<P CLASS="western">Normally index expressions occur in <I>iC</I> code
in a 'FOR loop'. I deliberately say <I>iC</I> code and not <I>iC</I>
statements, because 'FOR loops' are used not only to generate lists
of statements, but also lists of parameters &ndash; both for the
definition and the call of function blocks, whose parameter lists can
be varied at compile time. Another use is varying constant
parameters. Inside a 'FOR loop' or a nest of 'FOR loops', the <I>iC</I>
code usually use the 'FOR loop' control variable(s) in the index
expression(s) to make each repeated <I>iC</I> code line different.</P>
<P CLASS="western">For index expressions in <I>immediate C</I> code
outside of a 'FOR loop', the expression must be a constant expression
&ndash; no variables are allowed (remember no 'FOR loop' control
variables are in scope anyway). Nevertheless an <I>iC</I> variable,
which must be used as an indexed array variable inside a 'FOR loop'
looks better if it follows the same syntax outside of the loop. The
variable <FONT FACE="Courier, monospace"><B>a[1]</B></FONT> could of
course be written as <FONT FACE="Courier, monospace"><B>a1</B></FONT>
&ndash; this is the same immediate variable. But inside a loop it
must be written as <FONT FACE="Courier, monospace"><B>a[n]</B></FONT>
and only the varying value of <FONT FACE="Courier, monospace"><B>n</B></FONT>
will produce <FONT FACE="Courier, monospace"><B>a0</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>a1</B></FONT> etc. 
</P>
<P CLASS="western">Index expressions in embedded C code &ndash;
either in a literal block or in a compound C statement contolled by
an <I>immediate</I> <FONT FACE="Courier, monospace"><B>if else</B></FONT>
or <FONT FACE="Courier, monospace"><B>switch</B></FONT> statement may
have index expressions, but they are part of the C code and are not
changed except index expressions, which contain an in-scope FOR loop
control variable. This means that the translation of constant index
expressions &ndash; as described in the previous paragraph - are not
carried out in embedded C code. In the rare instances where such a
translation is needed, it must be done manually &ndash; write  <FONT FACE="Courier, monospace"><B>a1</B></FONT>
instead of <FONT FACE="Courier, monospace"><B>a[1]</B></FONT>. 
</P>
<P CLASS="western">A special case in embedded C code occurs, if a
numerical value generated by the control variable of a FOR loop must
be placed inside the square brackets of a C array reference. This can
be done by simply embedding the iCa index expression in the C index
expression &ndash; eg:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>if
(</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">IX0.0</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
{<BR>	int </B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">carray[3];		//
start of embedded C code</SPAN></FONT><FONT FACE="Courier, monospace"><B><BR>	FOR
(</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">n
= 0; n &lt; 3; n++</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
{<BR>		</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">carray[</SPAN></FONT><FONT FACE="Courier, monospace"><B>[</B></FONT><FONT FACE="Courier, monospace">n</FONT><FONT FACE="Courier, monospace"><B>]</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">]</SPAN></FONT><FONT FACE="Courier, monospace">
= icarray</FONT><FONT FACE="Courier, monospace"><B>[</B></FONT><FONT FACE="Courier, monospace">n</FONT><FONT FACE="Courier, monospace"><B>]</B></FONT><FONT FACE="Courier, monospace"><B>;<BR>	}<BR>}</B></FONT></FONT></P>
<P CLASS="western">produces</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>if (</B><SPAN STYLE="font-weight: normal">IX0.0</SPAN><B>)
{<BR>	int </B><SPAN STYLE="font-weight: normal">carray[3];		// start
of embedded C code</SPAN><B><BR>	</B>carray[0] = icarray0;<BR>	carray[1]
= icarray1;<BR>	carray[2] = icarray2;<BR><B>}</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">As can be seen in the
above example, <I>iCa</I> 'For loops' may be embedded in C code &ndash;
this is the reason why the keyword '<B>FOR</B><SPAN STYLE="font-weight: normal">'</SPAN>
was chosen instead of '<B>for</B><SPAN STYLE="font-weight: normal">'</SPAN>
&ndash; the C code may also contain C for statements.</P>
<H3 CLASS="western"><A NAME="3.3.3.  immediate Array syntax|outline"></A>
3.3.3  immediate Array syntax</H3>
<P CLASS="western">To sum up, immediate arrays are not declared as
such &ndash; variable names are used with index expressions in square
brackets. The programmer must be aware that this generates simple
immediate variables starting with the array name followed by a
number. Such generated variable names cannot be used anywhere else &ndash;
this would show up as a multiple declaration during <I>iC</I>
compilation. If we use a one-dimensional array in an <I>iCa</I>
program &ndash; eg <FONT FACE="Courier, monospace"><B>sa</B></FONT>,
any array reference will simply have a number appended to the array
name in the generated <I>iC</I> code. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>i = 2, 
          s</B></FONT><FONT FACE="Courier, monospace"><B>a[i]   
produces sa2<BR>i = 22,           sa[i+1]  produces sa23</B></FONT></FONT></P>
<P CLASS="western">A special case are multi-dimensional arrays. If we
use the standard C syntax to write a multiple array reference, eg
<FONT FACE="Courier, monospace"><B>ma[i][j]</B></FONT>, and the <B>immac</B>
pre-processor did not take special action, we would get the following
compile resolution for the following pairs of index values:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>i = 2, 
j = 34    </B></FONT><FONT FACE="Courier, monospace"><B>ma[i][j]
would produce ma234 // NOT output<BR>i = 23, j = 4     ma[i][j] would
produce ma234 // NOT output</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">This would be
unsatisfactory, because it is ambiguous &ndash; therefore <B>immac</B>
inserts a letter <FONT FACE="Courier, monospace"><B>x</B></FONT>
between adjacent index expressions, producing the following output
instead:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>i = 2, 
j = 34    </B></FONT><FONT FACE="Courier, monospace"><B>ma[i][j]
produces ma2x34<BR>i = 23, j = 4     ma[i][j] produces ma23x4</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">This is no longer
ambiguous. Any multiple index is separated by an <FONT FACE="Courier, monospace"><B>x</B></FONT>,
which is easily recognised in the generated <I>iC</I> code as a
member of a multiple-dimensional array &ndash; even the numerical
index values can be recognised easily in the generated names. 
</P>
<P CLASS="western" STYLE="font-style: normal">Both in C and by
analogy in <I>immediate C</I> with arrays (<I>iCa</I>), array names
and the index expressions in square brackets (and of course the
expressions in the square brackets) may be separated by spaces and
tab's &ndash; as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>i = 2, 
j = 34    </B></FONT><FONT FACE="Courier, monospace"><B>ma   [ i ]  [
j ]   still produces ma2x34<BR>i = 23, j = 4     ma   [ i ]  [ j ]  
still produces ma23x4</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">One caveat applies for
<B>immac</B>: <I><SPAN STYLE="font-weight: normal">such an array name
with all its subsequent square bracketed index expressions must be in
the same line</SPAN></I>. (In C any sort of white space is allowed).</P>
<P CLASS="western" STYLE="font-style: normal">Another case where
<B>immac</B> inserts an extra character are array names which finish
with a numeral. This could also lead to ambiguity if special action
were not taken:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>i = 2, 
          s</B></FONT><FONT FACE="Courier, monospace"><B>a9  [ i ]   
      produces sa9y2<BR>i = 22,           sa9  [ i+1 ]       
produces sa9y23</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">Although the way <B>immac
</B>handles array names, which finish with a numeral avoids
ambiguity, such names should be avoided, because in the generated <I>iC</I>
code they look too much like expanded array names with an extra
index, which could easily lead to clashes. To avoid this clash a <FONT FACE="Courier, monospace"><B>y</B></FONT>
is inserted in this case.</P>
<P CLASS="western" STYLE="font-style: normal">String index
expressions in square brackets, which contain a string value in
parentheses, eg</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>[n &lt; MAX ? </B><SPAN STYLE="font-weight: normal">&quot;,&quot;
: &quot;;&quot;</SPAN><B>]</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">are not separated from
an adjacent index expression by <FONT FACE="Courier, monospace"><B>x</B></FONT>
or <FONT FACE="Courier, monospace"><B>y</B></FONT>.</P>
<P CLASS="western" STYLE="font-style: normal">In every case, the
names generated from single- and multi-dimensional array references
are well formed <I>iC</I> variables, which show their name and index
value(s). The main thing to remember with array references is, that
every array reference translates to a simple <I>iC</I> variable name,
which shows up in the generated <I>iC</I> code, which will normally
be a lot longer than the <I>iCa</I> code, but which must be used for
live debugging with <B>iClive</B>. The mental translation between
indexed array references and the resolved <I>iC</I> names is so
simple, that it should not cause any problems to the user.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="3.4.  immac Macro facility|outline"></A><A NAME="3.4.  immac Macro facility|outline"></A>
<FONT FACE="Sanserif PS">3.4  immac Macro facility</FONT></H2>
<P CLASS="western">The pre-compiler <B>immac</B> provides a light
weight macro facility very similar to that provided by the C
pre-processor <B>cpp</B>. Only simple word macros may be defined, but
not macro's with parameters. The keyword to introduce an <B>immac</B>
macro definition is <FONT FACE="Courier, monospace"><B>%define</B></FONT>
not <FONT FACE="Courier, monospace"><B>#define</B></FONT> &ndash;
that is reserved for <B>cpp</B>, which can also be used in
conjunction with the full <I>iC</I> compiler <B>immcc</B>.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>%define LENGTH	 4</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">The same macro term
<FONT FACE="Courier, monospace"><B>LENGTH</B></FONT> could also be
pre-defined in the command line with the <B>-P</B> option:</P>
<P CLASS="western" STYLE="margin-left: 2.05cm; font-style: normal"><FONT FACE="Courier, monospace"><B>immac
-P LENGTH=8 </B></FONT>
</P>
<P CLASS="western" STYLE="font-style: normal">Unlike <B>cpp</B>, the
definition in the command line has precedence over the definition
with a <FONT FACE="Courier, monospace"><B>%define</B></FONT> line in
the program. This allows <I>iCa</I> programs to define default values
for macro terms, which can be re-defined in the command line. Macro
definitions can be any sort of text, which may also include
previously defined macros. For replacement as index values, they
should of course reduce to numeric values.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>%define WIDTH	 (5+1)		/* C comment
*/<BR>%define AREA	 (LENGTH * WIDTH)	// C++ comment</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">As shown above <FONT FACE="Courier, monospace"><B>%define</B></FONT>
lines may be terminated with a C or C++ comment. As with 'FOR loop'
control lines, a C comment must finish on the <FONT FACE="Courier, monospace"><B>%define</B></FONT>
line. Also the <FONT FACE="Courier, monospace"><B>%define</B></FONT>
lines are not copied to the target except as comment lines, if the <B>-a</B>
option is active for the <B>immac</B> compiler.</P>
<P CLASS="western" STYLE="font-style: normal">Macro replacements may
be made in all parts of the <I>iCa</I> code. They are of course
particularly useful to parametrise the termination of a 'FOR loop'
and hence the number of blocks of <I>iC</I> code, which is generated
by the 'FOR loop'. 
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="4.    Built-in Functions|outline"></A>
<FONT SIZE=4>4    Built-in Functions</FONT></H1>
<P CLASS="western"><I>iC</I> has a number of built in functions,
which are so central to the operation of the system, that they have
been made a part of the language. They are implemented as efficient
building blocks in the supporting run time package. Functions, which
could not be created from simpler <I>iC</I> statements are generated
by the compiler &ndash; others are defined internally as built-in
Function Blocks. All except the LATCH and the FORCE functions are
'clocked', which is analogous to similar functionality in hardware
IC's.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.1.  Unclocked flip-flop or LATCH|outline"></A>
<FONT FACE="Sanserif PS">4.1  Unclocked flip-flop or LATCH</FONT></H2>
<P CLASS="western">The unclocked R-S flip-flop is the LATCH function
with the following calling sequence: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">LATCH(set,
reset) </FONT>
</P>
<P CLASS="western">The following truth table describes the LATCH
function: 
</P>
<DL>
	<DD>
	<TABLE WIDTH=300 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0 RULES=COLS>
		<COL WIDTH=48>
		<COL WIDTH=49>
		<COL WIDTH=170>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">set</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">reset</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">LATCH(set,reset)</FONT></P>
				</TD>
			</TR>
			<TR VALIGN=TOP>
				<TD WIDTH=48 HEIGHT=13 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<BR>
					</P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<BR>
					</P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					   <FONT FACE="Courier, monospace">Q  <A CLASS="sdfootnoteanc" NAME="sdfootnote2anc" HREF="#sdfootnote2sym"><SUP>2</SUP></A></FONT></P>
				</TD>
			</TR>
		</TBODY>
	</TABLE>
</DL>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">The LATCH function is particularly fast and
efficient, using only a single gate node. It is of course possible to
program a latch function with a pair of cross coupled OR gates. In <I>iC
</I>this looks as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> set, reset, Q, Qbar;<BR></FONT><FONT FACE="Courier, monospace">Q
   = set   | </FONT><FONT FACE="Courier, monospace"><B>~</B></FONT><FONT FACE="Courier, monospace">Qbar;<BR>Qbar
= reset | </FONT><FONT FACE="Courier, monospace"><B>~</B></FONT><FONT FACE="Courier, monospace">Q;
</FONT><FONT FACE="Courier, monospace"><A CLASS="sdfootnoteanc" NAME="sdfootnote3anc" HREF="#sdfootnote3sym"><SUP>3</SUP></A></FONT></FONT></P>
<P CLASS="western">The disadvantage of this implementation is the
fact that its function as a latch is hidden, that two gates are used
and that Q and Qbar are both <FONT FACE="Courier, monospace">1</FONT>,
when <FONT FACE="Courier, monospace">set</FONT> and <FONT FACE="Courier, monospace">reset</FONT>
are <FONT FACE="Courier, monospace">1 </FONT> (which means that Qbar
should never be used). LATCH clearly shows its function.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.2.  FORCE function|outline"></A>
<FONT FACE="Sanserif PS">4.2  FORCE function</FONT></H2>
<P CLASS="western">Closely related to the LATCH function is the FORCE
function with the following calling sequence and truth table:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">FORCE(arg1,
on, off) </FONT>
</P>
<DL>
	<DD>
	<TABLE WIDTH=362 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0>
		<COL WIDTH=44>
		<COL WIDTH=45>
		<COL WIDTH=45>
		<COL WIDTH=186>
		<TR VALIGN=TOP>
			<TD WIDTH=44 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">arg1</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">on</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">off</FONT></P>
			</TD>
			<TD WIDTH=186 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">FORCE(arg1,on,off)</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=44 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=186 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=44 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=186 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=44 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">X</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=186 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=44 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">X</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=186 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=44 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=186 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=44 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=45 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=186 BGCOLOR="#ffff99">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
	</TABLE>
</DL>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">The FORCE function passes the value of <FONT FACE="Courier, monospace">arg1</FONT>
to the output if both <FONT FACE="Courier, monospace">on</FONT> and
<FONT FACE="Courier, monospace">off</FONT> are <FONT FACE="Courier, monospace">0</FONT>
(or both are <FONT FACE="Courier, monospace">1</FONT>). If only <FONT FACE="Courier, monospace">on</FONT>
is <FONT FACE="Courier, monospace">1</FONT> then the output is forced
to <FONT FACE="Courier, monospace">1</FONT>, independent of the value
of <FONT FACE="Courier, monospace">arg1</FONT>. Conversely if only
<FONT FACE="Courier, monospace">off</FONT> is <FONT FACE="Courier, monospace">1</FONT>
then the output is forced to <FONT FACE="Courier, monospace">0</FONT>.
This function is useful for testing.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Note for deep thinkers:    the following expression generates a LATCH
function from a FORCE function. <FONT FACE="Sanserif PS"><FONT SIZE=2>This
is how a LATCH is generated by the </FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><I>iC</I></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>
compiler from the more fundamental FORCE function - using feedback of
its own output to hold that value at its input, unless the </FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>&lsquo;on&lsquo;</FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>
or </FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>&lsquo;off&lsquo;</FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>
inputs force the output to a different value.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">(temp001
= FORCE(temp001, set, reset))</FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.3.  Clocked D flip-flop|outline"></A>
<FONT FACE="Sanserif PS">4.3  Clocked D flip-flop</FONT></H2>
<P CLASS="western">The simplest clocked flip-flop is the D flip-flop
or delay memory element, a function having a single input, a clock
input and an output equal to the input in the previous clock period. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">D(expr,
c)   or   D(expr)	/* default <I>iClock</I> used as clock */ </FONT>
</P>
<P CLASS="western">The following truth table describes the D
flip-flop: 
</P>
<DL>
	<DD>
	<TABLE WIDTH=239 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0 RULES=COLS>
		<COL WIDTH=108>
		<COL WIDTH=109>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=108 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">expr</FONT></P>
				</TD>
				<TD WIDTH=109 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">D(expr,c)</FONT></P>
				</TD>
			</TR>
			<TR VALIGN=TOP>
				<TD WIDTH=108 HEIGHT=13 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">D<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=109 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n+1</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=108 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=109 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=108 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=109 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
	</TABLE>
</DL>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">The D flip-flop has become the most commonly used
clocked flip-flop in hardware design. Its application is called for,
when several logic expressions must produce synchronized outputs, so
that any further logic done with these outputs does not suffer from
timing races. A typical example is the implementation of a state
machine. The D flip-flop is also a 1 bit memory element, which can
store information from one clock period to the next. The D flip-flop
is called for in any design where feedback is involved. The use of
the clocked D flip-flop in <I>iC</I> will probably fall into a
similar pattern. 
</P>
<P CLASS="western">Examples of statements using D flip-flops is the
generation of a pulse on the rising edge of an input and of a pulse
on a change of input. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace">    input;<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit </B></FONT><FONT FACE="Courier, monospace">   rise   = input &amp;
</FONT><FONT FACE="Courier, monospace"><B>~</B></FONT><FONT FACE="Courier, monospace">D(input);<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace">    change = input ^ 
D(input); </FONT></FONT>
</P>
<P CLASS="western">The output 'rise' goes hi when 'input' goes hi and
goes lo again when the output of the inverted D flip-flop goes lo
after the next (implicit) clock pulse. The second example uses the
exclusive-or operator <FONT FACE="Courier, monospace"><B>^</B></FONT>
to generate a pulse on both the rising and falling edge of the input.
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.4.  Clocked SR flip-flop|outline"></A>
<FONT FACE="Sanserif PS">4.4  Clocked SR flip-flop</FONT></H2>
<P CLASS="western">The memory element that is represented in most PLC
instruction sets is the R-S flip-flop. This flip-flop has two inputs.
The rising edge of the set input puts the flip-flop in the &quot;one&quot;
state and the rising edge of the reset input puts the flip-flop in
the &quot;zero&quot; state. Many books on switching theory describe a
simple unclocked latch memory element by the name R-S flip-flop.
Following the usage in IEC-1131, and because the set parameter
precedes the reset parameter in the calling sequence, the clocked
Set-Reset flip-flop was named SR flip-flop in <I>iC</I>: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">SR(set,
reset, c) </FONT>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Sanserif PS"><FONT SIZE=2>The following truth table
describes the SR flip-flop: </FONT></FONT>
</P>
<DL>
	<DD>
	<TABLE WIDTH=300 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0 RULES=COLS>
		<COL WIDTH=48>
		<COL WIDTH=49>
		<COL WIDTH=170>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">set</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">reset</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">SR(set,reset,c)</FONT></P>
				</TD>
			</TR>
			<TR VALIGN=TOP>
				<TD WIDTH=48 HEIGHT=13 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">S<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">R<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n+1</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0/1</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">X</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">X</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0/1</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
	</TABLE>
</DL>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">The SR flip-flop implemented in <I>iC</I> differs
marginally from the classical R-S flip-flop described in the
literature, which has the disadvantage that Qn+1 is undefined for S
and R both &quot;one&quot;. The design rules stated that S and R must
never be &quot;one&quot; together. Since this would cause unwarranted
confusion the implementation with the above truth table was chosen,
which gives identical results with designs following the rules of the
classical R-S flip-flop. If the rule of both inputs &quot;one&quot;
is ignored, the results are still easy to interpret. For the above
reasons clocked R-S flip-flops are rare as integrated circuits.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.5.  Clocked SRX flip-flop|outline"></A>
<FONT FACE="Sanserif PS">4.5  Clocked SRX flip-flop</FONT></H2>
<P CLASS="western" STYLE="font-style: normal">In practice the simple
clocked SR flip-flop can be difficult to control under the following
conditions:</P>
<P CLASS="western" STYLE="font-style: normal">A <FONT FACE="Courier, monospace">0/1</FONT>
set transition has occurred which sets the flip-flop and some time
later a <FONT FACE="Courier, monospace">0/1</FONT> reset transition
occurs which resets it, while set is still a <FONT FACE="Courier, monospace">1</FONT>.
Even if reset goes back to <FONT FACE="Courier, monospace">0</FONT>,
the set input is not active again until it goes back to <FONT FACE="Courier, monospace">0</FONT>
and then to <FONT FACE="Courier, monospace">1</FONT> again. This
works well in many situations, but can be counter intuitive for which
reason the SRX flip-flop or the JK flip-flop can be used more
effectively.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace">SRX(set,
reset, c) </FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-style: normal">equivalent
to  </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>SR(set
&amp; ~reset, reset &amp; ~set, c)</FONT></FONT></FONT></P>
<P CLASS="western">The following truth table describes the SRX
flip-flop: 
</P>
<DL>
	<DD>
	<TABLE WIDTH=300 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0 RULES=COLS>
		<COL WIDTH=48>
		<COL WIDTH=49>
		<COL WIDTH=170>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">set</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">reset</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">SRX(set,reset,c)</FONT></P>
				</TD>
			</TR>
			<TR VALIGN=TOP>
				<TD WIDTH=48 HEIGHT=13 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">S<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">R<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n+1</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0/1</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0/1</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1\0</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1\0</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
	</TABLE>
</DL>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">When both set and reset are <FONT FACE="Courier, monospace">1</FONT>,
then both internal S and R inputs are <FONT FACE="Courier, monospace">0.</FONT>
If there is a <FONT FACE="Courier, monospace">1\0</FONT> transition
on either <FONT FACE="Courier, monospace">set</FONT> or <FONT FACE="Courier, monospace">reset</FONT>,
then the alternate input has a <FONT FACE="Courier, monospace">0/1</FONT>
transition, which sets or resets Q. 
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.6.  Clocked JK flip-flop|outline"></A>
<FONT FACE="Sanserif PS">4.6  Clocked JK flip-flop</FONT></H2>
<P CLASS="western"><SPAN STYLE="font-style: normal">Instead JK
flip-flops were made, which toggled their output on every clock
pulse, when J and K are both &quot;one&quot;. In recent years even
these have not been listed in the IC data books. A JK flip-flop has
been implemented in</SPAN><I> iC. </I>: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; margin-bottom: 0.21cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>JK(set, reset, c)
<SPAN STYLE="font-style: normal">equivalent to  </SPAN>SR(set &amp;
~Q, reset &amp; Q, c) </FONT></FONT>
</P>
<P CLASS="western">The following truth table describes the JK
flip-flop: 
</P>
<DL>
	<DD>
	<TABLE WIDTH=300 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0 RULES=COLS>
		<COL WIDTH=48>
		<COL WIDTH=49>
		<COL WIDTH=170>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">set</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">reset</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">JK(set,reset,c)</FONT></P>
				</TD>
			</TR>
			<TR VALIGN=TOP>
				<TD WIDTH=48 HEIGHT=13 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">J<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">K<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n+1</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=48 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=49 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=170 BGCOLOR="#ffff99">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">~Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
	</TABLE>
</DL>
<P CLASS="western"><BR><BR>
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.7.  D flip-flop with Set and Reset|outline"></A>
<FONT FACE="Sanserif PS">4.7  D flip-flop with Set and Reset</FONT></H2>
<P CLASS="western">D flip-flops may have an optional reset input.
Another option is to have both a set and reset input as well as the D
input. The names of these variants indicate which parameters are
required:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">DR(expr,
reset, c)<BR>DSR(expr, set, reset, c)</FONT></P>
<P CLASS="western">For all built in functions, each parameter may
have its own clock parameter. If a clock parameter is supplied it
applies to all parameters on its left, which do not have their own
clock. If no clock parameter is specified, the built in <FONT FACE="courier, monospace">iClock</FONT>
is used.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.8.  Mono-Flop with optional Reset|outline"></A>
<FONT FACE="Sanserif PS">4.8  Mono-Flop with optional Reset</FONT></H2>
<P CLASS="western">The Mono-Flop, or SRT() function is a modified SR
flip-flop, in which the output is internally connected back to a
reset input. This internal reset is usually clocked by a TIMER, which
is controlled by a delay parameter. The delay parameter may have a
fixed or variable numeric value. The SRT output is reset, when the
number of &quot;TIMER&quot; ticks corresponding to the value of
&quot;delay&quot;, when the SRT was set, has occurred. An additional
optional reset parameter can reset the SRT mono-flop prematurely.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">SRT(set,
timer, delay)<BR>SRT(set, reset, timer, delay)</FONT></P>
<P CLASS="western">Instead of clocking with a delay TIMER, any clock
may be used. The SRT mono-flop is then reset on the next clock pulse
after it has been set. When no clock is specified <FONT FACE="courier, monospace">iClock</FONT>
is used, which produces a thin pulse, one clock period wide.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="3.9.  Sample and Hold|outline"></A><A NAME="4.9.  Sample and Hold|outline"></A>
<FONT FACE="Sanserif PS">4.9  Sample and Hold</FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Sanserif PS"><FONT SIZE=2>This function is a direct
analogy of the clocked D flip-flop for arithmetic values. The
arithmetic output equals the arithmetic input in the previous clock
period. </FONT></FONT>
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">SH(arithmeticExpr,
c)</FONT></P>
<P CLASS="western">The sample and hold function can be used to sample
fast changing arithmetic inputs at a constant clock rate. Other uses
are the implementation of many useful constructs such as state
machines, counters and shift registers, to name a few.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
int</B></FONT><FONT FACE="Courier, monospace"> count = SH(count + 1,
c);	// count clock c pulses<BR>// shift register with b as input in
the least significant bit.<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> b;			// b assigned
somewhere else<BR></FONT><FONT FACE="Courier, monospace"><B>imm int</B></FONT><FONT FACE="Courier, monospace">
shift = SH((shift &lt;&lt; 1) + b, c);</FONT></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.10.  Sample and Hold with Set and Reset|outline"></A>
<FONT FACE="Sanserif PS">4.10  Sample and Hold with Set and Reset</FONT></H2>
<P CLASS="western">The Sample and Hold function also comes with
either reset or set and reset inputs. When the reset input is
clocked, the output is set to all 0's. By analogy when the set input
is clocked the output is set to all 1's. The inputs <FONT FACE="Courier, monospace">set</FONT>
and <FONT FACE="Courier, monospace">reset</FONT> are <FONT FACE="Courier, monospace"><B>imm
bit</B></FONT> expressions; whereas the main input <FONT FACE="Courier, monospace">arithmeticExpr
</FONT>and the output are <FONT FACE="Courier, monospace"><B>imm int</B></FONT>.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">SHR(arithmeticExpr,
reset, c)<BR>SHSR(arithmeticExpr, set, reset, c)</FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.11.  Edge detectors|outline"></A>
<FONT FACE="Sanserif PS">4.11  Edge detectors</FONT></H2>
<P CLASS="western">It is often useful to generate a pulse on the
rising edge of a logic signal or on a change of value. These pulses
should turn off at the next clock. In connection with the D
flip-flop, expressions were shown which generate such pulses. Since
these operations are quite important, more efficient functions
RISE(expr,c), FALL(expr, c) and CHANGE(expr,c) are implemented in <I>iC</I>.
The following statements achieve the same results: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; font-weight: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>imm bit</B> input;<BR><B>imm bit</B>
rise   = <B>RISE</B>(input, c);	// pulse on rising edge<BR><B>imm bit</B>
fall   = <B>FALL</B>(input, c);	// pulse on falling edge <BR><B>imm
bit</B> change = <B>CHANGE</B>(input, c);	// pulse on both edges</FONT></P>
<P CLASS="western">The CHANGE function is also implemented for
arithmetic expressions (type <FONT FACE="Courier, monospace"><B>int</B></FONT>).
The output is nevertheless of type <FONT FACE="Courier, monospace"><B>bit</B></FONT>.
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
int</B></FONT><FONT FACE="Courier, monospace"> value;<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> arithmeticChange =
</FONT><FONT FACE="Courier, monospace"><B>CHANGE</B></FONT><FONT FACE="Courier, monospace">(value,
c); </FONT></FONT>
</P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>bit</B></FONT>
variable <FONT FACE="Courier, monospace">arithmeticChange</FONT>
pulses every time <FONT FACE="Courier, monospace">value</FONT>
changes, qualified by the clock <FONT FACE="Courier, monospace">c</FONT>.
The clock limits the rate at which changes are recognized. This is
often useful with numeric values, which may change at a high rate,
and a slower sampling rate is called for. 
</P>
<P CLASS="western">The pulse outputs of all edge detectors are just
long enough, so that they catch the next clock pulse after the edge,
but only that one clock pulse &ndash; not more. When the output of an
edge detector is used directly or indirectly as input of another
clocked function with the same clock, correct synchronization is
achieved.</P>
<P CLASS="western">NOTE: there is a significant difference between
the output of the RISE function and the output of the SRT mono-flop.
The output of the RISE function turns on with the rising input signal
and turns off again on the next clock. The output of the mono-flop
turns on with the next clock after the set signal and turns off with
the next clock after that, which is one clock pulse later, assuming
the same clock is used for set and internal reset. When the two
clocks are different, which is usual for SRT mono-flops, the case is
different again.</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<H1 CLASS="western"><A NAME="4.  Clock Signals|outline"></A><A NAME="5.  Clock Signals|outline"></A>
5  Clock Signals</H1>
<P CLASS="western">There are two types of Clock signal, '<FONT FACE="Courier, monospace"><B>clock</B></FONT>'
and '<FONT FACE="Courier, monospace"><B>timer</B></FONT>'. It is
important to realize that Clock signals are not of the same type as
logic or numeric signals of type '<FONT FACE="Courier, monospace"><B>bit</B></FONT>'
or '<FONT FACE="Courier, monospace"><B>int</B></FONT>'. Clock signals
are declared as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>imm
clock</B> myClock;<BR><B>imm timer</B> myTimer;</FONT></P>
<P CLASS="western">Under no circumstances may clocks be
interconnected with logic or numeric signals. Any attempt to do so
generates an error message. Clock signals in <I>iC</I> are best
thought of as timeless pulses, whose occurrence marks the separation
of one clock period from the next along the time axis. All clocked
functions in <I>iC</I> follow the <I>Master-Slave</I> principle. The
<I>Master</I> element in a D flip-flop follows the input. The output
of this <I>Master</I> gate is transferred to the <I>Slave</I> element
during the active phase of the next clock pulse. The output of the
<I>Slave</I> element is the output of the D flip-flop. All
<I>Master-Slave</I> transfers during one particular clock pulse are
completed before more combinatorial logic or arithmetic expressions
are executed. This insures that the outputs of all functions, which
are synchronized by the same clock, change simultaneously as far as
the logic is concerned.</P>
<P CLASS="western">Clock signals can come from four different
sources:</P>
<OL>
	<LI><P CLASS="western">The built-in <FONT FACE="Courier, monospace"><B>iClock</B></FONT>,
	which is signal type	<FONT FACE="Courier, monospace"><B>imm clock</B></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">The
	CLOCK function, which generates type	<FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm
	clock </B></FONT></FONT>
	</P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">The
	TIMER function, which generates type	<FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm
	timer </B></FONT></FONT>
	</P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">The
	TIMER1 function, which also generates type	<FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm
	timer </B></FONT></FONT>
	</P>
</OL>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="4.1.  Built-in immediate clock|outline"></A><A NAME="5.1.  Built-in immediate clock|outline"></A>
<FONT FACE="Sanserif PS">5.1  Built-in <I>immediate</I> clock</FONT></H2>
<P CLASS="western">There is a built-in <I>immediate</I> clock with
the name <FONT FACE="Courier, monospace"><B>iClock</B></FONT>. This
clock runs at the highest system rate. <FONT FACE="Courier, monospace"><B>iClock</B></FONT>
is used as the default clock, when no other clock is specified. It
may also be specified by the name  <FONT FACE="Courier, monospace"><B>iClock</B></FONT>
when no default clock is allowed by the syntax of a function call.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">x
= SR(a, b);	// Set and Reset clocked by built-in <B>iClock</B></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; margin-bottom: 0.21cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace">y = SR(a,
</FONT><FONT FACE="Courier, monospace"><B>iClock</B></FONT><FONT FACE="Courier, monospace">,
b, myClock);	// clock for the Set argument<BR>				// must be named if
different<BR>				</FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>//
from the Reset clock</FONT></FONT></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2; page-break-before: always"><A NAME="5.2.  CLOCK function|outline"></A>
<FONT FACE="Sanserif PS">5.2  CLOCK function</FONT></H2>
<P CLASS="western">The second source of clock signals is the CLOCK
function, which has one or two logic inputs and an optional clock
input. The CLOCK function produces an output <FONT FACE="Courier, monospace"><FONT SIZE=2><B>clock</B></FONT></FONT>
pulse during the active phase of the input clock, which follows a 0
to 1 transition of one of the logic inputs. If no clock input is
specified, <FONT FACE="Courier, monospace"><B>iClock</B></FONT> is
used. All CLOCK outputs are synchronous with their input clock. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
clock clk = <B>CLOCK</B>(b);	// &lsquo;clk&lsquo; on the rising edge
of b<BR>			// clocked by next &lsquo;iClock&rsquo;(default)<BR>imm
bit   y   = <B>D</B>(a, clk);	// D flip-flop clocked by &lsquo;clk&rsquo;
<BR>imm clock cl2 = <B>CLOCK</B>(b,<B>~</B>b);	// clock on rising and
falling edge 			// of b, clocked by &lsquo;iClock&rsquo;</FONT></P>
<P CLASS="western"><IMG SRC="iC_html_m47cd45c9.gif" ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="5.3.TIMER function|outline"></A>
<FONT FACE="Sanserif PS">5.3TIMER function</FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">The
third source of clock signals is the TIMER function, which also has
one or two logic inputs and an optional clock input. The output
generated by the TIMER function are of signal type <FONT FACE="Courier, monospace"><B>imm
timer</B></FONT> and are generated in precisely the same way and at
the same time as <FONT FACE="Courier, monospace"><FONT SIZE=2><B>clock</B></FONT></FONT>
pulses from a CLOCK function with the same inputs. <FONT FACE="Courier, monospace"><B>timer</B></FONT>
pulses differ from <FONT FACE="Courier, monospace"><FONT SIZE=2><B>clock</B></FONT></FONT>
pulses in the way they are used. Input parameters of type <FONT FACE="Courier, monospace"><B>timer</B></FONT>
are followed by an optional delay parameter, which may be a constant
value or an arithmetic expression (if missing a value of 1 is used).
The current value of the delay expression is read on the rising edge
of the associated logic input, and the result <FONT FACE="Courier, monospace"><FONT SIZE=2>n</FONT></FONT>
is used to count <FONT FACE="Courier, monospace"><B>timer</B></FONT>
pulses. The output is clocked by the <FONT FACE="Courier, monospace"><FONT SIZE=2>n</FONT></FONT>'th
<FONT FACE="Courier, monospace"><B>timer</B></FONT> pulse after the
rising input. If the delay value <FONT FACE="Courier, monospace"><FONT SIZE=2>n</FONT></FONT>
is 0 - or on the falling edge of the logic input - the output is
clocked immediately by <FONT FACE="Courier, monospace"><B>iClock</B></FONT>.
For a CLOCK generated <FONT FACE="Courier, monospace"><B>clock</B></FONT>,
the output is clocked by the first <FONT FACE="Courier, monospace"><B>clock</B></FONT>
pulse after the rising or falling input. A D flip-flop clocked with a
<FONT FACE="Courier, monospace"><B>timer </B></FONT>produces a
function with turn on delay. If the logic input to such a delay
element turns off before the delay time is up, the output never turns
on. This is a very useful function to implement time-outs, which are
notoriously difficult to implement by conventional means. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
timer tim = <B>TIMER</B>(b);	// &lsquo;tim&lsquo; on the rising edge
of b<BR>			// clocked by next &lsquo;iClock&rsquo;(default)<BR>imm
bit   z   = <B>D</B><SPAN STYLE="font-weight: normal">(</SPAN>a, tim,
3<SPAN STYLE="font-weight: normal">)</SPAN>;// D flip-flop clocked by
&lsquo;tim&lsquo;,<BR>		// turn on delayed by 3 &lsquo;tim&lsquo;
pulses,<BR>		// immediate turn off clocked by &lsquo;iClock&lsquo; </FONT>
</P>
<P CLASS="western"><IMG SRC="iC_html_6c562ce3.gif" ALIGN=LEFT><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2; page-break-before: always"><A NAME="5.4.  TIMER1 function|outline"></A>
<FONT FACE="Sanserif PS">5.4  TIMER1 function</FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">The
fourth source of clock signals is the TIMER1 function, which is very
similar to the normal TIMER function. The signal type generated is
<FONT FACE="Courier, monospace"><B>imm timer</B></FONT> &ndash; the
same as the type generated by a normal TIMER. The only difference is
the way in which a 0 delay and the falling logic input is handled,
when a <FONT FACE="Courier, monospace"><B>timer</B></FONT>, generated
by the TIMER1 function controls a clocked function. A 0 delay is
handled like a delay of 1 &ndash; turn on is at the next <FONT FACE="Courier, monospace"><B>timer</B></FONT>
pulse. On the falling edge of the logic input the output is clocked
on the next <FONT FACE="Courier, monospace"><B>timer</B></FONT>
pulse, rather than by the next <FONT FACE="Courier, monospace"><B>iClock</B></FONT>,
which is the case for TIMER generated <FONT FACE="Courier, monospace"><B>timer</B></FONT>
signals. A TIMER1 generated <FONT FACE="Courier, monospace"><B>timer</B></FONT>,
used with a delay of 1 (or 0), functions identically to a CLOCK
generated <FONT FACE="Courier, monospace"><B>clock</B></FONT> signal,
except there is a small, but significant amount of overhead in
handling <FONT FACE="Courier, monospace"><B>timer</B></FONT> signals.
For this reason CLOCK functions are to be preferred &ndash; their use
is very fast. The following diagram shows the different turn-off
handling for a TIMER1 generated <FONT FACE="Courier, monospace"><B>timer</B></FONT>
(in the shaded area):</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
timer ti1 = <B>TIMER1</B>(b);	// &lsquo;ti1&lsquo; on the rising edge
of b<BR>			// clocked by next &lsquo;iClock&rsquo;(default)<BR>imm
bit   z1  = <B>D</B>(a, ti1, 3);// D flip-flop clocked by &lsquo;ti1&lsquo;,<BR>		//
turn on delayed by 3 &lsquo;ti1&lsquo; pulses,<BR>		// turn off
clocked by next &lsquo;ti1&lsquo; <BR></FONT><BR><BR>
</P>
<IMG SRC="iC_html_6220c505.gif" ALIGN=LEFT>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2>CLOCK,
TIMER and TIMER1 functions have optional clock inputs, which may come
from other CLOCK or TIMER functions. The cascading of these functions
allows the realization of many useful applications. </FONT></FONT>
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="6.  Inputs and Outputs|outline"></A>
6  Inputs and Outputs</H1>
<H2 CLASS="western"><A NAME="6.1.  Built-in Inputs|outline"></A>6.1 
Built-in Inputs</H2>
<P CLASS="western">There are a number of inputs, which have such
universal significance, that they are implemented in the run time
system.</P>
<H3 CLASS="western"><A NAME="6.1.1.  iClock|outline"></A>6.1.1 
iClock</H3>
<P CLASS="western">There is a built-in <I>immediate</I> clock with
the name <FONT FACE="Courier, monospace">iClock</FONT>. This clock
runs at the highest system rate. The name <FONT FACE="Courier, monospace">iClock</FONT>
is built-in and may be used as defined above in <A HREF="#4.1.  Built-in immediate clock|outline">5.1</A>.</P>
<P CLASS="western">Because secondary clocks either use <FONT FACE="Courier, monospace">iClock</FONT>
by default, or another clock that is eventually clocked by <FONT FACE="Courier, monospace">iClock</FONT>,
all clocks (and timers) are synchronous with <FONT FACE="Courier, monospace">iClock</FONT>.
The execution of <I>immediate</I> logic is triggered by some input,
which causes evaluation of follow up statements, until no more
changes occur. <FONT FACE="Courier, monospace">iClock</FONT>
generates a clock pulse after every such burst of activity in the
logic. <FONT FACE="Courier, monospace">iClock</FONT> has the same
significance for <I>immediate</I> logic as the end of the program
cycle in a conventional PLC. The main difference is, that for a
conventional PLC all statements are executed for each program cycle.
For <I>immediate</I> logic only the changes triggered by one or at
most a few simultaneous inputs are executed for each program cycle.
This typically takes a few microseconds at most for a modern
processor. There are support tools which can measure and display this
time in microseconds.</P>
<H3 CLASS="western"><A NAME="6.1.2.  End of Initialization|outline"></A>
6.1.2  End of Initialization</H3>
<P CLASS="western">The rising edge of <FONT FACE="Courier, monospace">TX0.0</FONT>
is guaranteed to be the first input to the system and can be used for
initializing user constructs. It is high for the remainder of the
program (forever as far as applications are concerned)</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">TX0.0	EOI,
off during initialization, then always on</FONT></P>
<H3 CLASS="western"><A NAME="5.1.3.  Timing inputs|outline"></A><A NAME="6.1.3.  Timing inputs|outline"></A>
6.1.3  Timing inputs</H3>
<P CLASS="western">To allow programs to work with real time, the
following timing inputs have been provided: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">TX0.1	100
microseconds	// requires a 10 kHz Kernel<BR>TX0.2	1 millisecond	//
requires a 1 kHz Kernel<BR>TX0.3	10 milliseconds	// standard 100 Hz
Linux Kernel<BR>TX0.4	100 milliseconds	// for the remaining
timers<BR>TX0.5	1 second<BR>TX0.6	10 seconds<BR>TX0.7	60 seconds or 1
minute</FONT></P>
<P CLASS="western">These inputs can be used to generate clocks, which
are synchronous with real time. For example:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
clock clk100m = CLOCK(TX0.4);	// every 100 milliseconds</FONT></P>
<H2 CLASS="western"><A NAME="6.2.  External Inputs and Outputs|outline"></A>
6.2  External Inputs and Outputs</H2>
<P CLASS="western">Inputs and Outputs are named according to the
standard IEC-1131. Inputs start with the letter I, outputs with the
letter Q. These are followed by a second letter which defines the
type of the input or output. X defines a bit I/O, B a byte I/O, W a
16 bit word I/O and L a 32 bit long word I/O variable. The 2 capital
letters are followed by a number, which defines the address index of
the variable in the I/O field. <FONT COLOR="#000000"><FONT FACE="Sanserif PS"><FONT SIZE=2>For
bit I/O variables a full stop and a number in the range 0 to 7,
marking the bit address of the variable in the addressed I/O byte,
follow this. </FONT></FONT></FONT>The maximum address index that can
be used depends on the implementation of the driver and the
underlying hardware. Addresses in the I/O field may be used for bit,
byte, word or long word I/O. If all of these are in the same physical
address space, care must be taken not to overlap different types of
I/O. In this case 16 and 32 bit word I/O's the byte addresses used
must be on a 16 bit word or a 32 bit long word boundary respectively.
The <I>iC</I> compiler can generate warnings if I/O fields overlap.
In the default case, each size variable is assumed to be in its own
address space and the address of each variable is simply in index
into each address space.</P>
<H3 CLASS="western" STYLE="page-break-before: always"><A NAME="6.2.1.  Digital inputs|outline"></A>
6.2.1  Digital inputs</H3>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IX0.0	bit
0 of input byte 0 - pre-declared as imm bit<BR>IX0.1	bit 1 of input
byte 0<BR>IX0.2	bit 2 of input byte 0<BR>IX0.3	bit 3 of input byte
0<BR>IX0.4	bit 4 of input byte 0<BR>IX0.5	bit 5 of input byte
0<BR>IX0.6	bit 6 of input byte 0<BR>IX0.7	bit 7 of input byte 0</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IX1.0	bit
0 of input byte 1<BR>IX1.1	bit 1 of input byte 1<BR>IX1.2	bit 2 of
input byte 1<BR>IX1.3	bit 3 of input byte 1<BR>IX1.4	bit 4 of input
byte 1<BR>IX1.5	bit 5 of input byte 1<BR>IX1.6	bit 6 of input byte
1<BR>IX1.7	bit 7 of input byte 1<BR>...</FONT></P>
<H3 CLASS="western"><A NAME="6.2.2.  Digital outputs|outline"></A>6.2.2
 Digital outputs</H3>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QX0.0	bit
0 of output byte 0 - pre-declared as imm bit<BR>QX0.1	bit 1 of output
byte 0<BR>QX0.2	bit 2 of output byte 0<BR>QX0.3	bit 3 of output byte
0<BR>QX0.4	bit 4 of output byte 0<BR>QX0.5	bit 5 of output byte
0<BR>QX0.6	bit 6 of output byte 0<BR>QX0.7	bit 7 of output byte 0</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QX1.0	bit
0 of output byte 1<BR>QX1.1	bit 1 of output byte 1<BR>QX1.2	bit 2 of
output byte 1<BR>QX1.3	bit 3 of output byte 1<BR>QX1.4	bit 4 of
output byte 1<BR>QX1.5	bit 5 of output byte 1<BR>QX1.6	bit 6 of
output byte 1<BR>QX1.7	bit 7 of output byte 1<BR>...</FONT></P>
<H3 CLASS="western"><A NAME="6.2.3.  Analog inputs|outline"></A>6.2.3
 Analog inputs</H3>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IB2	input
byte 2 - pre-declared as imm int (8 bit input)<BR>IB3	input byte
3<BR>IB4	input byte 4<BR>IB5	input byte 5</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IW6	input
word 6			(16 bit input)<BR>IW8	input word 8<BR>IW10	input word
10<BR>IW12	input word 12<BR>IW14	input word 14</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IL16	input
long 16			(32 bit input)<BR>IL20	input long 20<BR>IL24	input long
24<BR>IL28	input long 28<BR>...</FONT></P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<H3 CLASS="western"><A NAME="6.2.4.  Analog outputs|outline"></A>6.2.4
 Analog outputs</H3>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QB2	output
byte 2 - pre-declared as imm int (8 bit output)<BR>QB3	output byte
3<BR>QB4	output byte 4<BR>QB5	output byte 5</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QW6	output
word 6			(16 bit output)<BR>QW8	output word 8<BR>QW10	output word
10<BR>QW12	output word 12<BR>QW14	output word 14</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QL16	output
long 16			(32 bit output)<BR>QL20	output long 20<BR>QL24	output long
24<BR>QL28	output long 28<BR>...</FONT></P>
<P CLASS="western">The IEC-1131 names above define the physical
addresses of inputs and outputs in the I/O field. For more readable
applications it is  highly recommended, that alternate descriptive
names are defined for IEC-1131 inputs and outputs. This would
normally be done in a table of alias assignments at the start of an
<I>iC</I> program. One advantage of this scheme is, that if an input
or output is physically moved to another I/O pin, only 1 statement in
the source needs to be changed.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
bit	waterLo, motorOn, heaterOn;<BR>imm int	waterTemp, motorSpeed;</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">waterLo	=
IX1.3;		// these statements define aliases<BR>waterTemp	= IB2;		//
which produce no run-time overhead</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QX10.2	=
motorOn;	// here the IEC-1131 names are the<BR>QX10.3	= heaterOn;	//
aliases, which is appropriate<BR>QW8	= motorSpeed;	// for outputs</FONT></P>
<P CLASS="western">IEC-1131 I/O variable names are pre-declared as
immediate variables in <I>iC</I> program code, but they are not
defined in embedded C code. Only variables declared with an <FONT FACE="Courier, monospace"><B>imm
bit,</B></FONT> <FONT FACE="Courier, monospace"><B>imm int,</B></FONT>
<FONT FACE="Courier, monospace"><B>immC bit</B></FONT> or <FONT FACE="Courier, monospace"><B>immC
int</B></FONT> statement are defined in C code. If I/O variables must
be accessed in C code the declared names must be used. This is
another reason for defining descriptive aliases for I/O variables
early in the program design phase.</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="7.    User defined immediate Function Blocks|outline"></A>
<FONT SIZE=4>7    User defined <I>immediate</I> Function Blocks</FONT></H1>
<P CLASS="western"><A NAME="function Blocks"></A>User defined
<I>immediate</I> functions are commonly called function blocks in the
PLC world, because they act more like functional blocks or templates
rather than functions in the instruction flow sense, where a function
evaluates a sequence of instructions whenever it is called. An
<I>immediate</I> Function Block is a separate <I>immediate</I>
subsystem with <I>immediate</I> parameters which are its inputs and
outputs from other section of the <I>immediate</I> system, optional
internal <I>immediate</I> variables, which must be declared inside
the Function Block and an optional <I>immediate </I>return value,
which may be used like any other immediate value &ndash; in an
expression &ndash; assigned to an immediate variable or used as an
input parameter in a built in function or function block call. Only
standard IEC-1131 I/O variables may be used in a Function Block
without being declared, although they may only be used as inputs,
since any assignment to an I/O variable such as QX0.0 inside a
Function Block would lead to a multiple assignment, once the Function
Block is used more than once. Another way to look at an immediate
Function Block is like a higher level integrated circuit, which has
connections into the system and provides a certain complex function
with many internal components and connections.</P>
<H2 CLASS="western"><A NAME="7.1.  immediate Function Block Definition|outline"></A>
7.1  immediate Function Block Definition</H2>
<P CLASS="western">An <I>immediate</I> Function Block must be defined
before it is used. Since the definition of a Function Block does not
itself generate any C-Code on compilation it can be and usually is
defined with its code body in a header file, if multiple source files
are used for a project. For small projects with a single source file
Function Blocks can be defined at the start of the source file.</P>
<P CLASS="western"><I>immediate</I> Function Blocks definitions are
very similar to C-functions, although there are significant
differences in detail. The definition of an immediate Function Block
consists of a return value type, a Function Block name, a comma
separated parameter list in parentheses and a function body in curly
braces, e.g.</P>
<P CLASS="western" STYLE="margin-left: 1.98cm"><FONT FACE="Courier, monospace">imm
bit fall(bit f, clock c) { this = RISE(~f, c); }</FONT></P>
<P CLASS="western">The return value may be one of 5 types:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
void	// which means no value is returned<BR>imm bit<BR>imm int<BR>imm
clock<BR>imm timer</FONT></P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>imm</B></FONT>
modifier is mandatory for the return type &ndash; it identifies an
immediate Function Block Definition syntactically. The Function Block
name can be any valid name starting with a letter followed by any
number of alphanumeric characters or underscores. A leading
underscore is possible, but should be avoided. The name must be
distinct from all other immediate variable names in a project.</P>
<P CLASS="western">The individual formal parameters in the parameter
list must be of the following 4 types:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
bit	// or simply	bit<BR>imm int	// or simply	int<BR>imm clock	// or
simply	clock<BR>imm timer	// or simply	timer</FONT></P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>imm</B></FONT>
modifier is optional for parameters in the parameter list. The
variable declared is nevertheless immediate. Parameters may be either
input value parameters, in which case only their type is written in
the list or the parameter may be an immediate output to which a value
from the Function Block is to be assigned. In this case the type of
the parameter must be preceded by the keyword <FONT FACE="Courier, monospace"><B>assign</B></FONT>.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The body of a Function Block is one or more immediate statements
defining the functionality of the block encoded in curly braces.
Immediate variables internal to the function must be declared before
use in the Function Block. Parameter names and internal variable
names are in a separate name space for each function, which is also
separate form the global name space. If a Function Block is not <FONT FACE="Courier, monospace"><B>imm
void</B></FONT> the body must contain a <FONT FACE="Sanserif PS"><FONT SIZE=2><I>return</I></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>
</FONT></FONT>statement. The semantics of the  <FONT FACE="Sanserif PS"><FONT SIZE=2><I>return</I></FONT></FONT>
statement is the assignment to the variable to which the Function
Block is assigned, when it is called. This variable, which is
identified by the keyword <FONT FACE="Courier, monospace"><B>this</B></FONT>,
may be used in other expressions inside the Function Block. The
preferred way to write the <I>return</I> statements is:</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><B>this = some + immediate +
expression;	// preferred return syntax</B></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The <FONT FACE="Sanserif PS"><FONT SIZE=2>usual C-syntax may also be
used, but does not make the action as clear:</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><B>return some + immediate +
expression;	// deprecated earlier syntax</B></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The <I>return</I> statement need not be the last statement in the
Function Block definition &ndash; its position does not influence
when it is executed &ndash; that is controlled purely by changes in
the values of the variables making up the <I>return</I> statement &ndash;
something which holds for all <I>immediate</I> statements. This
situation is more clearly expressed by the assignment to <FONT FACE="Courier, monospace"><B>this</B></FONT>.
An <FONT FACE="Courier, monospace"><B>imm void</B></FONT><B> </B>Function
Block has no <FONT FACE="Courier, monospace"><B>this</B></FONT>
variable, may not contain a <FONT FACE="Sanserif PS"><FONT SIZE=2><I>return</I></FONT></FONT>
statement and may not be assigned when called. 
</P>
<P CLASS="western">Each <FONT FACE="Courier, monospace"><B>assign</B></FONT><B>
</B>parameter must be on the left side of an assignment statement in
the Function Block. The values of <FONT FACE="Courier, monospace"><B>assign</B></FONT>
parameters may be used inside the Function Block. Each variable
declared inside the Function Block must also be assigned in the
Function Block. Variables declared <FONT FACE="Courier, monospace"><B>extern</B></FONT>
outside or inside the Function Block may not be assigned to inside
the Function Block. As is the case with I-O variables (which are
implicitly extern) <FONT FACE="Courier, monospace"><B>extern</B></FONT>
variables may only be used as values inside the Function Block. They
may not be declared again as local inside the Function Block.
Variables declared <FONT FACE="Courier, monospace"><B>extern</B></FONT>
in a function may be declared after the definition of the Function
Block in the <I>iC</I> code following the definition, to declare that
the variable will be assigned in this module. A variable with the
same name as an extern variable may be declared locally in another
Function Block, but it is a different formal variable local to that
Function Block. 
</P>
<P CLASS="western">All <I>immediate</I> statement types &ndash;
assignments, <I><SPAN STYLE="font-weight: normal">if else</SPAN></I>,
<I><SPAN STYLE="font-weight: normal">switch</SPAN></I><SPAN STYLE="font-weight: normal">,</SPAN>
Built in Functions and other user defined Function Block calls may be
used in Function Block definitions. Function Blocks may be nested to
any depth as long as Function Blocks are used, which have been
previously defined. This implies that Function Blocks cannot be
called recursively, either directly or indirectly. Function Blocks
may be very simple one line definitions or complex systems with
hundreds of parameters. Several examples follow:</P>
<P CLASS="western">The SRX flip-flop is built into the compiler, but
defined in just this way during initialisation of the compiler. In
the latest version of the compiler, all but the most primitive built
ins, are defined as Function Blocks.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">/*
SRX flip-flop defined as a function block */</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
bit srx(imm bit set, imm clock scl,<BR>	  imm bit res, imm clock
rcl)<BR>{<BR>	this = SR(set &amp; ~res, scl, ~set &amp; res, rcl;<BR>}</FONT></P>
<P CLASS="western">The CountClk function adds '<FONT FACE="Courier, monospace">increment</FONT>'
to '<FONT FACE="Courier, monospace">this</FONT>' for every occurrence
of '<FONT FACE="Courier, monospace">clk</FONT>':</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
int CountClk(imm clock clk, imm int increment)<BR>{<BR>	this =
SH(this + increment, clk);<BR>}</FONT></P>
<P CLASS="western">The CountBit function adds '<FONT FACE="Courier, monospace">increment</FONT>'
to '<FONT FACE="Courier, monospace">this</FONT>' for every rising
edge of '<FONT FACE="Courier, monospace">step</FONT>':</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
int CountBit(imm bit step, imm int increment)<BR>{<BR>	this =
CountClk(CLOCK(step), increment); // nested call<BR>}</FONT></P>
<P CLASS="western">The SelectClk function selects either a 100 ms or
a 1 second clock with variable '<FONT FACE="Courier, monospace">second</FONT>':</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
clock SelectClk(imm bit second)<BR>{<BR>	this = CLOCK(TX0.4 &amp;
~second |	// 100 ms<BR>		   TX0.5 &amp;  second );	// 1 second<BR>}</FONT></P>
<P CLASS="western">The following function block ADConvert assigns the
conversion of <FONT FACE="Courier, monospace">int val</FONT> to 8
<FONT FACE="Courier, monospace">assign bit</FONT> variables <FONT FACE="Courier, monospace">b0</FONT>
to <FONT FACE="Courier, monospace">b7</FONT> passed as parameters
(<FONT FACE="Courier, monospace">imm</FONT> is implied for value and
assign parameters).</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">/*
Analog to digital conversion of a byte value */<BR>imm void
ADConvert(int val,		// input parameter<BR>		assign bit b0,	// output
parameters<BR>		assign bit b1,<BR>		assign bit b2,<BR>		assign bit
b3,<BR>		assign bit b4,<BR>		assign bit b5,<BR>		assign bit
b6,<BR>		assign bit b7,<BR>	)<BR>{<BR>	b0 = val &amp; (1 &lt;&lt;
0);	// assignments to outputs<BR>	b1 = val &amp; (1 &lt;&lt; 1);<BR>	b2
= val &amp; (1 &lt;&lt; 2);<BR>	b3 = val &amp; (1 &lt;&lt; 3);<BR>	b4
= val &amp; (1 &lt;&lt; 4);<BR>	b5 = val &amp; (1 &lt;&lt; 5);<BR>	b6
= val &amp; (1 &lt;&lt; 6);<BR>	b7 = val &amp; (1 &lt;&lt; 7);<BR>}</FONT></P>
<P CLASS="western">Note: the parameter list may have a trailing comma
before the closing parentheses. This is generally the case for comma
separated lists in <I>iC</I> and makes it easier to edit the lists
and copy parameters when written vertically, which is useful for
large parameter lists.</P>
<P CLASS="western">The <I>iC</I> compiler builds a template of the
Function Block, replacing each parameter and internally declared
variable by the name of the Function Block followed by a '@' and the
formal parameter or declared variable name. This strategy ensures a
private name space for each Function Block. When called, the template
is copied, with each formal parameter replaced by its real parameter
and internally declared variables replaced by the formal name with
the '@' replaced by an underscore '_' and followed by an underscore
and an instance number. The instance number scheme ensures that there
is no clash of compiler generated variable names (even for separately
compiled modules).</P>
<H2 CLASS="western"><A NAME="7.2.  immediate Function Block Call|outline"></A>
7.2  immediate Function Block Call</H2>
<P CLASS="western">An immediate Function Block is called in a similar
fashion to a C-function, again with some significant differences. In
practice immediate Function Blocks are not called. When the compiler
encounters a Function Block call, the pre-compiled Function Block,
which is like a template, is copied, with all parameters replacing
the formal parameters in the template. The resulting network of nodes
will then be used at run-time like the network of nodes produced from
all other immediate statements.</P>
<P CLASS="western">If an <FONT FACE="Courier, monospace"><B>imm void
</B></FONT>function is encountered it looks like a subroutine call:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">ADConvert(IB1,<BR>		QX0.0,
QX0.1, QX0.2, QX0.3,<BR>		QX0.4, QX0.5, QX0.6, QX0.7,<BR>	     );</FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
This statement will assign bits 0 to 7 of <FONT FACE="Courier, monospace">IB1</FONT>
to <FONT FACE="Courier, monospace">QX0.0</FONT> to <FONT FACE="Courier, monospace">QX0.7
</FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>whenever </FONT></FONT><FONT FACE="Courier, monospace">IB1
</FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>changes</FONT></FONT>.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
A Function Block with a return value <SPAN STYLE="font-weight: normal">must</SPAN>
either be assigned to a suitable variable or else it must be used as
a value of a suitable type in an expression or in a parameter list.
An <FONT FACE="Courier, monospace"><B>imm bit</B></FONT> Function
Block may be used as an <FONT FACE="Courier, monospace"><B>imm int</B></FONT>
value and vice versa &ndash; appropriate conversion takes place. <FONT FACE="Courier, monospace"><B>imm
clock</B></FONT> and <FONT FACE="Courier, monospace"><B>imm timer</B></FONT>
Function Blocks can either be assigned to correctly declared <FONT FACE="Courier, monospace"><B>clock</B></FONT>
or <FONT FACE="Courier, monospace"><B>timer</B></FONT> variables or
else used as a <FONT FACE="Courier, monospace"><FONT SIZE=2><B>clock</B></FONT></FONT>
or <FONT FACE="Courier, monospace"><FONT SIZE=2><B>timer</B></FONT></FONT>
value in a parameter list.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">/*
count every rise of IX1.0 */<BR>imm int count = CountBit(IX1.0, 1);</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">/*
selects 1 sec when IX1.7 is on else 100 ms */<BR>imm clock clk =
SelectClk(IX1.7);</FONT></P>
<P CLASS="western">Real parameters of type <FONT FACE="Courier, monospace"><B>imm
int</B></FONT> and <FONT FACE="Courier, monospace"><B>imm bit</B></FONT>
may be mismatched with their formal parameter types &ndash; value and
assign parameters in the call will be forced to their formal type.
<FONT FACE="Courier, monospace"><B>assign</B></FONT> parameters of
type <FONT FACE="Courier, monospace"><B>imm clock</B></FONT> and <FONT FACE="Courier, monospace"><B>imm
timer</B></FONT> must match &ndash; so must a value parameter of type
<FONT FACE="Courier, monospace"><B>imm timer</B></FONT>. The handling
if formal  <FONT FACE="Courier, monospace"><B>imm clock</B></FONT>
parameters is more complex, allowing the use of default clocks.</P>
<P CLASS="western">Positions for formal <FONT FACE="Courier, monospace"><B>imm
clock</B></FONT> parameters are handled as follows:</P>
<OL>
	<LI><P CLASS="western">the position may be filled by a real <FONT FACE="Courier, monospace"><B>imm
	clock</B></FONT> parameter.</P>
	<LI><P CLASS="western">the position may be filled by a real <FONT FACE="Courier, monospace"><B>imm
	timer</B></FONT> parameter followed by an optional <FONT FACE="Courier, monospace"><B>imm
	int</B></FONT> delay (if delay is left out it will be set to 1).</P>
	<LI><P CLASS="western">the position may be left out altogether, in
	which case the next clock or timer parameter on the right will be
	replicated for the position. If there is no real clock parameter
	following on the right, <FONT FACE="Courier, monospace"><B>iClock</B></FONT>
	will be used.</P>
</OL>
<P CLASS="western">Real <FONT FACE="Courier, monospace"><B>timer</B></FONT>
parameters for formal <FONT FACE="Courier, monospace"><B>timer</B></FONT>
parameters cannot be extended by a delay &ndash; the delay used is
determined in the Function Block with delay(s) associated with the
use of the formal <FONT FACE="Courier, monospace"><B>timer</B></FONT>
parameter in the code of the Function Block. 
</P>
<P CLASS="western">The following calls of the user defined srx()
Function Block (which is identical to the built in SRX) with two
formal clock parameters &ndash; one each for set and reset.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
clock c = CLOCK(IX1.1), clk = CLOCK(IX1.2);<BR>imm timer t =
TIMER(IX1.3);<BR>imm bit s, r;<BR>imm bit m1 = srx(s, clk, r, c);	//
uses individual clocks<BR>imm bit m2 = srx(s, t, 3, r, t, 5);	//
individual timer delays<BR>imm bit m3 = srx(s, r, clk);		// one clock
for s and r<BR>imm bit m4 = srx(s, r, t, 5);	// one timer for s and
r<BR>imm bit m5 = srx(s, clk, r);		// default iClock for r<BR>imm bit
m6 = srx(s, iClock, r, c);	// must specify iClock here<BR>imm bit m7
= srx(s, r);		// default iClock for both</FONT></P>
<P CLASS="western">The following example is a controller for a full
scale application which required all the space and speed resources of
a PLC in the mid 80's. This project for a parcel sorting system for
the Australian Railways prompted the author to look at alternate
event driven systems for machine control.</P>
<P CLASS="western">The program is meant to control 4 high speed belts
moving at 5 metres/second generating independent strobe pulses for
every 15 mm movement of the belt. That means a strobe pulse every 3
ms. Each belt is equipped with 32 destination gates spaced 12 strobe
pulse apart and open for 7 strobe pulses (in practice this must be 72
strobe pulses or more).</P>
<P CLASS="western">The implementation consists of several function
blocks:</P>
<P CLASS="western" STYLE="margin-left: 1.25cm"><B>feeder() </B>controls
the insertion of the destination code onto the initial feeder segment
of the belt.	<BR><B>segment() </B>controls one of the 32 identical
segments of the belt.	<BR><B>belt() </B>is a Function Block for one
belt, calling feeder() once and segment() 32 times.<BR>Finally belt()
is called 4 times &ndash; once for each belt.	<BR><B>tick() </B>is an
auxiliary Function Block generating strobe pulses for the
simulation.<BR>Note the way tick() is called in the strobe parameter
position of belt().</P>
<P CLASS="western">The compiled <I>iC</I> program consists of 1,944
Gate nodes, 8,642 links and 10 C functions consisting of 1 line of C
code each.</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; line-height: 0.32cm; page-break-before: always">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************<BR>
*<BR> *	Parcel sorter for long belts<BR> *	Author:	J.E. Wulff<BR>
*	Source: Test8/sorti.ic<BR> *<BR>
*******************************************************************/<BR>/********************************************************************<BR>
*<BR> *	Feeder segment<BR> *<BR>
*******************************************************************/<BR><BR>imm
bit feeder(			/* feeds code into feeder segment */<BR>	imm bit
transfer,	/* photo cell to transfer code */<BR> assign	imm int
carryOut,	/* shift bit (as int) for the following segment */<BR>	imm
int code,		/* destination code - 0 to 31 */<BR>	imm int length,		/*
sets the length of the segment */<BR>	imm int width,		/* width of
lock frame 6 + 6 for 0x7f */<BR>	imm clock c,		/* stepping clock for
the belt */<BR>    )<BR>{<BR>    extern imm bit reset;	/* general
re-initialisation */<BR>    imm bit pip   = RISE(transfer &amp; ~this
&amp; ~reset, c);<BR>    imm int shift = SHR((shift &lt;&lt; 1) +
(pip * (0x41 + (code &lt;&lt; 1))), c, reset);<BR>    imm int mask  =
0x41 &lt;&lt; width;<BR>    carryOut = (shift &gt;&gt; length) &amp;
0x00000001;<BR>    this = SRX(pip,		/* unlock after width steps */<BR>	
      (shift &amp; mask) == mask | reset,
c);<BR>}<BR>/********************************************************************<BR>
*<BR> *	Segment<BR> *<BR> *	Each segment controls one gate and may be
up to 32 steps long<BR> *<BR>
*******************************************************************/<BR><BR>imm
bit segment(		/* returns gate control output */<BR>	imm int
carryIn,		/* shift bit (as int) from the previous segment */<BR>
assign	imm int carryOut,	/* shift bit (as int) for the following
segment */<BR>	imm int code,		/* code identifying this segment
*/<BR>	imm int length,		/* segment length */<BR>	imm int width,		/*
width of the gate */<BR>	imm clock c,		/* stepping clock for the belt
*/<BR>    )<BR>{<BR>    extern imm bit reset;	/* general
re-initialisation */<BR>    imm int shift = SHR((shift &lt;&lt; 1) +
carryIn, c, reset);<BR>    imm int mask  = 0x41 &lt;&lt; width;<BR>  
 carryOut = (shift &gt;&gt; length) &amp; 0x00000001;<BR>    this =
SRX((shift &amp; 0x7f) == 0x41 + (code &lt;&lt; 1),<BR>	       (shift
&amp; mask) == mask | reset,
c);<BR>}<BR>/********************************************************************<BR>
*<BR> *	Belt<BR> *<BR> *	Each belt has 32 gates<BR> *<BR>
*******************************************************************/<BR><BR>imm
int belt(<BR>    	assign	imm bit lock,		/* lock indicator */<BR>   
	assign	imm bit gate00,<BR>    	assign	imm bit gate01,<BR>   
	assign	imm bit gate02,<BR>    	assign	imm bit gate03,<BR>   
	assign	imm bit gate04,<BR>    	assign	imm bit gate05,<BR>   
	assign	imm bit gate06,<BR>    	assign	imm bit gate07,<BR>   
	assign	imm bit gate08,<BR>    	assign	imm bit gate09,<BR>   
	assign	imm bit gate10,<BR>    	assign	imm bit gate11,<BR>   
	assign	imm bit gate12,<BR>    	assign	imm bit gate13,<BR>   
	assign	imm bit gate14,<BR>    	assign	imm bit gate15,<BR>   
	assign	imm bit gate16,<BR>    	assign	imm bit gate17,<BR>   
	assign	imm bit gate18,<BR>    	assign	imm bit gate19,<BR>   
	assign	imm bit gate20,<BR>    	assign	imm bit gate21,<BR>   
	assign	imm bit gate22,<BR>    	assign	imm bit gate23,<BR>   
	assign	imm bit gate24,<BR>    	assign	imm bit gate25,<BR>   
	assign	imm bit gate26,<BR>    	assign	imm bit gate27,<BR>   
	assign	imm bit gate28,<BR>    	assign	imm bit gate29,<BR>   
	assign	imm bit gate30,<BR>    	assign	imm bit gate31,<BR>		imm int
code,		/* gate code 0 to 31 for parcel destination */<BR>		imm bit
p_cell,		/* photo cell monitoring parcel onto belt */<BR>		imm bit
strobe,		/* strobe pulse from belt movement */<BR>    )<BR>{<BR>   
imm int carfd;			/* carry bits */<BR>    imm int car00, car01, car02,
car03, car04, car05, car06, car07;<BR>    imm int car08, car09,
car10, car11, car12, car13, car14, car15;<BR>    imm int car16,
car17, car18, car19, car20, car21, car22, car23;<BR>    imm int
car24, car25, car26, car27, car28, car29, car30, car31;<BR><BR>   
imm clock clk = CLOCK(strobe);<BR><BR>    lock   = feeder(p_cell,
carfd, code, 12, 11, clk);<BR>    gate00 = segment(carfd, car00,   
0, 12,  7, clk);<BR>    gate01 = segment(car00, car01,    1, 12,  7,
clk);<BR>    gate02 = segment(car01, car02,    2, 12,  7, clk);<BR>  
 gate03 = segment(car02, car03,    3, 12,  7, clk);<BR>    gate04 =
segment(car03, car04,    4, 12,  7, clk);<BR>    gate05 =
segment(car04, car05,    5, 12,  7, clk);<BR>    gate06 =
segment(car05, car06,    6, 12,  7, clk);<BR>    gate07 =
segment(car06, car07,    7, 12,  7, clk);<BR>    gate08 =
segment(car07, car08,    8, 12,  7, clk);<BR>    gate09 =
segment(car08, car09,    9, 12,  7, clk);<BR>    gate10 =
segment(car09, car10,   10, 12,  7, clk);<BR>    gate11 =
segment(car10, car11,   11, 12,  7, clk);<BR>    gate12 =
segment(car11, car12,   12, 12,  7, clk);<BR>    gate13 =
segment(car12, car13,   13, 12,  7, clk);<BR>    gate14 =
segment(car13, car14,   14, 12,  7, clk);<BR>    gate15 =
segment(car14, car15,   15, 12,  7, clk);<BR>    gate16 =
segment(car15, car16,   16, 12,  7, clk);<BR>    gate17 =
segment(car16, car17,   17, 12,  7, clk);<BR>    gate18 =
segment(car17, car18,   18, 12,  7, clk);<BR>    gate19 =
segment(car18, car19,   19, 12,  7, clk);<BR>    gate20 =
segment(car19, car20,   20, 12,  7, clk);<BR>    gate21 =
segment(car20, car21,   21, 12,  7, clk);<BR>    gate22 =
segment(car21, car22,   22, 12,  7, clk);<BR>    gate23 =
segment(car22, car23,   23, 12,  7, clk);<BR>    gate24 =
segment(car23, car24,   24, 12,  7, clk);<BR>    gate25 =
segment(car24, car25,   25, 12,  7, clk);<BR>    gate26 =
segment(car25, car26,   26, 12,  7, clk);<BR>    gate27 =
segment(car26, car27,   27, 12,  7, clk);<BR>    gate28 =
segment(car27, car28,   28, 12,  7, clk);<BR>    gate29 =
segment(car28, car29,   29, 12,  7, clk);<BR>    gate30 =
segment(car29, car30,   30, 12,  7, clk);<BR>    gate31 =
segment(car30, car31,   31, 12,  7, clk);<BR>    this = car31;			/*
allows concatenation of belts
*/<BR>}<BR>/********************************************************************<BR>
*<BR> *	Generate tick<BR> *	input fast1 or fast2 cause 50 ms ticks<BR>
*	else tick for every change of manual input<BR> *<BR>
*******************************************************************/<BR><BR>imm
bit tick(bit manual, bit fast1, bit fast2) {<BR>    imm bit fast =
fast1 | fast2;<BR>    this = CHANGE(manual &amp; ~fast | TX0.4 &amp;
fast);<BR>}<BR>/********************************************************************<BR>
*<BR> *	4 belts<BR> *<BR> *	Each belt has 32 gates<BR> *<BR>
*******************************************************************/<BR><BR>imm
bit reset = IX0.7;	/* general re-initialisation */<BR><BR>QX8.0 =
belt(<BR>    QX8.1,		/* lock indicator */<BR>    QX0.0, QX0.1, QX0.2,
QX0.3, QX0.4, QX0.5, QX0.6, QX0.7,<BR>    QX1.0, QX1.1, QX1.2, QX1.3,
QX1.4, QX1.5, QX1.6, QX1.7,<BR>    QX2.0, QX2.1, QX2.2, QX2.3, QX2.4,
QX2.5, QX2.6, QX2.7,<BR>    QX3.0, QX3.1, QX3.2, QX3.3, QX3.4, QX3.5,
QX3.6, QX3.7,<BR>    IB3,		/* gate code 0 to 31 for parcel
destination */<BR>    IX0.1,		/* photo cell monitoring parcel onto
belt */<BR>    tick(IX0.0, IX0.6, IX0.5), /* strobe pulse from belt
movement */<BR>);<BR></FONT></FONT><BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX8.2
= belt(<BR>    QX8.3,		/* lock indicator */<BR>    QX4.0, QX4.1,
QX4.2, QX4.3, QX4.4, QX4.5, QX4.6, QX4.7,<BR>    QX5.0, QX5.1, QX5.2,
QX5.3, QX5.4, QX5.5, QX5.6, QX5.7,<BR>    QX6.0, QX6.1, QX6.2, QX6.3,
QX6.4, QX6.5, QX6.6, QX6.7,<BR>    QX7.0, QX7.1, QX7.2, QX7.3, QX7.4,
QX7.5, QX7.6, QX7.7,<BR>    IB7,		/* gate code 0 to 31 for parcel
destination */<BR>    IX4.1,		/* photo cell monitoring parcel onto
belt */<BR>    tick(IX4.0, IX4.6, IX0.5), /* strobe pulse from belt
movement */<BR>);<BR></FONT></FONT><BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX8.4
= belt(<BR>    QX8.5,		/* lock indicator */<BR>    QX10.0, QX10.1,
QX10.2, QX10.3, QX10.4, QX10.5, QX10.6, QX10.7,<BR>    QX11.0,
QX11.1, QX11.2, QX11.3, QX11.4, QX11.5, QX11.6, QX11.7,<BR>   
QX12.0, QX12.1, QX12.2, QX12.3, QX12.4, QX12.5, QX12.6, QX12.7,<BR>  
 QX13.0, QX13.1, QX13.2, QX13.3, QX13.4, QX13.5, QX13.6, QX13.7,<BR> 
  IB13,		/* gate code 0 to 31 for parcel destination */<BR>   
IX10.1,		/* photo cell monitoring parcel onto belt */<BR>   
tick(IX10.0, IX10.6, IX0.5), /* strobe pulse from belt movement
*/<BR>);<BR></FONT></FONT><BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX8.6
= belt(<BR>    QX8.7,		/* lock indicator */<BR>    QX14.0, QX14.1,
QX14.2, QX14.3, QX14.4, QX14.5, QX14.6, QX14.7,<BR>    QX15.0,
QX15.1, QX15.2, QX15.3, QX15.4, QX15.5, QX15.6, QX15.7,<BR>   
QX16.0, QX16.1, QX16.2, QX16.3, QX16.4, QX16.5, QX16.6, QX16.7,<BR>  
 QX17.0, QX17.1, QX17.2, QX17.3, QX17.4, QX17.5, QX17.6, QX17.7,<BR> 
  IB17,		/* gate code 0 to 31 for parcel destination */<BR>   
IX14.1,		/* photo cell monitoring parcel onto belt */<BR>   
tick(IX14.0, IX14.6, IX0.5), /* strobe pulse from belt movement
*/<BR>);<BR></FONT></FONT><BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="line-height: 0.4cm">The
following are the 10 generated C code fragments. The macro <FONT FACE="Courier, monospace">iC_MV()
</FONT>accesses an indexed value on the generated link array. One can
see from this that even for <FONT FACE="Courier, monospace"><B>int</B></FONT>
nodes the execution time for one event is going to be no more than a
few microseconds.</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">000	(1)
	return iC_MV(1)?iC_MV(2):iC_MV(3);<BR>026	(3) 	return
(iC_MV(1)&lt;&lt;1)+(iC_MV(2)*(0x41+(iC_MV(3)&lt;&lt;1)));<BR>027	(4)
	return 0x41&lt;&lt;iC_MV(1);<BR>028	(5) 	return
(iC_MV(1)&gt;&gt;iC_MV(2))&amp;1;<BR>030	(6) 	return
(iC_MV(1)&amp;iC_MV(2))==iC_MV(2);<BR>051	(7) 	return
(iC_MV(1)&lt;&lt;1)+iC_MV(2);<BR>052	(8) 	return
0x41&lt;&lt;iC_MV(1);<BR>053	(9) 	return
(iC_MV(1)&gt;&gt;iC_MV(2))&amp;1;<BR>055	(10) 	return
(iC_MV(1)&amp;iC_MV(2))==iC_MV(2);<BR>055	(11) 	return
(iC_MV(1)&amp;0x7f)==0x41+(iC_MV(2)&lt;&lt;1);</FONT></FONT></P>
<H1 CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.42cm; border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding-top: 0.12cm; padding-bottom: 0cm; padding-left: 0cm; padding-right: 0cm; widows: 2; orphans: 2; page-break-before: always; page-break-after: avoid"><A NAME="DDE_LINK2211"></A><A NAME="8.  The iC run-time model|outline"></A>
<FONT FACE="Sanserif PS"><FONT SIZE=4><B>8  The <I>iC</I> run-time
model</B></FONT></FONT></H1>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2>The
<I>iC</I> compiler <I><B>immcc</B></I> parses the statements of an iC
source, e.g. <FONT FACE="Courier, monospace"><B>example.ic</B></FONT>
and produces a C file <FONT FACE="Courier, monospace"><B>example.c</B></FONT>
and optionally a listing file <FONT FACE="Courier, monospace"><B>example.lst</B></FONT>.
The C file is compiled by a C compiler to produce <FONT FACE="Courier, monospace"><B>example.o</B></FONT>
(<FONT FACE="Courier, monospace"><B>example.obj</B></FONT> under
Windows), which is linked with the <I>iC</I> runtime library <I><B>libict.a</B></I>
to produce an executable <FONT FACE="Courier, monospace"><B>example</B></FONT>
(<FONT FACE="Courier, monospace"><B>example.exe</B></FONT> under
Windows). </FONT></FONT>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>*********************</FONT>
SOURCE example.ic <FONT SIZE=2>*********************</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace">imm
bit a = IX0.0 &amp; ~IX0.1 | ~IX0.0 &amp; IX0.1;</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace">QX0.0
= a;</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>imm
bit b = IX0.2 ^ IX0.3;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>imm
bit d = ~IX0.2 &amp; ~IX0.3;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>imm
bit mem = LATCH(b, d);</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>QX0.1
= mem;</FONT> </FONT>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>*********************
LISTING example.lst *******************</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>001	<B>imm
bit a =  IX0.0 &amp; ~IX0.1 | ~IX0.0 &amp;  IX0.1;</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	a_1
      ---|  a</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	a_2
      ---|</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.0
    ---&amp;  a_1</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.1
  ~ ---&amp;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.0
  ~ ---&amp;  a_2</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.1
    ---&amp;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>002	<B>QX0.0
= a;</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	a
        ---|  QX0.0 X</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>003	<B>imm
bit b =  IX0.2 ^  IX0.3;</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.2
    ---^  b</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.3
    ---^</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><SPAN ID="Frame1" DIR="LTR" STYLE="float: left; width: 7.43cm; height: 5.16cm; border: 1px solid #000000; padding: 0.15cm; background: #ffffff">
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>*******
	NET TOPOLOGY    *******</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>IX0.0
	  &lt;    ~a_2&amp;    a_1&amp;</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>IX0.1
	  &lt;     a_2&amp;   ~a_1&amp;</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>IX0.2
	  &lt;     b^     ~d&amp;</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>IX0.3
	  &lt;     b^     ~d&amp;</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>QX0.0
	  |  X</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>QX0.1
	  |  X</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>a
	      |     QX0.0|</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>a_1
	    &amp;     a|</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>a_2
	    &amp;     a|</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>b
	      ^     mem%</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>d
	      &amp;    ~mem%  *</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>mem
	    %     mem%    QX0.1|</FONT></FONT></P>
</SPAN><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>004	<B>imm
bit d = ~IX0.2 &amp; ~IX0.3;</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.2
  ~ ---&amp;  d</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.3
  ~ ---&amp;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>005	<B>imm
bit mem = LATCH(b, d);</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	mem
      ---%  mem</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	b
        ---%</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	d
      ~ ---%         *</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>006	<B>QX0.1
= mem;</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	mem
      ---|  QX0.1 X</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><A NAME="DDE_LINK221"></A>
<BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><IMG SRC="iC_html_7f124381.gif" ALIGN=LEFT><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<UL>
	<P CLASS="western"><FONT SIZE=1 STYLE="font-size: 8pt">* an
	idiosyncrasy of the Latch function is, that the reset input is
	inverted (by the compiler)</FONT></P>
</UL>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><I>Fig. 1	Graph representation of the iC program
<B>example.ic</B></I></P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>//*********************
C OUTPUT CODE example.c ********************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>static Gate *	l_[];</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/*******************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
 <FONT FACE="Courier, monospace"><FONT SIZE=2>*	Gate list</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
 <FONT FACE="Courier, monospace"><FONT SIZE=2>*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate IX0_0    = { 1, 
INPX,  GATE, 0, &quot;IX0.0&quot;, 0, 0,       0      };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate IX0_1    = { 1, 
INPX,  GATE, 0, &quot;IX0.1&quot;, 0, 0,       &amp;IX0_0 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate IX0_2    = { 1, 
INPX,  GATE, 0, &quot;IX0.2&quot;, 0, 0,       &amp;IX0_1 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate IX0_3    = { 1, 
INPX,  GATE, 0, &quot;IX0.3&quot;, 0, 0,       &amp;IX0_2 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate QX0_0    = { 1, 
OR,    OUTX, 0, &quot;QX0.0&quot;, 0, &amp;l_[0],  &amp;IX0_3 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate QX0_1    = { 1, 
OR,    OUTX, 0, &quot;QX0.1&quot;, 0, &amp;l_[3],  &amp;QX0_0 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate a        = { 1, 
OR,    GATE, 0, &quot;a&quot;,     0, &amp;l_[6],  &amp;QX0_1 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate a_1      = { 1, 
AND,   GATE, 0, &quot;a_1&quot;,   0, &amp;l_[10], &amp;a     };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate a_2      = { 1, 
AND,   GATE, 0, &quot;a_2&quot;,   0, &amp;l_[14], &amp;a_1   };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate b        = { 1, 
XOR,   GATE, 0, &quot;b&quot;,     0, &amp;l_[18], &amp;a_2   };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate d        = { 1, 
AND,   GATE, 0, &quot;d&quot;,     0, &amp;l_[22], &amp;b     };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate mem      = { 1, 
LATCH, GATE, 0, &quot;mem&quot;,   0, &amp;l_[26], &amp;d     };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/*******************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
 <FONT FACE="Courier, monospace"><FONT SIZE=2>*	Connection lists</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
 <FONT FACE="Courier, monospace"><FONT SIZE=2>*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>static Gate *	l_[] = {</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* QX0.0 */	&amp;a,	0,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* QX0.1 */	&amp;mem,	0,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* a
*/	&amp;a_2,	&amp;a_1,	0,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* a_1
*/	&amp;IX0_0,	0,	&amp;IX0_1,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* a_2
*/	&amp;IX0_1,	0,	&amp;IX0_0,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* b
*/	&amp;IX0_3,	&amp;IX0_2,	0,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* d
*/	0,	&amp;IX0_3,	&amp;IX0_2,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* mem
*/	&amp;mem,	&amp;b,	0,	&amp;d,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>};</FONT></FONT></P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">All this is fairly conventional, except for the
<I><B>immcc</B></I> compiler. The C output it produces consists
mainly of initialised data definitions, which describe a directed
graph of vertices or nodes and edges joining the nodes. Each node of
this graph corresponds to an expression in the <I>iC</I> program -
they are called Expression nodes. The graph produced by the compiler
is directed towards the inputs, which are called sources in graph
theory (see Fig 1 above). This means that a list of the inputs to
each Expression is associated with a particular Expression node.
These are the edges of the graph. This direction represents the way
in which expressions are usually evaluated by a flow of instructions
in a computer &ndash; consecutive instructions read the values of all
input variables of an expression and arithmetic or logic operators,
acting on adjacent operands, determine the result. One is used to
think about expressions this way and the (optional) listing file
represents all Expression nodes generated by the compiler in this way
(see LISTING above).</P>
<P CLASS="western">For <I>immediate C</I>, this graph, whose edges
point towards the inputs of each node, is loaded into memory and as a
first step, all edges are reversed. This means, that each Expression
node is associated with a list of follow on Expression nodes, for
which the current Expression result is an input. What this means is,
that when a particular Expression node changes its value, then all
the expressions for the Expression nodes on its output list should be
re-evaluated (see NET TOPOLOGY above)</P>
<H2 CLASS="western"><A NAME="8.1.  Combinatorial actions|outline"></A>
8.1  Combinatorial actions</H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2>Combinatorial
actions are the evaluation of arithmetic or logical expressions,
which excludes the full evaluation of any embedded clocked functions.
Expressions contain variables combined with operators, which describe
a (possibly) changed result when an input variable to the expression
changes. Although the evaluation of an expression takes a certain
(small) amount of time &ndash; both for hardware IC's and for <I>iC</I>
expressions, conceptually we are dealing with a mathematical
statement, whose evaluation describes a change of state &ndash; an
operation, which does not necessarily take any time. One completed
scan of the Combinatorial action list is such a conceptually timeless
combinatorial set of state-changing actions.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2>To
implement this scheme, the <I>iC</I> run-time uses Expression nodes,
which can be linked into action lists and which store the old value
of the node &ndash; that is the value before the expression is
re-evaluated - as well as the new value after re-evaluation. If these
values are equal after a change of input and re-evaluation, no
further action is taken &ndash; follow on nodes will not change
either, because of this particular change of input. If the new value
is different from the old value, the Expression node is said to
&ldquo;fire&rdquo; (a term borrowed from Petri Nets). When this
happens, The Expression node is linked to the end of an action list.
While on an action list, the old and new values are kept in the node.
There are four types of action list to which Expression nodes may be
linked when they &ldquo;fire&rdquo; during the combinatorial scan:</FONT></FONT></P>
<OL>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2><FONT FACE="Courier, monospace"><B>o_list</B></FONT>,
	to which logical expression nodes are linked.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2><FONT FACE="Courier, monospace"><B>a_list</B></FONT>,
	to which arithmetic expression nodes are linked.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2><FONT FACE="Courier, monospace"><B>A
	Clock list</B></FONT>, to which clocked function Master nodes are
	linked.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2><FONT FACE="Courier, monospace"><B>s_list</B></FONT>,
	to which external output expression nodes are linked.</FONT></FONT></P>
</OL>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">To
simplify the description, <FONT FACE="Courier, monospace"><B>o_list
</B></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">and
</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><B>a_list </B></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">are
discussed here as a single  Combinatorial action list. For the
combinatorial scan, t</SPAN></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>he
Expression node at the head of the Combinatorial action list is taken
and the output list of that node is scanned. Every Expression node on
that output list is re-evaluated, using the new value of the
Expression node just taken from the Combinatorial action list, with
the result that some Expression nodes on the output list may change
and &ldquo;fire&rdquo;. These nodes are also linked to the end of an
appropriate action list. The old value of the original Expression
node is assigned the new value at this time and it is unlinked from
the head of the </FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">Combinatorial
action list</SPAN></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>
&ndash; </FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>that node
is now no longer active. The combinatorial scan is continued with the
new head of the  </FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">Combinatorial
action list until the list is empty.</SPAN></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2>There
is another possibility. The target Expression node is already
somewhere on some action list, which means its value has recently
changed, but the new value has not yet been transmitted to any follow
on nodes. Now another Expression node acts on this particular
Expression node and re-evaluation changes its value a second time.
There are two possibilities:</FONT></FONT></P>
<OL>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2>The
	latest value is still different from the old value (the value it had
	when its output list was last scanned and follow on nodes were
	re-evaluated). In this case the Expression node is left on the
	action list with a (possibly) changed new value.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2; page-break-before: always">
	<FONT FACE="Sanserif PS"><FONT SIZE=2>Re-evaluation changes the new
	value back to the old value again. This situation is called a
	&ldquo;glitch&rdquo;. The Expression node is now unlinked from the
	action list and becomes inactive, before it acts on any follow on
	nodes. The reasoning behind this strategy is, that any temporary
	change, which occurs through one path of the graph, which is
	immediately undone by some expression on another path, should not
	influence the output.</FONT></FONT></P>
</OL>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2>Initially
nodes can only get on the Combinatorial action list due to changes of
external inputs (sources) of the graph. Normally such a change will
percolate through paths of the graph to one or more external output
nodes (sinks). At this stage the Combinatorial action list is usually
empty. </FONT></FONT>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2>Cycles
are allowed in the graph &ndash; they occur when there is feedback in
the <I>iC</I> program. Such feedback is often necessary for
implementing designs, <FONT COLOR="#000000"><FONT FACE="Sanserif PS">but
the designer should control it. </FONT></FONT>Feedback may result in
situations, where continuous oscillations occur. When this happens,
certain nodes will change to a new value &ndash; act on some follow
on node(s), which will then change the original node back to the old
value after it has acted on other nodes. This means the action list
will never get empty. If nothing were done about this, the <I>iC</I>
program would lock up the processor. </FONT></FONT>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2>Continuous
oscillations at the Expression node level should not be part of a
design and this situation results in a warning message at run-time.
Nevertheless for testing purposes, such a program should be able to
run without locking up the processor. To achieve this, a strategy is
used, where the number of times a particular node may be re-evaluated
in one scan is limited &ndash; usually to three. This is the <I>maximum
oscillator count</I>, which may be changed with the -n&nbsp;&lt;count&gt;
command-line switch. If the <I>maximum oscillator count</I> is
exceeded after re-evaluation of a node, that node is not linked to
the normal Combinatorial action list, but to an Alternate action
list. This way the current Combinatorial action list will always get
empty within a finite number of actions. At the end of the scan, when
the Combinatorial action list does become empty, the current
Combinatorial action list and the Alternate action list are swapped.
At this point in time the <I>iC</I> run-time process goes to sleep,
waiting for new input.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2>When
a new external input interrupts the system, the associated input node
is linked to the now current swapped Combinatorial action list and
triggers a new scan. Together with the new input and its follow up
events, the oscillating nodes, which were linked to the (then
alternate) list during the previous scan, will be evaluated again.
This way the oscillations do get re-evaluated over and over &ndash;
but at a rate which does not block the processor. This is similar to
the way oscillations manifest themselves in a hardware IC circuit &ndash;
a large but finite number of oscillations will occur between any two
consecutive external input events. In <I>iC</I> programs, this number
has been reduced to three, which does not change the way these
oscillations affect other parts of the program. In practice it has
been found useful to make this an odd number, so that rising and
falling edges alternate for digital oscillations.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="clocking"></A>
<FONT FACE="Sanserif PS"><FONT SIZE=2>All this takes care of what is
called &ldquo;combinatorial logic&rdquo; for digital systems.
Sequencing requires different mechanisms and they are provided in the
<I>iC</I> language by clocking and clocked functions. </FONT></FONT>
</P>
<H2 CLASS="western"><A NAME="8.2.  Clocked actions|outline"></A>8.2 
Clocked actions</H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Sanserif PS"><FONT SIZE=2>As mentioned before, Clock
signals in <I>iC</I> are best thought of as timeless pulses, whose
occurrence marks the separation of one clock period from the next
along the time axis. For these purposes actions in the <I>iC</I>
run-time occur in two phases &ndash; <I>combinatorial actions</I>,
which were described in the previous section and <I>clocked actions</I>,
which are always master-slave actions, which occur during the Clock
phase.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Sanserif PS"><FONT SIZE=2>Clocked functions contain one
or more Master nodes and exactly one Slave node. Master nodes are
Expression nodes &ndash; just like the ones described in the previous
section, except their output does not act directly on follow on
Expression nodes and therefore are not linked to the current
Combinatorial action list when they &ldquo;fire&rdquo;. There is a
Master Node for every non-clock input parameter to a function.
Associated with each such non-clock parameter is a clock parameter.
If it is not mentioned explicitly in the parameter list, it has a
default value &ndash; usually <FONT FACE="Courier, monospace"><B>iClock</B></FONT>.
Master nodes which &ldquo;fire&rdquo;, are linked to the Clock list
associated with the clock parameter for the particular Master node.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Clock lists are similar to action lists &ndash; they may be empty or
have one or more Expression nodes linked to them. Clock lists are
associated with the Slave node of a Clock function or &ldquo;driver&rdquo;.
There is one special Clock list called <FONT FACE="Courier, monospace"><FONT SIZE=2><B>c_list</B></FONT></FONT>,
which is associated with the default <FONT FACE="Courier, monospace"><B>iClock</B></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
and which is scanned every time a combinatorial scan completes unless
</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>c_list
</B></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">is
empty. This Clock scan marks the occurrence of </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>iClock</B></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">.
In other words combinatorial scans and clock scans alternate until
both the current Combinatorial action list and </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>c_list
</B></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">are
empty. For the purpose of synchronisation, it is </SPAN></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">important
to remember that during the combinatorial scan new nodes are
evaluated and linked to one of the following:</SPAN></FONT></FONT></P>
<OL>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
	<FONT FACE="Sanserif PS"><FONT SIZE=2>the Combinatorial action list
	&ndash; described in the previous section.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
	<FONT SIZE=2><FONT FACE="Courier, monospace"><B>c_list</B></FONT><FONT FACE="Sanserif PS"><SPAN STYLE="font-weight: normal">
	or another Clock list &ndash; which receive Master nodes of clocked
	functions.</SPAN></FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
	<FONT SIZE=2><FONT FACE="Courier, monospace"><B>s_list</B></FONT><FONT FACE="Sanserif PS"><SPAN STYLE="font-weight: normal">
	&ndash; which receives those Expression nodes whose action is
	external output.</SPAN></FONT></FONT></P>
</OL>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT SIZE=2><FONT FACE="Sanserif PS"><SPAN STYLE="font-weight: normal">During
the clock scan only </SPAN></FONT><FONT FACE="Courier, monospace"><B>c_list</B></FONT><FONT FACE="Sanserif PS"><SPAN STYLE="font-weight: normal">
is scanned. There are several different clock actions, but they only
involve the value of a Master node modifying the value of a Slave
node and some side effect associated with the clocked function. The
different clock actions are:</SPAN></FONT></FONT></P>
<OL>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
	<FONT FACE="Sanserif PS"><FONT SIZE=2>Clocking of a logical or
	arithmetic function &ndash; the new value of the Slave node is
	determined according to the truth-table of the function. As a side
	effect the Slave node is linked to the current Combinatorial action
	list if its value has changed &ndash; it then becomes a new logical
	or arithmetic input, which will not have any effect until after the
	current clock scan has completed.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
	<FONT FACE="Sanserif PS"><FONT SIZE=2>Clocking of a CLOCK or TIMER
	driver function &ndash; the Clock action nodes linked to the the
	Clock list associated with the CLOCK or TIMER function Slave node
	are all linked to <FONT FACE="Courier, monospace"><B>c_list
	</B></FONT>immediately. This means, that the CLOCK or TIMER function
	has &ldquo;fired&rdquo; and the clock actions, which have
	accumulated on its Clock list will also be executed during the
	current clock scan, since they are now on <FONT FACE="Courier, monospace"><B>c_list</B></FONT>,
	which is currently being scanned.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
	Clocking of a conditional <FONT FACE="Courier, monospace"><FONT SIZE=2><B>if
	else </B></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">or
	</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>switch
	</B></FONT></FONT>statement function. Since these functions execute
	C code embedded in the <I>iC</I> program, which may involve
	modifying logical or arithmetic <I>immediate</I> variables, the
	actual execution of the C code must be deferred until after
	completion of the clock scan. For this purpose the Slave nodes of
	any conditional <FONT FACE="Courier, monospace"><FONT SIZE=2><B>if
	else </B></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">or
	</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>switch
	</B></FONT></FONT>statement function is linked to another action
	list &ndash; namely <FONT FACE="Courier, monospace"><FONT SIZE=2><B>f_list</B></FONT></FONT>.
	The scan of <FONT FACE="Courier, monospace"><FONT SIZE=2><B>c_list</B></FONT></FONT>
	is always finite, since no new Master actions are added to any Clock
	list during the scan. When the clock scan terminates a single scan
	of <FONT FACE="Courier, monospace"><FONT SIZE=2><B>f_list</B></FONT></FONT>
	follows, unless <FONT FACE="Courier, monospace"><FONT SIZE=2><B>f_list</B></FONT></FONT>
	is empty. This <FONT FACE="Courier, monospace"><FONT SIZE=2><B>f_list
	</B></FONT></FONT>scan marks the end of a Clock phase and the
	beginning of a new combinatorial phase. 
	</P>
</OL>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
After a completed clock scan the combinatorial scan is repeated,
because both Clock actions and the  <FONT FACE="Courier, monospace"><FONT SIZE=2><B>f_list</B></FONT></FONT>
scan may have generated new Combinatorial actions.</P>
<H2 CLASS="western"><A NAME="8.3.  Output actions|outline"></A>8.3 
Output actions</H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">Finally,
when both the current Combinatorial action list and <FONT FACE="Courier, monospace"><B>c_list</B></FONT>
are empty, a scan of <FONT FACE="Courier, monospace"><B>s_list</B></FONT>
 follows. During that scan the actual external output is performed.
Binary outputs are first distributed to an output byte and then the
output bytes, words and long words which have changed since the last
cycle are transmitted to <I><B>iCserver</B></I>, which distributes
them to their final output destinations, where they act physically. 
</P>
<H2 CLASS="western"><A NAME="8.4.  Input actions|outline"></A>8.4 
Input actions</H2>
<P CLASS="western">External inputs come from physical input device
drivers and are transmitted as bytes, words or long words via
<I><B>iCserver</B></I>, using the same protocol as the output. 
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Sanserif PS"><FONT SIZE=2>TCP/IP is used as the transport
protocol from and to the <I>iC</I> run-time system and the final
physical input and output device(s) in the current implementation.
This ensures, that no input or output is lost during transmission.
Other safe transmission systems can be used &ndash; only the actual
input and output driver software needs to be changed.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">The
run-time system also recognises internal inputs which are mainly
interrupts from the processors real-time-clock. These are described
in </SPAN></FONT></FONT><A HREF="#5.1.3.  Timing inputs|outline"><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">6.1.3.</SPAN></FONT></FONT></A></P>
<P CLASS="western">External and internal inputs interrupt the
run-time system. Initially the source of the interrupt is analysed
and Input nodes are &ldquo;fired&rdquo; for every changed input and
these are linked immediately to the <FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">Combinatorial
action list. Then a new cycle is initiated starting with a scan of
the current Combinatorial action list.</SPAN></FONT></FONT></P>
<H2 CLASS="western" STYLE="page-break-before: always"><A NAME="8.5.  Input/Output network|outline"></A>
8.5  Input/Output network</H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Sanserif PS"><FONT SIZE=2>The network clients around
<I><B>iCserver</B></I> can comprise one or more <I>iC</I>
applications and any number of <I><B>iCboxes</B></I>, which simulate
real I/O in the current implementation. Input and output can be
transmitted not only to and from <I>iC</I> applications and <I><B>iCboxes</B></I>
but also between <I>iC</I> applications. Since all of these elements
can run on any processor in a LAN or even in the Internet, this opens
up interesting possibilities for the <I>iC</I> system.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<IMG SRC="iC_html_m345e520e.gif" ALIGN=LEFT><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western"><I>Fig. 2	</I><I><SPAN STYLE="font-weight: normal">Input/output
network</SPAN></I></P>
<H1 CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.42cm; border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding-top: 0.12cm; padding-bottom: 0cm; padding-left: 0cm; padding-right: 0cm; widows: 2; orphans: 2; page-break-before: always; page-break-after: avoid"><A NAME="9.    Compiler and Run-time system|outline"></A>
<FONT FACE="Sanserif PS"><FONT SIZE=4><B>9    Compiler and Run-time
system</B></FONT></FONT></H1>
<H2 CLASS="western"><A NAME="9.1.  Compiler |outline"></A>9.1 
Compiler 
</H2>
<P CLASS="western">The <I>iC</I> compiler <I><B>immcc</B></I>
generates C code with the extension <FONT FACE="Courier, monospace"><B>.c</B></FONT>
from <I>iC</I> source files with the extension <FONT FACE="Courier, monospace"><B>.ic</B></FONT>,
which is suggested for <I>iC</I> sources. It is also suggested, that
<I>iC</I> header files have the extension <FONT FACE="Courier, monospace"><B>.ih</B></FONT>
For larger projects, several <FONT FACE="Courier, monospace"><B>.ic</B></FONT>
files may be compiled to <FONT FACE="Courier, monospace"><B>.c</B></FONT>
files, which are then compiled by <I><B>cc</B></I> to <FONT FACE="Courier, monospace"><B>.o</B></FONT>
files and linked with the library <I><B>libict.a</B></I>, which
contains the run-time code. This produces a finished application,
which can be run in an environment compatible with the features of
the run-time library.</P>
<P CLASS="western">The <I>iCa </I>pre-compiler <I><B>immac</B></I>
generates <I>iC</I> source files with the extension <FONT FACE="Courier, monospace"><B>.ic</B></FONT>
from <I>iC</I> with arrays (<I>iCa</I>) source files with the
extension .ica. The shell script <I><B>iCmake</B></I> executes all
these steps automatically &ndash; it makes a complete <I><B>iC</B></I><B>
</B>application from one or more <I>iC</I> and/or <I>iCa</I> sources.</P>
<H2 CLASS="western"><A NAME="9.2.  Run-time libraries |outline"></A>9.2
 Run-time libraries 
</H2>
<P CLASS="western">There are several versions of the run time
library, depending on the hardware interfaces available for Input and
Output. The Demonstration library <I><B>libict.a</B></I> communicates
its Input and Output via TCP/IP, which provides a turnaround time of
an input change to the arrival of the corresponding output change in
a lightly loaded network of less than 2 millisecond (measured on a
Pentium 166). The uncertainty of load occurring in such a network
forces one to look at specialized bus systems for high speed
applications. Currently <I><B>libict.a</B></I> is a static library.
For production purposes a dynamic library is envisaged.</P>
<P CLASS="western">Other libraries have been built for industrial
field bus systems. The library for <B>InterBus-S </B>is complete and
has been extensively tested with InterBus-S I/O modules. A library
for a proprietary high speed field bus system was used for early
tests and provided turnaround times of under a 100 microseconds on a
386 8 MHz processor. A CAN-Bus library is planned and could be
implemented at short notice.</P>
<H2 CLASS="western"><A NAME="9.3.  Run-time environment and system|outline"></A>
9.3  Run-time environment and system</H2>
<P CLASS="western">For any applications where hard real time
constraints are not a problem, the TCP/IP run-time system provides a
very flexible and easy to configure environment where Input and
Output may be distributed over a number of computers in a local area
network. The system consists of a server called <I><B>iCserver</B></I>
and a number of clients for which <I><B>iCserver</B></I> is the hub.
An <I>iC</I> application linked with the <I><B>libict.a</B></I>
library is one type of client, providing control in the system. The
other client types are Input and Output modules (or combined I/O
modules) and debugging tools.</P>
<P CLASS="western"><I><B>iCserver</B></I> has been implemented in
Perl, which is very flexible and fast enough to keep up with TCP/IP
traffic generated in a local area network. A faster C implementation
of <I><B>iCserver</B></I> is possible. The program <I><B>iCbox</B></I>
simulates Input/Output modules as Perl/Tk dialog boxes for digital
and analog inputs and outputs. For real inputs and outputs <I><B>iCbox</B></I>
can serve as a program template. Only the translation of the I/O
signals to a short network message for transmission to the <I><B>iCserver</B></I>
is necessary to port an I/O device. A simple and very compact
protocol for passing messages to and from the <I><B>iCserver</B></I>
has been defined.</P>
<P CLASS="western">The program <I><B>iClive</B></I> provides an IDE
for editing and debugging <I><B>iC</B></I> programs. It provides an
edit window, in which program text can be displayed and optionally
edited, searched, saved, made into runnable code, run and stopped.
When running and debugging an  <I><B>iC </B></I> program, <I><B>iClive</B></I>
is a client of <I><B>iCserver</B></I> and indirectly of the running
<I><B>iC</B></I> program. <I><B>iClive</B></I> colours words in the
program text according to the state of the node named by a word &ndash;
<SPAN STYLE="background: #23ff23">green/black</SPAN> for bit 0,
<FONT COLOR="#ff0000"><SPAN STYLE="background: #ffff00">yellow/red</SPAN></FONT>
for bit 1 and <SPAN STYLE="background: #0099ff">blue</SPAN> for
arithmetic variables. The value of a node is also displayed when the
cursor is on a word. To be effective, the displayed text must be
either the source of the running <I><B>iC</B></I> program or a text
derived from that source, such as the compiler generated listing,
which shows all compiler generated extra nodes. With this colour
coded display of the statements of the <I><B>iC</B></I> program, it
is easy to follow the progress of execution and the related logic at
run time. &quot;Live displays&quot; are commonly used in programming
units for PLC's in industrial control environments to provide
debugging support.</P>
<P CLASS="western"><IMG SRC="iC_html_m1fc212bd.jpg" NAME="graphics5" ALIGN=LEFT WIDTH=580 HEIGHT=400 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><I>Fig. 3	<B>iCbox</B> as IO for &ldquo;sorti&rdquo;
- IX0.0, QX0.2 and QX8.1 are &ldquo;on&rdquo; - the rest are &ldquo;off&rdquo;.</I></P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><IMG SRC="iC_html_7c053fa6.jpg" NAME="graphics6" ALIGN=LEFT WIDTH=755 HEIGHT=409 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<P CLASS="western"><I>Fig. 4	<B>iClive</B> in LIVE mode - QX8.1,
QX0.2 and IX0.0 are &ldquo;on&rdquo; - the rest are &ldquo;off&rdquo;.
	<BR>	&ldquo;sorti&rdquo; is running. &ndash; it can be stopped by
pressing the &ldquo;Stop&rdquo; button or switched<BR>	to Edit mode
by pressing the &ldquo;Edit&rdquo;  button (see Fig. 5).</I></P>
<P CLASS="western"><IMG SRC="iC_html_6257ffb9.jpg" NAME="graphics1" ALIGN=LEFT WIDTH=756 HEIGHT=429 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><I>Fig. 5	<B>iClive</B> in EDIT mode with a search
for IX0.5 shown. The application &ldquo;sorti&rdquo; is not running &ndash;
press &ldquo;Run&rdquo; and then &ldquo;Live&rdquo; to get to Fig. 4.
&ldquo;Help&rdquo; to get the following:	<BR></I><BR><BR>
</P>
<P CLASS="western"><IMG SRC="iC_html_2fb47f94.jpg" NAME="graphics2" ALIGN=LEFT WIDTH=756 HEIGHT=435 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<P CLASS="western"><I>Fig. 6	<B>iCman</B> showing the start of the
man-page for iClive. A search for &ldquo;Text&rdquo; is shown.</I></P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">For command line use, a shell script <I><B>iCmake</B></I>
builds one or more applications from <I><B>iC</B></I> sources using
the static library <I><B>libict.a</B></I><I>.</I> The compiler <I><B>immcc</B></I>,
the programs <I><B>iCserver</B></I><SPAN STYLE="font-weight: normal">,</SPAN>
<I><B>iCbox</B></I>, <I><B>iClive</B></I><B> </B>and <B> </B><I><B>iCmake</B></I>
as well as each compiled and linked <I><B>iC</B></I> application
provide a generous help output with the -h switch option. Each of
these programs also has a full man page which may be viewed with
'man' in a Unix like environment or with <I><B>iCman</B></I>, a man
page viewer with interesting search and Hyperlink features.</P>
<H1 CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.42cm; border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding-top: 0.12cm; padding-bottom: 0cm; padding-left: 0cm; padding-right: 0cm; widows: 2; orphans: 2; page-break-before: always; page-break-after: avoid"><A NAME="10.    Bibliography|outline"></A>
<FONT FACE="Sanserif PS"><FONT SIZE=4><B>10    Bibliography</B></FONT></FONT></H1>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Aho86]<FONT FACE="Sanserif PS"><FONT SIZE=2>	Alfred V. Aho, Ravi
Sethi, Jeffrey D. Ullman	<BR>	Compilers Principles, Techniques, and
Tools	<BR>	Addison-Wesley Publishing Company 1986</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Davis01]<FONT FACE="Sanserif PS"><FONT SIZE=2>	John Davis II, et
al	<BR>	Overview of the Ptolemy Project	<BR>	University of
California, Berkeley 2001</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Johnston04]	<FONT FACE="Sanserif PS"><FONT SIZE=2>Wesley M.
Johnston, J. R. Paul Hanna, and Richard J. Millar	<BR>	</FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>Advances
in Dataflow Programming Languages	<BR>	ACM Computing Surveys, Vol.
36, No. 1, March 2004, pp. 1&ndash;34.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Kernighan84]<FONT FACE="Sanserif PS"><FONT SIZE=2>	Brian W.
Kernighan, Rob Pike	<BR>	The UNIX Programming Environment	<BR>	Prentice
Hall, Inc. 1984</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Kernighan88]<FONT FACE="Sanserif PS"><FONT SIZE=2>	Brian W.
Kernighan, Dennis M. Ritchie	<BR>	The C Programming
Language	<BR>	Prentice Hall, Inc. 1988</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Kluge92]<FONT FACE="Sanserif PS"><FONT SIZE=2>	Werner Kluge	<BR>	The
Organization of Reduction, Data Flow, and Control Flow Systems	<BR>	The
MIT Press 1992</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Lent89]<FONT FACE="Sanserif PS"><FONT SIZE=2>	Bogdan Lent	<BR>	Dataflow
Architecture for Machine Control	<BR>	John Wiley &amp; Sons Inc. 1989</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Phister63]<FONT FACE="Sanserif PS"><FONT SIZE=2>	Montgomery Phister,
Jr.<BR>	Logical design of digital computers	<BR>	John Wiley &amp;
Sons, Inc. 1963</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Sharp85]<FONT FACE="Sanserif PS"><FONT SIZE=2>	John A. Sharp	<BR>	Data
flow computing	<BR>	Ellis Horwood Limited 1985</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT>[Sparkes72]	John Sparkes, Ed.	<BR>	The
Heart of Computers	<BR>	The Open University Press 1972</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Srinivasan97]<FONT FACE="Sanserif PS"><FONT SIZE=2>	Sriram
Srinivasan	<BR>	Advanced Perl Programming	<BR>	O'Reilly 1997</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Wall00]<FONT FACE="Sanserif PS"><FONT SIZE=2>	Larry Wall, Tom
Christiansen &amp; Jon Orwant	<BR>	Programming Perl	<BR>	O'Reilly
2000</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Walsh99]<FONT FACE="Sanserif PS"><FONT SIZE=2>	Nancy
Walsh	<BR>	Learning Perl/Tk	<BR>	O'Reilly 1999</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Wulff72]<FONT FACE="Sanserif PS"><FONT SIZE=2>	E. Wulff	<BR>	A
Monitor for Real-Time-Control Systems	<BR>	University of New South
Wales 1972</FONT></FONT></P>
<H1 CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.42cm; border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding-top: 0.12cm; padding-bottom: 0cm; padding-left: 0cm; padding-right: 0cm; widows: 2; orphans: 2; page-break-before: always; page-break-after: avoid"><A NAME="11.    The Author|outline"></A>
<FONT FACE="Sanserif PS"><FONT SIZE=4><B>11    The Author</B></FONT></FONT></H1>
<P CLASS="western">John E. Wulff studied Electrical Engineering at
the University of New South Wales in Sydney, Australia. His first
professional experience was in the Telephone industry, developing
switching circuits with electro-mechanical relays but also with
vacuum tubes, cold cathode tubes and very soon with the emerging
transistors. In 1964 he spent 6 months in England, getting know-how
on a new family of switching circuits using germanium diodes and
transistors, but which already supported clocked flip-flops. These
had been developed at the BICC research laboratory near Hampton
Court, where John Sparkes had invented the principle of clocking a
few years earlier. With this experience, he was chief designer for a
special purpose computer with 100 kilobytes of magnetic drum memory,
1 million transistors, 2.5 million diodes for logic and 100,000
silicon controlled rectifiers for power output drivers, switching up
to 5 Amps. This machine controlled a letter sorting system with 150
input consoles and a throughput of 5 million letters a day. This
system worked reliably for 25 years.</P>
<P CLASS="western">Experience with logic design based on integrated
circuits followed. The availability of mini computers led to an
interest in programming. A Master of Engineering Science Degree in
Information Science at the University of New South Wales provided a
solid foundation for future work as a Software Engineer. The design
and implementation of a Real Time Operating System (or Monitor, as it
was then called), which provided a task context switch in 15 machine
instructions was the content of his Masters Thesis <FONT FACE="Sanserif PS"><FONT SIZE=2>[Wulff72]</FONT></FONT>,
and later provided the basis for some very fast industrial machine
control systems.</P>
<P CLASS="western">In the mid 80's John Wulff came in contact with
PLC's. He was asked to help during the commissioning of a PLC-system,
controlling a parcel sorting complex consisting of 100 standard
conveyor systems and 4 high speed conveyors which had mechanical
gates along its length, to divert parcels. These high speed belts
needed a control resolution of 15 milliseconds, in which time a
parcel had moved 3 cm. Unfortunately the function blocks for the
standard conveyors, executed 100 times, once for each of the
conveyors, brought the total cycle time to over 1 second!! What to
do? Fortunately the PLC had just enough (8) interrupt inputs, to
allow the implementation of an event driven sub-system based on the
assembler instruction set of the PLC. This saved the company a lot of
liquidated damages. 
</P>
<P CLASS="western">This experience spawned the idea for an event
driven PLC, which resulted in the current <I>iC</I> system. Although
this system is demonstrably faster than a PLC with the same memory
speed for any reasonable application one can think of, it is
difficult to compute a guaranteed maximum response time. Since this
is a requirement for hard real time applications, <I>iC</I> was never
accepted for industrial use. For a PLC the maximum response time is
simply the time to execute all instructions making up the program,
which is the cycle time of the program. For an <I>iC</I> program this
time can also be computed. For a 10 MHz PC the execution time is
about 2 microseconds per gate node processed. The total number of
gate nodes is provided in the listing produced by the compiler. An <I>iC</I>
program with 10,000 gate nodes, which corresponds to a PLC program of
approx. 32 kilobytes would thus have a maximum response time of 20
milliseconds, if all nodes were somehow fired simultaneously. This
would be a good response time for a PLC. In practice this can never
happen and a maximum response times of &lt; 200 microseconds was
measured on such a 10 MHz machine. This corresponds to events which
cause 100 follow up nodes to fire. The typical number of follow up
events is 7. Assuming this figure is Poisson distributed the above
assumption is not unreasonable.</P>
<P CLASS="western">Current plans are, to publish the complete system
under an Open Source License and to see if the Open Source Community
can make a go of it. With the current emphasis on Linux in embedded
Systems, I see great scope here. 
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">Id:
iC.odt 1.30  2008/09/06</FONT></FONT></P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="11.Appendix A    README|outline"></A><A NAME="10.Appendix A    README|outline"></A>
<FONT FACE="Sanserif PS"><FONT SIZE=4><B>Appendix A    README</B></FONT></FONT></H1>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">		
immediate C, iC rev 1.122</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   Copyright (C) 1985-2008, John E. Wulff</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">		
   All rights reserved.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">This program is free software;
you can redistribute it and/or modify</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">it under the terms of either:</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	a)
 the GNU General Public License as published by the Free</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   Software Foundation; either version 2, or (at your option)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   any later version,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
OR</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	b)
 the &quot;Artistic License&quot; which comes with this Kit.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">This program is distributed in
the hope that it will be useful, but</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">WITHOUT ANY WARRANTY; without
even the implied warranty of</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">See either the GNU General Public
License or the Artistic License for</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">    
<FONT SIZE=1 STYLE="font-size: 8pt">more details.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">You should have received a copy
of the Artistic License with this</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">Kit, in the file named
&quot;Artistic&quot;. If not, I'll be glad to provide one.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">You should also have received a
copy of the GNU General Public License</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">along with this program; if not,
write to the Free Software Foundation,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">Inc., 59 Temple Place, Suite 330,
Boston, MA 02111-1307, USA.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">For those of you that choose to
use the GNU General Public License,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">my interpretation of the GNU
General Public License is that no iC</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">source falls under the terms of
the GPL unless you explicitly put</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">said source under the terms of
the GPL yourself.  Furthermore, any</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">object code linked with iC does
not automatically fall under the</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">terms of the GPL, provided such
object code only adds definitions</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">of subroutines and variables, and
does not otherwise impair the</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">resulting interpreter from
executing any standard iC source.  I</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">consider linking in C subroutines
in this manner to be the moral</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">equivalent of defining
subroutines in the iC language itself.  You</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">may sell such an object file as
proprietary provided that you provide</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">or offer to provide the iC
source, as specified by the GNU General</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">Public License.  (This is merely
an alternate way of specifying input</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">to the program.)  You may also
sell a binary produced by compiling an</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">iC source that belongs to you
with the iC compiler and linking it with</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">the iC runtime library, provided
that you provide or offer to provide</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">the iC source as specified by the
GPL. (The fact that the iC runtime</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">library and your code are in the
same binary file is, in this case,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">a form of mere aggregation.) This
is my interpretation of the GPL.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">If you still have concerns or
difficulties understanding my intent,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">feel free to contact me at
&lt;ic@je-wulff.de&gt;.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">Of course, the Artistic License
spells all this out for your protection,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">so you may prefer to use that.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">Acknowledgements to Larry Wall,
whose README I used as a template.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">			
   and for Perl - which is just GREAT.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">Acknowledgements to Nick
Ing-Simmons for Perl/Tk - which is SMOOTH.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">Acknowledgements to Linus
Torvalds and the Open-Software community</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">			
   for Linux(R) - which is SOMETHING ELSE. </FONT>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">--------------------------------------------------------------------------</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%; page-break-before: always">
    <FONT SIZE=1 STYLE="font-size: 8pt">Notes for the installation of
iC rev 1.122</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">1)	Pre-requisites. You need the
following on your system:</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   C compiler	# tested with gcc, MSC and Borland</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   Perl, Perl/Tk and Time::HiRes	# to build iC applications</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">1)	Unpack the iC-archive in a
suitable working directory with:</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   tar -xvzf icc_1.122.tgz</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   cd icc_1.122/src</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">2)	Excute the following:</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   configure     OR  ./configure	# if super user (depricated)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	To
make a Debug version do</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   makeAll -gcl  OR  makeAll -qgcl  # to supress intermediate output</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	OR
to make a Release version do</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   make          OR  make quiet 	# to supress intermediate output</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	this
should build the files</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   immcc	# the iC to C compiler</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   libict.a	# the run-time library</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	without
any errors</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">3)	To compile and compare the
test iC files in Test0 execute:</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   make test</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">4)	To use the Perl support
programs, it is mandatory that you install the</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	Perl
packages Tk800.024 or later and Time::HiRes unless they are already</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	installed
on your system.  Both are included with this distribution.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	This
can be checked by executing the following at this point:</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   iClive -h</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	Skip
to point 8) if you get a help output and no error message.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	The
last line tells you which version of Perl/Tk you are using.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">5)	Unpack build and install the
Time::HiRes archive in a suitable</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	working
directory with:</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   tar -xvzf Time-HiRes-01.20.tar.gz</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   cd Time-HiRes-01.20</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   perl Makefile.PL</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   make</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   make test</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   su	### Password  ###</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   make install</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   exit	### IMPORTANT ###</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   cd ..</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   rm -rf Time-HiRes-01.20	# unless you want to keep it</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">6)	Perl/Tk is usually contained
in Linux distributions and will</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	be
installed automatically when the package is selected.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	If
not, unpack, build and install Tk-800.024.tar.gz (or later).</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	Follow
the instructions in the README.xxx and INSTALL files.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	For
Cygwin under WinXP a special binary distribution of Tk800.023</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	is
included, which works fine.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">7)	Return to the immediate C
installtion</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   cd icc_1.122/src	# or the correct iC src directory</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">8)	To install the iC-compiler,
library and scripts execute the</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	following
as super user:</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   su	### Password  ###</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   make install</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   exit	### IMPORTANT ###</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	this
copies the essential executables to /usr/local/bin</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	it
also copies the include file icg.h to /usr/local/include</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	libict.a
to /usr/local/lib and Msg.pm to /usr/lib/perl5/site...</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   (make uninstall as su will remove all these files)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">9)	To build and run the very
simple iC application &quot;hello.ic&quot; do</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   iClive hello.ic	# starts the IDE with hell0.ic</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   press Build &gt; Build executable	# displays 'hello' successfully
built</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   press Run	# opens an iCbox with 1 button IX0.0</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   press button IX0.0 in iCbox	# button turns HI (input is green)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">		#
'Hello! world' is output in the window iClive was started from</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   press Live</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">		#
The word IX0.0 (the only immediate variable in hello.ic)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">		#
is coloured yellow/red, because IX0.0 is HI.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">		#
When IX0.0 is pressed again to LO, the colour in the live</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">		#
display changes to green/black, indicating LO.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   press File &gt; Quit	# 'hello' and iCbox are terminated</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">10)	A slightly bigger application
is &quot;simple.ic&quot;. Build and run it with iClive.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	An
iCbox with 16 inputs and 8 outputs is started automatically.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	Explore
the logic of the statements by changing inputs and following</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	the
outputs in iCbox and the live display in iClive.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">11)	The application &quot;bar.ic&quot;
uses flip flops to produce a bar of running lights.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	The
application also explores the use of programmable time delays, giving</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	some
idea of the scope of the iC language.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	Running
'iClive bar.ic' as a separate process, while 'bar' is running,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	will
display the source listing (in the edit window), connects to iCServer</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	as
an auxiliary client to receive updates of all variables from the
running</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	iC
program (bar). These updates will change the colours of all words,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	which
are immediate variables.  (green/black = 0, yellow/red = 1)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	This
&quot;live display&quot; shows the current state of logical
relationships in</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	visible
statements of the iC program. Arithmetic variables are displayed</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	in
a balloon, when the cursor rests on a variable.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	(Arithmetic
variables have a blue background).</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	In
'Live' mode, when a &quot;live display&quot; is shown, the text is
read only.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	When
the 'Edit' button is pressed 'iClive' is a full featured editor.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	The
edit facilities of this program are described in the iClive man page</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	under
the Heading 'KEYBOARD BINDINGS' (press Help button in 'iClive').</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	'iClive'
can use the Tk::TextUndo package, an extension of Tk::Text. This</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	allows
undoing changes with the Ctrl-u key. (Control-u is &lt;&lt;Undo&gt;&gt;)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	This
is achieved by starting iClive with the -u option. Use this option</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	only
for editing. In 'Live' mode the display is very jerky with -u active.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">12)	Applications can of course be
run without iClive. They do need iCserver</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	though,
which is a hub server for the TCP/IP packets exchanged between</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	iC
applications, I/O apllications (currently only iCbox) and optionally</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	iClive.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   iCserver &amp;	# server runs on the background</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   iCbox IX0 &amp;	# start IX0 manually</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   hello	# start application</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   ctrl-C	# terminate application</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   iCstop iCserver	# kill iCserver and iCbox</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	A
better way is to start iCserver with the -a (auto-vivify) option,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	which
will start simulated I/O iCbox, every time an iC application</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	is
started. Otherwise these must be started manually, which can be</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	tedious
for larger applications.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   iCserver -a &amp;	# auto-vivify iCbox for application</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   simple	# iCbox with 3 sets of I/O starts</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	If
iClive is started first, it does all this automatically. It then
kills</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	iCserver
automatically when it quits. When iCserver quits it kills all</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	registered
applications and I/O's.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">13)	I have included a script
called 'iCstop' from my private toolkit.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	It
can be used effectively to kill iCserver when it is executing</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	in
the background, which is appropriate for a server.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   iCserver &amp;</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   .....</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   ../iCstop iCserver	# local copy of 'iCstop'</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	I
have tried to use 'kill' with named processes as described in</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	the
'kill' manpage, but it does not seem to work, even called as</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	'command
kill iCserver'.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	You
will have to install 'iCstop' manually in a PATH directory to</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	use
it anywhere in your system. (see 'iCstop -h' for help)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">14)	To make executable
applications from iC sources, use the script iCmake.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	iCmake
is a shell script to compile iC sources into C sources using the</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	'immcc'
compiler.  These in turn are compiled and linked into an</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	executable
iC applications (currently using gcc - this can be changed).</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	Various
options allow partial compilation and generation of listings.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   iCmake -h  OR  iCman iCmake	# gives a lot of help</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">15)	The OpenOffice 2.2 document
doc/iC.odt (or doc/iC.pdf, doc/iC.html)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	is
the handbook for the iC Programming Language. It opens the way to</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	use
&quot;immediate C&quot; fully.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">16)	There is a generous help
output for every tool in the 'iC Project'</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	initiated
with the -h option. Each generated iC application also</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	has
a help output:</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	
   hello -h	# list available options</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	These
options allow connecting to iCserver on another computer in a</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	LAN
- or with a differnt port number. Very detailed debugging output,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	showing
the change of state of every event in the system is available</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	for
the Debug version of the iC system. (Supressed for Release version)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">17)	There are 'man' pages for all
the tools used in the 'iC Project'.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	These
can be viewed with the normal 'man' command under Linux or with</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	'iCman'.
 The man page viewer 'iCman' has some nifty web-browser</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">	features
to view and search man pages - try it with 'iCman iCman'.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">    
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">Lots of success</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">John E. Wulff   2008.08.08    
&lt;<A HREF="mailto:ic@je-wulff.de?subject=Enquiry%20from%20iC%201.120%20README">ic@je-wulff.de</A>&gt;</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">I currently use SuSE Linux 9.3
with Tk800.024. I have tested the</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">distribution with Cygwin under
WinXP and a special binary distribution</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">of Tk800.023 (in the kit).  Perl
under Windows Vista will not execute</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">forked processes, so the iC
support programs don't work.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">A test with Tk804.027 under
MAC-OSX 1.3 and SuSE Linux 10.2 both work,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">but live updates in iClive are
noticably slow in both systems (about 10x).</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">Tag-handling in Tk::Text is much
slower under Tk804.27 than under</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">Tk800.024 with Linux.  Therefore
I suggest staying with Tk800.024.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">I have now switched to openSUSE
11.0, which brings along Tk804.28,</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">which provides fast live updates
in iClive again. They seem to be as</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">fast as with Tk800.24. This was
only judged by observation - at least</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">the performance is now
subjectively good and I suggest you get Tk804.28.</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">A Test with Knoppix and Tk804.25,
which is still available for Debian</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 100%">   
<FONT SIZE=1 STYLE="font-size: 8pt">also provided good performance
with fast live updates in iClive.</FONT></P>
<H1 CLASS="western" STYLE="margin-top: 0cm; margin-bottom: 0cm; page-break-before: always"><A NAME="11.Appendix B    Type Definition Table|outline"></A>
<FONT FACE="Sanserif PS"><FONT SIZE=4><B>Appendix B    Type
Definition Table</B></FONT></FONT></H1>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT SIZE=2><FONT FACE="Sanserif PS">The
following table defines function types and output types of Gate nodes
used in the </FONT><FONT FACE="Sanserif PS"><I>iC</I></FONT><FONT FACE="Sanserif PS">
run-time system. In particular the abbreviation symbol columns 'os'
and 'fos' are useful when interpreting the compiler generated
listings. Others help to interpret </FONT><FONT FACE="Sanserif PS"><I>iC</I></FONT><FONT FACE="Sanserif PS">
source code.</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><IMG SRC="iC_html_71f831d8.gif" NAME="Object2" ALIGN=LEFT WIDTH=785 HEIGHT=1089><BR CLEAR=LEFT><BR>
</P>
<DIV ID="sdfootnote1">
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
	<FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1><A CLASS="sdfootnotesym" NAME="sdfootnote1sym" HREF="#sdfootnote1anc">1</A>
	see Werner Kluge:  The organization of Reduction, Data Flow, and
	Control Flow Systems - pp. 317.<BR>   The MIT Press 1992. [Kluge92]</FONT></FONT></P>
</DIV>
<DIV ID="sdfootnote2">
	<P CLASS="sdfootnote-western"><FONT FACE="MS Sans Serif, sans-serif"><A CLASS="sdfootnotesym" NAME="sdfootnote2sym" HREF="#sdfootnote2anc">2</A>
	<FONT SIZE=1 STYLE="font-size: 8pt">Note the memory behaviour of a
	LATCH when both </FONT><FONT SIZE=1 STYLE="font-size: 8pt"><B>set</B></FONT><FONT SIZE=1 STYLE="font-size: 8pt">
	and </FONT><FONT SIZE=1 STYLE="font-size: 8pt"><B>reset</B></FONT><FONT SIZE=1 STYLE="font-size: 8pt">
	is  </FONT><FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">1</FONT></FONT></FONT></P>
</DIV>
<DIV ID="sdfootnote3">
	<P CLASS="western"><A CLASS="sdfootnotesym" NAME="sdfootnote3sym" HREF="#sdfootnote3anc">3</A><FONT FACE="MS Sans Serif, sans-serif">
	</FONT><FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Note
	for PLC programmers: the order of the </FONT></FONT><FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>set</B></FONT></FONT><FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">
	and </FONT></FONT><FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>reset</B></FONT></FONT><FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">
	statement has no influence on the output of flip-flops and latches
	as it does in sequentially executed PLC programs - even in the case
	of this latch example using two gates.</FONT></FONT></P>
</DIV>
</BODY>
</HTML>